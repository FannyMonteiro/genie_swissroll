(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[   1615573,      35866]
NotebookOptionsPosition[   1611857,      35757]
NotebookOutlinePosition[   1612323,      35776]
CellTagsIndexPosition[   1612280,      35773]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Set-Up For Run:",
 FontSlant->"Italic"]], "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
  3.40006649821875*^9, 3.400066566703125*^9}, {3.437727312162577*^9, 
  3.437727319537369*^9}, {3.437743770863562*^9, 3.437743773982688*^9}, {
  3.4591009237956257`*^9, 3.45910092540738*^9}, {3.462034480881547*^9, 
  3.4620345185217543`*^9}, {3.4826612778789186`*^9, 3.482661307068645*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"setupdirsandfiles", "=", 
   RowBox[{"{", 
    RowBox[{
    "inroot", ",", "outroot", ",", "genieroot", ",", "runtimeroot", ",", 
     "configroot", ",", "archiveroot"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setupdirsandfilestext", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<inroot\>\"", ",", "\"\<outroot\>\"", ",", "\"\<genieroot\>\"", ",", 
     "\"\<runtimeroot\>\"", ",", "\"\<configroot\>\"", ",", 
     "\"\<archiveroot\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    StyleBox["If",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox[
      RowBox[{"Not", "[", 
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"setupdirsandfiles", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}],
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{"CreateDialog", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"setupdirsandfilestext", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "~~", 
          StyleBox["\"\< '\>\"",
           FontColor->GrayLevel[0]], 
          StyleBox["~~",
           FontColor->GrayLevel[0]], 
          StyleBox[
           RowBox[{"setupdirsandfiles", "[", 
            RowBox[{"[", "i", "]"}], "]"}],
           FontColor->GrayLevel[0]], 
          StyleBox["~~",
           FontColor->GrayLevel[0]], 
          
          StyleBox[
           "\"\<' does not exist or is not connected, click Abort in the \
window 'Local Kernel Interrupt' and check\>\"",
           FontColor->GrayLevel[0]]}], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}], 
      StyleBox[";",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"Interrupt", "[", "]"}],
       FontColor->GrayLevel[0]]}]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["{",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["i",
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["Length",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], "setupdirsandfiles", "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.485845167509457*^9, 3.4858452565977383`*^9}, {
  3.4858469756399317`*^9, 3.485846995685615*^9}, {3.485847153877009*^9, 
  3.485847161080562*^9}, {3.485847203368182*^9, 3.485847235281768*^9}, {
  3.485847294934217*^9, 3.48584739890423*^9}, {3.485847739231677*^9, 
  3.485847760301146*^9}, {3.485847856432603*^9, 3.485847857176429*^9}, {
  3.485848190511631*^9, 3.485848218215815*^9}, {3.485848368989262*^9, 
  3.485848371298171*^9}, {3.485848518330804*^9, 3.4858485209763937`*^9}, {
  3.485848553732357*^9, 3.4858485857573843`*^9}, {3.491639294645308*^9, 
  3.491639311120417*^9}}],

Cell[BoxData[
 RowBox[{"ensembledatafiles", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ensembleroot", "~~", 
     RowBox[{"ensembles", "[", 
      RowBox[{"[", "e", "]"}], "]"}], "~~", "\"\<.csv\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4858475907181797`*^9, 3.485847592524575*^9}, {
  3.485847626334672*^9, 3.485847642002624*^9}}],

Cell[BoxData[
 RowBox[{"baselinefiles", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"baseline", "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "f", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"f", ",", "nparts"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.485848692583541*^9, 3.485848722802801*^9}, {
  3.485848784694697*^9, 3.485848806067039*^9}, {3.4858489816671553`*^9, 
  3.485848982830701*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"configfiles", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ensembledatafiles", ",", "baselinefiles"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "configroot", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    StyleBox["If",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox[
      RowBox[{"Not", "[", 
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"configfiles", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}],
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{"CreateDialog", "[", 
       RowBox[{"{", 
        RowBox[{
         StyleBox[
          RowBox[{"\"\<config file '\>\"", "<>", 
           RowBox[{"configfiles", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "<>", 
           "\"\<' does not exist (is not in \>\"", "<>", "configroot", "<>", 
           " ", "\"\<), click Abort in the window 'Local Kernel Interrupt' \
and check\>\""}],
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}], 
      StyleBox[";",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"Interrupt", "[", "]"}],
       FontColor->GrayLevel[0]]}]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["{",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["i",
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["Length",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], "configfiles", "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.485848826757688*^9, 3.4858488431247253`*^9}, {
  3.4858489966006193`*^9, 3.485849104838022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qsub", "=", "header"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allconfigs", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.437309236845291*^9, 3.43730923996475*^9}, 
   3.437309331971712*^9, 3.437312855435636*^9, 3.437386452744617*^9, {
   3.4741380934288893`*^9, 3.4741380982104473`*^9}, 3.474144559215558*^9, {
   3.485848466624279*^9, 3.485848470005665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ensemblename", "=", 
      RowBox[{"ensembleroot", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemshort", "=", 
      RowBox[{"ensemblerootshort", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembledatafile", "=", 
      RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"config", "=", 
      RowBox[{"configs", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"configshort", "=", 
      RowBox[{"configshorts", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<ensemblename, ensemshort, ensembledatafile:\\n\\n\>\"", ",", 
       "ensemblename", ",", "\"\<, \>\"", ",", "ensemshort", ",", 
       "\"\<, \>\"", ",", "ensembledatafile", ",", "\"\<\\n\\n\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "configroot", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Import", "[", "ensembledatafile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<data//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"data", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"comments", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
          
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "\[Equal]", "comment"}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"comments", ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<comments//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"comments", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"individualvariables", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
          
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "\[Equal]", "individual"}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"individualvariables", ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"origindividualvariables", "=", "individualvariables"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"individualvariables", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"individualvariables", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "individualvariables", "]"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"individualvariables", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"individualvariables", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "individualvariables", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"individualvariables", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<individualvariables//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"individualvariables", "//", "TableForm"}], ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"tagmarkervariables", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
          
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "\[Equal]", "tagmarker"}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"tagmarkervariables", ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"origtagmarkervariables", "=", "tagmarkervariables"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tagmarkervariables", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<tagmarkervariables//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"tagmarkervariables", "//", "TableForm"}], ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vartitles", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"tagmarkervariables", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vartitlesshort", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"tagmarkervariables", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"varvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"tagmarkervariables", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{"2", "+", "j"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "2"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<vartitles, vartitlesshort, varvalues:\\n\\n\>\"", ",", "vartitles",
        ",", "vartitlesshort", ",", "varvalues", ",", "\"\<\\n\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nvars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"varvalues", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "varvalues", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indivfactor", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "individualvariables", "]"}], "\[Equal]", 
         "0"}], ",", "1", ",", 
        RowBox[{"Length", "[", "individualvariables", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nruns", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"nvars", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "vartitles", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"Length", "[", "nvars", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemtitles", "=", 
      RowBox[{"Tuples", "[", "varvalues", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<nvars, nruns, nvar, ensemtitles:\\n\\n\>\"", ",", "nvars", ",", 
       "\"\<, \>\"", ",", "nruns", ",", "\"\<, \>\"", ",", "nvar", ",", 
       "\"\<, \>\"", ",", "ensemtitles", ",", "\"\<\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ensemblevariables", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], "&&", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
            "individual"}], "&&", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
           "\[NotEqual]", "comment"}], "&&", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
            "tagmarker"}]}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"ensemblevariables", ",", 
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ensemblenos", "=", 
      RowBox[{"Tuples", "[", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nvar"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ensemblenames", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"ensemblenos", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ensemblevariables//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"ensemblevariables", "//", "TableForm"}], ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<ensemblenos:\\n\\n\>\"", ",", "ensemblenos", ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<ensemblenames:\\n\\n\>\"", ",", "ensemblenames", ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"data2", "=", "data"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"data2", ",", 
           RowBox[{"ensemblevariables", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "ensemblevariables", "]"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"data2", ",", 
           RowBox[{"origindividualvariables", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "origindividualvariables", "]"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"data2", ",", 
           RowBox[{"origtagmarkervariables", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "origtagmarkervariables", "]"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"data2", ",", 
           RowBox[{"comments", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "comments", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<data2//TableForm:\\n\\n\>\"", ",", 
       RowBox[{"data2", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"combos", "=", 
      RowBox[{"Tuples", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ensemblevariables", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ensemblevariables", "]"}]}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{
                RowBox[{"combos", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], 
               "]"}], "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"divs", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringPosition", "[", 
                   RowBox[{
                    RowBox[{"combos", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], 
                   "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"combos", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "grouper"}], 
                    "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"divs", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"divs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"divs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "+", "1"}]}], "}"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"Length", "[", "divs", "]"}]}], "}"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"PrependTo", "[", 
                RowBox[{"divs", ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"divs", ",", 
                RowBox[{"StringLength", "[", 
                 RowBox[{"combos", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"divs", "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "divs", "]"}], ",", "2"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"combos", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{
                   RowBox[{"combos", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                   RowBox[{"divs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"Length", "[", "divs", "]"}]}], "}"}]}], 
                "]"}]}]}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"combos", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"combos", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"combos", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "combos", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{
      "data2", ",", 
       "\"\<# --- BASELINE VARIABLES ----------------------------------------\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"data2", ",", "\"\<#\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{
      "data2", ",", 
       "\"\<# --- GENERATED ENSEMBLE VARIABLES ------------------------------\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemble", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"data2", ",", 
             RowBox[{"combos", "[", 
              RowBox[{"[", 
               RowBox[{"Ceiling", "[", 
                RowBox[{"i", "/", "indivfactor"}], "]"}], "]"}], "]"}]}], 
            "]"}], "]"}], ",", "comment"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"indivfactor", "\[Equal]", "1"}], ",", ",", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"ensemble", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"individualvariables", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "indivfactor", ",", "1"}], "]"}], ",", "j"}],
              "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nruns"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"individualvariables", "[", 
             RowBox[{"[", 
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "indivfactor", ",", "1"}], "]"}], "]"}], 
             "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"ensemble", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "comment"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringDrop", "[", 
      RowBox[{"ensembledatafile", ",", 
       RowBox[{"-", "4"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"configpatchnames", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
         RowBox[{"ensemblenames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ensemblenames", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<configpatches:\\n\\n\>\"", ",", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"ensemble", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"configpatchnames", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}], "//", 
        "TableForm"}], ",", "\"\<\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"linestart", "=", 
      RowBox[{
       RowBox[{
       "\"\</bin/bash qsub_\>\"", "<>", "genieversion", "<>", 
        "\"\<_myr_multipart.sh \>\""}], "~~", "config", "~~", "\"\< \>\"", "~~",
        "baseline", "~~", "\"\< \>\""}]}], ";", 
     RowBox[{"lineend", "=", 
      RowBox[{"\"\< \>\"", "~~", 
       RowBox[{"ToString", "[", "nparts", "]"}], "~~", "\"\< \>\"", "~~", 
       RowBox[{"ToString", "[", "startexpt", "]"}], "~~", "\"\< 1 \>\"", "~~", 
       RowBox[{"ToString", "[", "saveblock", "]"}], "~~", "\"\< \>\"", "~~", 
       RowBox[{"ToString", "[", 
        RowBox[{"startyears", "[", 
         RowBox[{"[", "startexpt", "]"}], "]"}], "]"}], "~~", "\"\< \>\"", "~~", 
       RowBox[{"ToString", "[", "minjobtime", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"qsub", ",", 
          RowBox[{"linestart", "~~", 
           RowBox[{"configpatchnames", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "~~", "lineend"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"qsub", ",", "\"\<sleep 2\>\""}], "]"}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"allconfigs", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"configs", "[", 
            RowBox[{"[", "e", "]"}], "]"}], ",", 
           RowBox[{"configpatchnames", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"datestring", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"PaddedForm", "[", 
        RowBox[{
         RowBox[{"Date", "[", "]"}], ",", "5", ",", 
         RowBox[{"NumberPadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"commas", "=", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"date", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"datestring", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"commas", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
             RowBox[{
              RowBox[{"commas", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"date2", "=", 
      RowBox[{"date", "~~", 
       RowBox[{"StringTake", "[", 
        RowBox[{"datestring", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "7"}], ",", 
           RowBox[{"-", "6"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "configroot", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"partscript", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"baseline", "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "f", "]"}], "<>", "\"\<.sh\>\""}], ",", 
           "\"\<Text\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"charstodrop", "=", 
         RowBox[{
          RowBox[{"StringLength", "[", "partscript", "]"}], "-", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"partscript", ",", "\"\<J=\>\""}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"baseline", "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "f", "]"}], "<>", "\"\<.sh\>\""}], ",", 
          RowBox[{
           RowBox[{"StringDrop", "[", 
            RowBox[{"partscript", ",", 
             RowBox[{"-", "charstodrop"}]}], "]"}], "<>", "\"\<J=\>\"", "<>", 
           
           RowBox[{"ToString", "[", 
            RowBox[{"startyears", "[", 
             RowBox[{"[", "f", "]"}], "]"}], "]"}], "<>", 
           "\"\<\\nfi\\n\\nRUNLENGTH=\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"nyearss", "[", 
             RowBox[{"[", "f", "]"}], "]"}], "]"}]}], ",", "\"\<Text\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"f", ",", "nparts"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"configpatchnames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ensemble", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "ensemble", "]"}]}], "}"}]}], "]"}], ";"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.459074795002851*^9, 3.459074811464979*^9}, {
   3.459074904189659*^9, 3.459074904540154*^9}, {3.45907495193193*^9, 
   3.459074967312273*^9}, {3.459075158171597*^9, 3.459075159307891*^9}, {
   3.4590786740804358`*^9, 3.4590788109625263`*^9}, {3.459078903260708*^9, 
   3.459078946704975*^9}, {3.4590791534658127`*^9, 3.459079285367588*^9}, {
   3.459080065151494*^9, 3.459080066359004*^9}, {3.459100707973563*^9, 
   3.459100708636888*^9}, {3.459166392758708*^9, 3.459166412835617*^9}, {
   3.4591665139872017`*^9, 3.4591665198727617`*^9}, {3.459166566475463*^9, 
   3.4591665760561543`*^9}, {3.4591666226093807`*^9, 
   3.4591666678177977`*^9}, {3.459166731042953*^9, 3.459166747957787*^9}, {
   3.459169892053071*^9, 3.459169901279461*^9}, {3.459170258631681*^9, 
   3.459170259734353*^9}, {3.4591708481021423`*^9, 3.459170857372985*^9}, {
   3.459170919141433*^9, 3.459170943720407*^9}, {3.459172176276607*^9, 
   3.459172185402156*^9}, {3.459172255415175*^9, 3.459172326454122*^9}, {
   3.459172368243012*^9, 3.4591724036400347`*^9}, {3.4591724403053293`*^9, 
   3.459172441711343*^9}, {3.459172633596858*^9, 3.4591726368100977`*^9}, {
   3.459172704080534*^9, 3.459172712195805*^9}, {3.4591728003397617`*^9, 
   3.4591728342988167`*^9}, {3.459173131447513*^9, 3.459173147592721*^9}, {
   3.459173479417383*^9, 3.4591734870542793`*^9}, {3.459173923619258*^9, 
   3.459173936120549*^9}, {3.459174029221278*^9, 3.459174034378647*^9}, {
   3.459174154225768*^9, 3.459174195615533*^9}, {3.45917428137418*^9, 
   3.4591743240438004`*^9}, {3.4591743751579733`*^9, 3.459174377986614*^9}, {
   3.459174441657002*^9, 3.45917444497445*^9}, {3.459174525016426*^9, 
   3.459174567388454*^9}, {3.459174635100749*^9, 3.4591746745189867`*^9}, {
   3.459174920298521*^9, 3.4591749216420507`*^9}, {3.459174978325041*^9, 
   3.4591749950415993`*^9}, {3.459175085623148*^9, 3.459175086110244*^9}, {
   3.459175148479677*^9, 3.459175148688274*^9}, {3.4591755567693644`*^9, 
   3.4591755833951693`*^9}, 3.459175785776322*^9, {3.459175844239687*^9, 
   3.459176203551592*^9}, {3.459183150704918*^9, 3.459183154327847*^9}, {
   3.462022692873423*^9, 3.462022894738447*^9}, {3.462023101013657*^9, 
   3.462023102159734*^9}, {3.462023279429778*^9, 3.462023280599462*^9}, {
   3.462025686459032*^9, 3.4620258304450207`*^9}, 3.462025954728031*^9, {
   3.462026078644506*^9, 3.462026078992055*^9}, {3.462028170640477*^9, 
   3.462028294768202*^9}, {3.462028345497471*^9, 3.4620284976301403`*^9}, {
   3.4620286558823*^9, 3.462028717817597*^9}, {3.462028810771039*^9, 
   3.4620288893038063`*^9}, {3.4620289528905277`*^9, 3.462028981006748*^9}, {
   3.4620290405329523`*^9, 3.462029073781234*^9}, {3.462029126982264*^9, 
   3.462029149437724*^9}, {3.462029205743031*^9, 3.462029243237153*^9}, 
   3.462030908535568*^9, 3.462033435653492*^9, {3.462625636527852*^9, 
   3.462625657338306*^9}, {3.46279577178653*^9, 3.4627957785871143`*^9}, {
   3.462795917455114*^9, 3.462795929595962*^9}, {3.468076959309486*^9, 
   3.4680769659221087`*^9}, {3.468077560243072*^9, 3.468077563767851*^9}, {
   3.4680776242485437`*^9, 3.468077635478664*^9}, {3.4680778589415703`*^9, 
   3.46807796387609*^9}, {3.468078089647419*^9, 3.468078151372261*^9}, {
   3.471878071408331*^9, 3.471878085482911*^9}, {3.471878117672367*^9, 
   3.471878164461635*^9}, {3.4718912241536427`*^9, 3.471891224273139*^9}, {
   3.474138132221548*^9, 3.474138162279563*^9}, {3.474144551038807*^9, 
   3.474144553590242*^9}, {3.474145451522839*^9, 3.4741454977292643`*^9}, {
   3.4831160968633842`*^9, 3.483116099310389*^9}, {3.483116431435733*^9, 
   3.48311649305044*^9}, {3.4831165320865383`*^9, 3.4831166126439342`*^9}, {
   3.483116795105439*^9, 3.483116869409438*^9}, 3.483116916012286*^9, {
   3.483117767903799*^9, 3.483117771172576*^9}, {3.4831178288169518`*^9, 
   3.48311787912206*^9}, {3.483117946532662*^9, 3.483117997824757*^9}, {
   3.4831182907289*^9, 3.483118293663686*^9}, {3.483118327078971*^9, 
   3.4831183345585737`*^9}, {3.483118372113393*^9, 3.483118376260043*^9}, {
   3.483120015013748*^9, 3.483120028771397*^9}, {3.483375060804699*^9, 
   3.483375063117669*^9}, {3.4833750938089857`*^9, 3.4833751070952177`*^9}, {
   3.483375283172534*^9, 3.4833752875789213`*^9}, {3.483375405510428*^9, 
   3.48337540601274*^9}, 3.4856086805399857`*^9, {3.485716056948586*^9, 
   3.485716078740241*^9}, {3.4857161196370077`*^9, 3.485716140705311*^9}, {
   3.485716254216957*^9, 3.4857164634790487`*^9}, {3.485716600597868*^9, 
   3.485716628184052*^9}, {3.48571716066667*^9, 3.485717176555831*^9}, {
   3.485717285778962*^9, 3.485717285947094*^9}, 3.485717550982408*^9, {
   3.485768951824255*^9, 3.48576896153716*^9}, {3.493373130070127*^9, 
   3.493373140225491*^9}, {3.4996123133050337`*^9, 3.4996123605067167`*^9}, {
   3.4996126104786587`*^9, 3.499612621420648*^9}, {3.500109041797964*^9, 
   3.500109041930758*^9}, {3.500109220568882*^9, 3.5001092249551363`*^9}, 
   3.500212499258662*^9, {3.509801488119223*^9, 3.509801489654776*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "runtimeroot", "]"}]], "Input",
 CellChangeTimes->{3.474147459505061*^9, 3.485609307950777*^9}],

Cell[BoxData[
 RowBox[{"qsub", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.459176248220619*^9, 3.459176251961863*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"runmode", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scriptname", "=", 
     RowBox[{
     "\"\<qsub_\>\"", "<>", "genieversion", "<>", 
      "\"\<_myr_multipart_expt_\>\"", "<>", "date"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"scriptname", ",", "qsub", ",", "\"\<Text\>\""}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.474147344499647*^9, 3.4741473512416353`*^9}, 
   3.485716183194528*^9, {3.5098014550685873`*^9, 3.509801474689028*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allconfigs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"allconfigs", ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.474153413549506*^9, 3.47415344124401*^9}, {
  3.4801554692938633`*^9, 3.48015548175723*^9}, {3.480156547340332*^9, 
  3.480156548514258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totjobs", "=", 
   RowBox[{"Length", "[", "allconfigs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<total no. of jobs: \>\"", ",", "totjobs"}], "]"}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"runmode", ">=", "2"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"allconfigs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"allconfigs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"\"\<ensemble_\>\"", "->", "\"\<e\>\""}]}], "]"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "allconfigs", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allconfigs", "//", "TableForm"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"running0", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"qstatname", ",", "\"\<html\>\""}], "]"}], ",", 
         RowBox[{"Import", "[", 
          RowBox[{"\"\<qstat\>\"", ",", "\"\<Text\>\""}], "]"}]}], "}"}], "[", 
       RowBox[{"[", "qstat", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<running.txt\>\"", ",", "running0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"running1", "=", 
      RowBox[{"Import", "[", "\"\<running.txt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<running1.dat\>\"", ",", "running1"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"running", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<running1.dat\>\"", ",", "\"\<Data\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "runtimeroot", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"runningid", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"running", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{"1", "+", "qstat"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "running", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runningjobno", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"running", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "running", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"del", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"runningid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], 
          "\[NotEqual]", "\"\<e\>\""}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"del", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "runningid", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runningid", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"runningid", ",", "del"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"runningjobno", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"runningjobno", ",", "del"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrunning", "=", 
      RowBox[{"Length", "[", "runningid", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endidposs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"runningid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<_\>\""}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runningjobs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"runningid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"endidposs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"del2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"n", "<=", 
               RowBox[{"Length", "[", "allconfigs", "]"}]}], "&&", 
              RowBox[{
               RowBox[{"runningjobs", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "==", 
               RowBox[{"allconfigs", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"del2", ",", 
               RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"n", "++"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "totjobs", "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"Length", "[", "runningjobs", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"del4", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "i", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}], ",", "del2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"runningjobs", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"runningjobs", ",", "del4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runningid", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"runningid", ",", "del4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"runningjobno", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"runningjobno", ",", "del4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"endidposs", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"endidposs", ",", "del4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrunning", "=", 
      RowBox[{"Length", "[", "runningjobs", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"jobtimes", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"runningid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"endidposs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", "2"}], ",", 
              RowBox[{"StringLength", "[", 
               RowBox[{"runningid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"runningjobs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<runningjobs: \\n\>\"", ",", 
       RowBox[{"runningjobs", "//", "TableForm"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<jobtimes: \\n\>\"", ",", 
       RowBox[{
        RowBox[{"Sort", "[", "jobtimes", "]"}], "//", "TableForm"}]}], "]"}], 
     ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"runningparts", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", "jobtimes", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<number of running jobs: \>\"", ",", 
       RowBox[{"Length", "[", "runningjobs", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m", "=", "1"}], ";", 
     RowBox[{"del3", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dead1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"m", "<=", 
           RowBox[{"Length", "[", "runningjobs", "]"}]}], "&&", 
          RowBox[{
           RowBox[{"runningjobs", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
           RowBox[{"allconfigs", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "3"}], "]"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"del3", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}], ";", 
          RowBox[{"m", "++"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Length", "[", "runningjobs", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "allconfigs", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deadjobs", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"allconfigs", ",", "del3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dead1", "[", 
         RowBox[{"[", 
          RowBox[{"del3", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", "0"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "del3", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<jobs not running (dead1) (1): \>\"", ",", "dead1"}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<not running jobs: \\n\>\"", ",", 
       RowBox[{"Length", "[", "deadjobs", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<test to see if \
Length[allconfigs]-Length[runningjobs]==Length[deadjobs]: \>\"", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "allconfigs", "]"}], "-", 
         RowBox[{"Length", "[", "runningjobs", "]"}]}], "==", 
        RowBox[{"Length", "[", "deadjobs", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deadjobs", "//", "TableForm"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"partsoutput", "=", 
      RowBox[{"Table", "[", 
       RowBox[{",", 
        RowBox[{"{", "totjobs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", "\"\<checking archives: \\n\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dir", "=", 
         RowBox[{"archiveroot", "~~", "\"\</\>\"", "~~", 
          RowBox[{"allconfigs", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "~~", "\"\<.\>\"", "~~", 
          "baseline", "~~", "\"\<.\>\"", "~~", 
          RowBox[{"allconfigs", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"direxists", "=", 
         RowBox[{"FileExistsQ", "[", "dir", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"dir", ",", "\"\<: \>\"", ",", "direxists"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"direxists", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetDirectory", "[", "dir", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"partpos", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"StringPosition", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FileNames", "[", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<_\>\""}], "]"}], 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"partsoutput", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FileNames", "[", "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"{", "partpos", "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], 
              "]"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"partsoutput", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<parts output:\>\"", ",", "partsoutput"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<tally of output parts: \>\"", ",", 
       RowBox[{"tally", "=", 
        RowBox[{"Tally", "[", "partsoutput", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<number of parts output: \>\"", ",", 
       RowBox[{"npartsoutput", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"tally", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "tally", "]"}]}], "}"}]}], "]"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"outfolders", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"allconfigs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "24"}], "]"}], "~~", 
         "\"\<.\>\"", "~~", 
         RowBox[{"StringDrop", "[", 
          RowBox[{
           RowBox[{"allconfigs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], "~~", 
         "\"\<_\>\"", "~~", 
         RowBox[{"ToString", "[", 
          RowBox[{"partsoutput", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "~~", "\"\</biogem\>\""}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"completedyears", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"Null", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<checking output years: \\n\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"direxists", "=", 
         RowBox[{"FileExistsQ", "[", 
          RowBox[{"outfolders", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"outfolders", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<: \>\"", ",", 
          "direxists"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"direxists", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetDirectory", "[", 
            RowBox[{"outfolders", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"file", "=", "\"\<biogem_series_atm_humidity.dat\>\""}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"fileexists", "=", 
            RowBox[{"FileExistsQ", "[", "file", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"file", ",", "\"\<: \>\"", ",", "fileexists"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"fileexists", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Import", "[", "file", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<%\>\""}], 
               ",", 
               RowBox[{
                RowBox[{"completedyears", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"completedyears", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Import", "[", "file", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"completedyears", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}], ";"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"completedyears", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"noncompletedjobs", "=", 
      RowBox[{"noncompletedjobsdisp", "=", 
       RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dead2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"partsoutput", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "<", "nparts"}], "||", 
          RowBox[{
           RowBox[{"nyearss", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ">", 
           RowBox[{
            RowBox[{"completedyears", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", "11"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"partsoutput", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "||", 
             RowBox[{
              RowBox[{"completedyears", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "==", "0"}]}], ",", 
            RowBox[{
             RowBox[{"dead2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "2"}], ",", 
            RowBox[{
             RowBox[{"dead2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"noncompletedjobs", ",", 
            RowBox[{"allconfigs", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"noncompletedjobsdisp", ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"allconfigs", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"completedyears", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ";"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<jobs not in archive or with no output in last part with output (2) \
or not finished (1): \>\"", ",", "dead2"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<unfinished jobs (last column is years run): \\n\>\"", ",", 
       RowBox[{"noncompletedjobsdisp", "//", "TableForm"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"deadjobs2", "=", 
      RowBox[{"Intersection", "[", 
       RowBox[{"deadjobs", ",", "noncompletedjobs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dead3", "=", 
      RowBox[{"dead1", "+", "dead2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<dead3: \>\"", ",", "dead3"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"deadjobsscript", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dead3", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">=", "2"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dead3", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "==", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"deadjobsscript", ",", 
             RowBox[{
             "\"\<cd \>\"", "~~", "clusterroot", "~~", "geniename", "~~", 
              "genieversion", "~~", "\"\<_archive\\nmv -f \>\"", "~~", 
              RowBox[{"allconfigs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "~~", "\"\<.\>\"", "~~",
               "baseline", "~~", "\"\<.\>\"", "~~", 
              RowBox[{"allconfigs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "~~", 
              "\"\< to_resub/.\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"lineend", "=", 
             RowBox[{"\"\< \>\"", "~~", 
              RowBox[{"ToString", "[", "nparts", "]"}], "~~", "\"\< \>\"", "~~", 
              RowBox[{"ToString", "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"partsoutput", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                 "1", ",", 
                 RowBox[{"partsoutput", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "~~", 
              "\"\< 1 \>\"", "~~", 
              RowBox[{"ToString", "[", "saveblock", "]"}], "~~", "\"\< \>\"", 
              "~~", 
              RowBox[{"ToString", "[", "startyear", "]"}], "~~", "\"\< \>\"", 
              "~~", 
              RowBox[{"ToString", "[", "minjobtime", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"deadjobsscript", ",", 
              RowBox[{
              "\"\<cd \>\"", "~~", "clusterroot", "~~", "geniename", "~~", 
               "scriptsroot", "~~", "\"\<\\n\>\"", "~~", 
               RowBox[{
               "\"\</bin/bash qsub_\>\"", "<>", "genieversion", "<>", 
                "\"\<_myr_multipart.sh \>\""}], "~~", 
               RowBox[{"allconfigs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "~~", "\"\< \>\"", "~~",
                "baseline", "~~", "\"\< \>\"", "~~", 
               RowBox[{"allconfigs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "~~", "lineend"}]}], 
             "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "totjobs"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"deadjobsscript", ",", "\"\<#\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"deadjobsscript", ",", "\"\<#!/bin/bash\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"deadjobsscript", ",", "\"\<\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"deadjobsscript", ",", 
       RowBox[{
       "\"\<cd \>\"", "~~", "clusterroot", "~~", "geniename", "~~", 
        "scriptsroot"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"deadjobsscript", ",", 
       RowBox[{
       "\"\</bin/bash resub_\>\"", "~~", "genieversion", "~~", 
        "\"\<_myr_multipart.sh\>\"", "~~", "\"\< \>\"", "~~", 
        RowBox[{"ToString", "[", "nparts", "]"}], "~~", "\"\< \>\"", "~~", 
        RowBox[{"ToString", "[", "saveblock", "]"}], "~~", "\"\< \>\"", "~~", 
        
        RowBox[{"ToString", "[", "minjobtime", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "dead3", "]"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\\n\\n dead jobs script in \>\"", ",", "runtimeroot", ",", 
          "\"\< to submit: \\n\>\"", ",", 
          RowBox[{"deadjobsscript", "//", "TableForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "runtimeroot", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"\"\<deadjobs_\>\"", "~~", "date"}], ",", "deadjobsscript", 
          ",", "\"\<Text\>\""}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<\\nall jobs have completed successfully or are currently still \
running :-)\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "deadjobs2", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SetDirectory", "[", 
         RowBox[{"runtimeroot", "~~", "\"\</..\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"deadjobfilenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<*\>\"", "<>", 
            RowBox[{"deadjobs2", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "<>", "\"\<*\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "deadjobs2", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crashfilestop", "=", 
         RowBox[{"crashfilestoday", "=", 
          RowBox[{"crashfilesbottom", "=", 
           RowBox[{"crashfiles", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"\"\<\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "deadjobs2", "]"}], "}"}]}], 
             "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<processing runlogs in top level directory matching dead job: \
\>\"", ",", 
             RowBox[{"deadjobs2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\"\<...\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"crashfilestop", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FileNames", "[", 
             RowBox[{"deadjobfilenames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "deadjobs2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"crashfilestop", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"today", "=", 
              RowBox[{"ToString", "[", 
               RowBox[{"StringDrop", "[", 
                RowBox[{
                 RowBox[{"StringJoin", "@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "[", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "\[Equal]", 
                    "1"}], ",", "\"\<0\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Date", "[", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "~~", 
                    "\"\<-\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"SetDirectory", "[", "today", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
               "\"\<no runlogs in top level directory; processing runlogs in \
today's directory (\>\"", "~~", "today", "~~", 
                "\"\<) matching dead job: \>\""}], ",", 
               RowBox[{"deadjobs2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\"\<...\>\""}], 
              "]"}], ";", 
             RowBox[{
              RowBox[{"crashfilestoday", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"FileNames", "[", 
               RowBox[{"deadjobfilenames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"crashfiles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"crashfilestoday", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"crashfilestop", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"crashfiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"crashfilestop", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "deadjobs2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"crashfilestoday", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
               "\"\<no runlogs in top level directory or today's directory \
(\>\"", "~~", "today", "~~", "\"\<) matching \>\""}], ",", 
               RowBox[{"deadjobs2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               "\"\<; processing runlogs in older directories...\>\""}], 
              "]"}], ";", 
             RowBox[{
              RowBox[{"crashfilesbottom", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"FileNames", "[", 
               RowBox[{
                RowBox[{"deadjobfilenames", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "\"\<*\>\"", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"crashfiles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"crashfilesbottom", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"crashfilestoday", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"crashfilestop", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"crashfiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"crashfilestoday", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"crashfilestop", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "deadjobs2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crashfiles", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"crashfiles", ",", "\"\<\>\"", ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"crashfiledates", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"FileDate", "[", 
            RowBox[{"crashfiles", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"crashfiledates2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"crashfiledates", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "j"}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"crashfiledates3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"crashfiledates2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"lastcrashfilenos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Last", "[", 
            RowBox[{"crashfiledates3", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiledates3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"crashfiles2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"crashfiles", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"lastcrashfilenos", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"lastcrashfilenos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"lastchars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"crashfiles2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles2", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiles2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"lastcrashfilenos2", "=", 
         RowBox[{"crashfiledates4", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "deadjobs2", "]"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lastchars", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[NotEqual]", 
             "\"\<h\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"lastcrashfilenos2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"lastcrashfilenos", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"crashfiledates4", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"crashfiledates3", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "crashfiles2", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"crashfiles2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crashfiledates5", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"DateString", "[", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"crashfiledates4", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiledates4", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiledates4", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"crashfiles3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"crashfiles", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"lastcrashfilenos2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"lastcrashfilenos2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               "nrunlogstolookat"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"crashfiles4", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"crashfiles3", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<Text\>\""}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles3", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiles3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"crashfiles5", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Row", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Style", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<\\n\\n\>\"", "~~", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"crashfiles3", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "~~", 
                  "\"\< modified on \>\"", "~~", 
                  RowBox[{"crashfiledates5", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "~~", 
                  "\"\<:\\n\\n\>\""}], ",", "Blue", ",", "Italic", ",", 
                 "15"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringLength", "[", 
                    RowBox[{"crashfiles4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ">", 
                    "ncharsperrunlogtooutput"}], ",", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"crashfiles4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "ncharsperrunlogtooutput"}]}], "]"}], "]"}], 
                   ",", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"crashfiles4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
                 ",", "Black", ",", "Plain", ",", "12"}], "]"}]}], "}"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"crashfiles3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<\\n\\n\\nlast outputs for dead jobs' runlogs:\\n\\n\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"StyleForm", "[", 
             RowBox[{
              RowBox[{"deadjobs2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "20"}]}], "]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"crashfiles5", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"crashfiles5", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<\\n\\n\\n\\n\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "crashfiles", "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.474138175055833*^9, 3.474138191548115*^9}, 
   3.4741383334039593`*^9, {3.474138382798318*^9, 3.474138417884132*^9}, {
   3.4741384742909307`*^9, 3.474138474639532*^9}, {3.4741388962918587`*^9, 
   3.474138898801114*^9}, {3.474139386325881*^9, 3.474139425107142*^9}, {
   3.474139970780126*^9, 3.47413998245979*^9}, {3.47414005033714*^9, 
   3.474140051439248*^9}, {3.4741445648806057`*^9, 3.4741445726718893`*^9}, {
   3.474145558314033*^9, 3.4741455584217253`*^9}, {3.474145641681347*^9, 
   3.4741456785810223`*^9}, {3.474147389537881*^9, 3.474147537224704*^9}, {
   3.474147588419291*^9, 3.474147653889164*^9}, {3.4741477402131643`*^9, 
   3.4741478120226107`*^9}, 3.474147897371655*^9, {3.474147972008315*^9, 
   3.4741479817543583`*^9}, {3.474148031547464*^9, 3.4741480363745537`*^9}, {
   3.47414807535005*^9, 3.474148077418475*^9}, {3.474148114431855*^9, 
   3.474148150803524*^9}, {3.474148198789157*^9, 3.474148204144484*^9}, 
   3.474148252331913*^9, {3.474153398560178*^9, 3.474153410583816*^9}, {
   3.474304088036091*^9, 3.474304089359425*^9}, {3.4747161564801598`*^9, 
   3.474716174652286*^9}, {3.474716830911459*^9, 3.474716888610506*^9}, 
   3.474717039583269*^9, {3.47488745915968*^9, 3.474887512664806*^9}, {
   3.474887548836152*^9, 3.474887585792184*^9}, {3.4748877771862783`*^9, 
   3.474887838922522*^9}, {3.474887879380471*^9, 3.474887884018524*^9}, {
   3.4749032589666643`*^9, 3.474903327677821*^9}, {3.47490338887004*^9, 
   3.474903433734962*^9}, {3.474978749381131*^9, 3.474978750807334*^9}, {
   3.474979027835607*^9, 3.474979046647723*^9}, {3.4749793373184347`*^9, 
   3.474979403756701*^9}, {3.4751592048296347`*^9, 3.4751592052076883`*^9}, 
   3.475243413749755*^9, {3.4753273710858707`*^9, 3.475327371920514*^9}, {
   3.480157828797996*^9, 3.480157846272794*^9}, {3.480159852260989*^9, 
   3.4801598944837437`*^9}, {3.480160402358182*^9, 3.48016041608609*^9}, {
   3.480160970191629*^9, 3.480160985200658*^9}, {3.480161866779278*^9, 
   3.480161868601057*^9}, {3.481912742363558*^9, 3.481912773419203*^9}, {
   3.48526286785297*^9, 3.485262868815702*^9}, {3.4852629401380796`*^9, 
   3.4852629784785223`*^9}, 3.485609321409677*^9, {3.485617273484131*^9, 
   3.485617277986743*^9}, {3.485630425751379*^9, 3.4856304345533867`*^9}, {
   3.485630640560461*^9, 3.485630663718812*^9}, 3.485630715059001*^9, {
   3.485630816854781*^9, 3.485630824842902*^9}, {3.4856308638596582`*^9, 
   3.485630881120175*^9}, {3.485631322736989*^9, 3.4856313495220213`*^9}, {
   3.485631478787751*^9, 3.485631614173316*^9}, {3.485631679951681*^9, 
   3.4856317715776367`*^9}, {3.485631871273466*^9, 3.485631879395569*^9}, {
   3.485632022216671*^9, 3.4856320312145433`*^9}, {3.48563209993083*^9, 
   3.485632144757536*^9}, 3.4856323529067*^9, {3.4856325435036182`*^9, 
   3.48563257883904*^9}, {3.485632674402157*^9, 3.485632696719611*^9}, {
   3.4856328172751427`*^9, 3.4856328277286053`*^9}, {3.48563289492257*^9, 
   3.4856329518608427`*^9}, {3.485634215416237*^9, 3.485634255044569*^9}, {
   3.485634315835891*^9, 3.485634365182631*^9}, {3.4856350078830557`*^9, 
   3.48563510374408*^9}, {3.485635164331729*^9, 3.4856352122891283`*^9}, 
   3.4856352906095047`*^9, {3.485635372787829*^9, 3.485635457216086*^9}, 
   3.485790046764626*^9, {3.485796331447796*^9, 3.48579634029004*^9}, {
   3.485796403593227*^9, 3.4857964394404182`*^9}, {3.485797418777685*^9, 
   3.485797431693893*^9}, {3.485797510560939*^9, 3.4857975317331944`*^9}, {
   3.485797570810157*^9, 3.485797571997933*^9}, {3.4857976364585*^9, 
   3.485797678350133*^9}, 3.485797717046376*^9, 3.485797894170933*^9, {
   3.485802530613014*^9, 3.485802565209272*^9}, 3.4858026879405737`*^9, {
   3.485802747046341*^9, 3.4858027878420753`*^9}, {3.485802860570822*^9, 
   3.485802921802527*^9}, {3.4858031502264833`*^9, 3.485803215267858*^9}, {
   3.485803960217808*^9, 3.485804055888771*^9}, {3.4858040940998583`*^9, 
   3.485804126776218*^9}, {3.485804196302698*^9, 3.485804293948903*^9}, {
   3.485804378568256*^9, 3.485804380886057*^9}, {3.485804444166943*^9, 
   3.485804591563305*^9}, {3.485804757514016*^9, 3.4858047604825974`*^9}, {
   3.485804816222478*^9, 3.48580481827859*^9}, {3.485804906378055*^9, 
   3.485804911798497*^9}, {3.485805160400227*^9, 3.485805292809219*^9}, {
   3.48580535363935*^9, 3.4858053548119802`*^9}, {3.485805632827566*^9, 
   3.4858057081964827`*^9}, 3.4858057614417458`*^9, {3.485805903226061*^9, 
   3.485805908579218*^9}, {3.485807153221839*^9, 3.485807190626211*^9}, 
   3.485807229591748*^9, {3.4858072741208363`*^9, 3.4858072742276278`*^9}, {
   3.4861154224331007`*^9, 3.486115423920382*^9}, {3.486115588920805*^9, 
   3.486115590452272*^9}, {3.486116031953347*^9, 3.486116033002021*^9}, 
   3.4861161418822937`*^9, {3.486116862193902*^9, 3.4861168635854883`*^9}, {
   3.486122716660282*^9, 3.4861227772456512`*^9}, {3.486123195776243*^9, 
   3.4861231962223873`*^9}, {3.4861232953023863`*^9, 3.486123295504568*^9}, {
   3.4861258127097692`*^9, 3.4861258529126177`*^9}, {3.486126109211532*^9, 
   3.486126117159877*^9}, {3.486126433340437*^9, 3.486126436387504*^9}, 
   3.4861266073919*^9, {3.486126648210964*^9, 3.486126702255198*^9}, {
   3.486126829883404*^9, 3.486126837774035*^9}, {3.486126868903414*^9, 
   3.4861269081084642`*^9}, {3.486127017735457*^9, 3.4861270753344917`*^9}, {
   3.486127148290332*^9, 3.4861271524324627`*^9}, {3.4861293300226*^9, 
   3.486129331413801*^9}, {3.486129731440687*^9, 3.48612975366024*^9}, {
   3.4861297917581453`*^9, 3.486129850944928*^9}, {3.4861298902246323`*^9, 
   3.4861298980426826`*^9}, {3.486130002963929*^9, 3.4861300458610153`*^9}, {
   3.4861305021516123`*^9, 3.486130514578191*^9}, {3.4861311003528337`*^9, 
   3.486131134853484*^9}, {3.486131168361595*^9, 3.486131217455332*^9}, {
   3.486132825201069*^9, 3.486132830001884*^9}, {3.4861400292650423`*^9, 
   3.4861400412950993`*^9}, {3.486140131423623*^9, 3.486140157688512*^9}, {
   3.486144631069872*^9, 3.486144633189715*^9}, {3.48614467468463*^9, 
   3.4861446765190153`*^9}, {3.4861447125898542`*^9, 3.486144719958989*^9}, 
   3.4861450894199247`*^9, {3.4861468503113337`*^9, 3.486146920592684*^9}, {
   3.486146995656571*^9, 3.486147038322784*^9}, {3.486147544926619*^9, 
   3.486147578913167*^9}, {3.48614763790425*^9, 3.486147747450338*^9}, {
   3.486147783722102*^9, 3.486147897684002*^9}, 3.486147948573772*^9, {
   3.486148052641789*^9, 3.486148053747074*^9}, {3.486148188274111*^9, 
   3.486148217302902*^9}, {3.486148249996147*^9, 3.486148253506569*^9}, {
   3.4861483385458183`*^9, 3.486148341037212*^9}, {3.4861505210357857`*^9, 
   3.486150548569421*^9}, {3.486150786663939*^9, 3.486150787050523*^9}, {
   3.4861973381209993`*^9, 3.486197339928719*^9}, 3.4861997847318172`*^9, {
   3.486199951301427*^9, 3.486199959640304*^9}, 3.486200651834467*^9, {
   3.486200778558399*^9, 3.486200779106319*^9}, {3.4862011218634653`*^9, 
   3.486201157449093*^9}, {3.486201263096353*^9, 3.486201368105771*^9}, 
   3.4862015845122957`*^9, {3.486202925118183*^9, 3.486202939659272*^9}, {
   3.48620783966007*^9, 3.486207840296404*^9}, {3.486364759520629*^9, 
   3.4863647628695917`*^9}, {3.486364823401947*^9, 3.486364855729492*^9}, {
   3.4863648905557013`*^9, 3.4863649274833508`*^9}, {3.489411253821786*^9, 
   3.489411256823237*^9}, {3.48949963442822*^9, 3.489499642808217*^9}, {
   3.489499712369115*^9, 3.489499761386608*^9}, {3.48974953528813*^9, 
   3.4897495403857203`*^9}, {3.489751279100587*^9, 3.489751285608683*^9}, {
   3.493365296835575*^9, 3.4933652997834053`*^9}, {3.493365331337885*^9, 
   3.493365333905692*^9}, {3.4933657229993353`*^9, 3.493365727959347*^9}, {
   3.4933705832339773`*^9, 3.49337058984519*^9}, {3.493370853362485*^9, 
   3.4933708687534933`*^9}, {3.493371240565299*^9, 3.49337124184184*^9}, 
   3.4933715611082487`*^9, {3.497346793963849*^9, 3.497346797020466*^9}, {
   3.500205134489715*^9, 3.5002051348155603`*^9}, {3.5098012714507008`*^9, 
   3.509801302640957*^9}, {3.50980141984336*^9, 3.509801442236774*^9}, {
   3.510033588757728*^9, 3.510033588918056*^9}, {3.5106499744292603`*^9, 
   3.510649975985083*^9}, {3.510650015179481*^9, 3.510650038559166*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"runmode", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"qsub", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "qsub", "]"}]}], "}"}]}], "]"}], "//", 
      "TableForm"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"qsubnew", "=", 
     RowBox[{"qsub", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
         "22", ",", "23", ",", "28", ",", "29", ",", "34", ",", "35", ",", 
         "36"}], "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"qsubnew", "//", "TableForm"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"scriptname", "=", 
     RowBox[{
      RowBox[{
      "\"\<qsub_\>\"", "<>", "genieversion", "<>", 
       "\"\<_myr_multipart_expt_\>\""}], "~~", "date"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"scriptname", ",", "qsubnew", ",", "\"\<Text\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"runningidyears", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"runningid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{
                  RowBox[{"runningid", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<_\>\""}], "]"}], 
                "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
              RowBox[{"StringLength", "[", 
               RowBox[{"runningid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dodgy", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IntegerQ", "[", 
         RowBox[{
          RowBox[{"runningidyears", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "4000"}], "]"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"dodgy", ",", "i"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nrunning"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dodgy", "//", "TableForm"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Length", "[", "dodgy", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Sort", "[", "runningidyears", "]"}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"qdel", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\"\<qdel \>\"", "~~", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"runningjobno", "[", 
           RowBox[{"[", "dodgy", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "~~", "\"\<\\nsleep 2\>\""}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"runningjobno", "[", 
           RowBox[{"[", "dodgy", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"qdel", "//", "TableForm"}], ";", "\[IndentingNewLine]", 
    RowBox[{"scriptname", "=", 
     RowBox[{"\"\<qdel_\>\"", "~~", "date"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"runmode", "\[Equal]", "3"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{"scriptname", ",", "qdel", ",", "\"\<Text\>\""}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"runningid", "[", 
      RowBox[{"[", "dodgy", "]"}], "]"}], "//", "TableForm"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"running", "//", "TableForm"}], ";"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47429009198181*^9, 3.474290095789006*^9}, {
   3.4742901664005938`*^9, 3.474290191630001*^9}, {3.474290284217359*^9, 
   3.474290285799716*^9}, 3.474718097701131*^9, {3.474978770942305*^9, 
   3.474978908346946*^9}, 3.483115729421727*^9, 3.4857162012695837`*^9, {
   3.509801527664832*^9, 3.509801528544838*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Collate Results:",
 FontSlant->"Italic"]], "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
  3.40006649821875*^9, 3.400066566703125*^9}, {3.437727312162577*^9, 
  3.437727319537369*^9}, {3.437743770863562*^9, 3.437743773982688*^9}, {
  3.4591009237956257`*^9, 3.45910092540738*^9}, {3.462023391733471*^9, 
  3.462023397846716*^9}, {3.4620293719611263`*^9, 3.4620293751829033`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$HistoryLength", "=", "0"}], ";", 
   RowBox[{"Share", "[", "]"}], ";", 
   RowBox[{"Unprotect", "[", 
    RowBox[{"In", ",", "Out"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.4943976813558607`*^9, 3.4943976839542294`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotdatasets", "=", 
   RowBox[{"newlegendpluss", "=", 
    RowBox[{"graphics3s", "=", 
     RowBox[{"data5", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"Null", ",", 
        RowBox[{"{", "nensem", "}"}], ",", 
        RowBox[{"{", "nparts", "}"}]}], "]"}]}]}]}]}], ";", 
  RowBox[{"dataset3s", "=", 
   RowBox[{"baseliness", "=", 
    RowBox[{"nrunss", "=", 
     RowBox[{"controls", "=", 
      RowBox[{"alltimescaless", "=", 
       RowBox[{"allweightingss", "=", 
        RowBox[{"allbases", "=", 
         RowBox[{"allpeaks", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"Null", ",", 
            RowBox[{"{", "nensem", "}"}], ",", 
            RowBox[{"{", "nparts", "}"}]}], "]"}]}]}]}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydatas", "=", 
   RowBox[{"droptables", "=", 
    RowBox[{"varvaluess", "=", 
     RowBox[{"runss", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"Null", ",", 
        RowBox[{"{", "nensem", "}"}]}], "]"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4911954481916723`*^9, 3.491195454860619*^9}, {
   3.4911955051022987`*^9, 3.491195511072474*^9}, {3.491203123859301*^9, 
   3.491203125209519*^9}, {3.4912041762252407`*^9, 3.491204180366181*^9}, {
   3.492666703848773*^9, 3.492666724005856*^9}, {3.4927906056982822`*^9, 
   3.492790606584949*^9}, {3.4927964018419523`*^9, 3.492796410108184*^9}, 
   3.492796443265827*^9, {3.4942655458805304`*^9, 3.4942655829087143`*^9}, {
   3.494265752033929*^9, 3.494265758941777*^9}, {3.508767234603463*^9, 
   3.508767249468837*^9}, 3.5087673983462133`*^9, {3.5120628767059803`*^9, 
   3.5120628831056223`*^9}, {3.512062914664631*^9, 3.51206292771697*^9}, {
   3.52559452893664*^9, 3.525594535579607*^9}, {3.528536415314384*^9, 
   3.528536418016017*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"starttime", "=", 
   RowBox[{"Date", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<started processing: \>\"", ",", "starttime"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4887160920865517`*^9, 3.488716145141265*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"collatedirsandfiles", "=", 
   RowBox[{"{", 
    RowBox[{
    "outputfolder", ",", "resultsfoldersuffix", ",", "finalresultsfolder"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"collatedirsandfilestext", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<outputfolder\>\"", ",", "\"\<resultsfoldersuffix\>\"", ",", 
     "\"\<finalresultsfolder\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    StyleBox["If",
     FontColor->GrayLevel[0]], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox[
      RowBox[{"Not", "[", 
       RowBox[{"FileExistsQ", "[", 
        RowBox[{"collatedirsandfiles", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}],
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{"CreateDialog", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"collatedirsandfilestext", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "~~", 
          StyleBox["\"\< '\>\"",
           FontColor->GrayLevel[0]], 
          StyleBox["~~",
           FontColor->GrayLevel[0]], 
          StyleBox[
           RowBox[{"collatedirsandfiles", "[", 
            RowBox[{"[", "i", "]"}], "]"}],
           FontColor->GrayLevel[0]], 
          StyleBox["~~",
           FontColor->GrayLevel[0]], 
          
          StyleBox[
           "\"\<' does not exist or is not connected, click Abort in the \
window 'Local Kernel Interrupt' and check\>\"",
           FontColor->GrayLevel[0]]}], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}], 
      StyleBox[";",
       FontColor->GrayLevel[0]], 
      StyleBox["\[IndentingNewLine]",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{"Interrupt", "[", "]"}],
       FontColor->GrayLevel[0]]}]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->GrayLevel[0]], 
   RowBox[{
    StyleBox["{",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["i",
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["Length",
       FontColor->GrayLevel[0]], 
      StyleBox["[",
       FontColor->GrayLevel[0]], "collatedirsandfiles", "]"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.485847488068632*^9, 3.4858475274746933`*^9}, {
  3.485849138446836*^9, 3.485849180409239*^9}, {3.485850019272441*^9, 
  3.485850022243392*^9}}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "alpha", "=", 
   "\"\<abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+-\>\""}\
], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texall", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{\>\"", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
       RowBox[{"ensemoutnames", "[", 
        RowBox[{"[", "e", "]"}], "]"}], "~~", "\"\<}\\n\\n\\n\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texinc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ndroptabvars", "*", 
        RowBox[{"(", 
         RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"texinc", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
   "{", "\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{Time-series of key \
variables}\\\\label{sec:Time-series of key variables}\\n\\n\\n\>\"", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"texinc", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{
   "{", "\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{Tabulated results for \
key variables}\\\\label{sec:Tabulated results for key \
variables}\\n\\n\\n\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"texinc", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"ndroptabvars", "*", 
       RowBox[{"(", 
        RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], "=", 
   RowBox[{
   "{", "\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{Percentages of key \
variables remaining}\\\\label{sec:Percentages of key variables \
remaining}\\n\\n\\n\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"texinc", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"ndroptabvars", "*", 
       RowBox[{"(", 
        RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}], "=", 
   RowBox[{
   "{", "\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{\\\\textit{e}-folding \
timescales of key variables remaining}\\\\label{sec:e-folding timescales of \
key variables remaining}\\n\\n\\n\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"textitles", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"titleshort", "<>", "\"\<_\>\"", "<>", 
       RowBox[{"analysisvars", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"tabletypesshort", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "<>", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[Equal]", 
          RowBox[{"Length", "[", "tabletypesshort", "]"}]}], ",", 
         RowBox[{"ToString", "[", "fitbase", "]"}], ",", "\"\<\>\""}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ndroptabvars"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "tabletypesshort", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"PrependTo", "[", 
   RowBox[{"textitles", ",", 
    RowBox[{
    "titleshort", "<>", "\"\<_\>\"", "<>", "\"\<timeseries_plots\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"textitles", ",", 
    RowBox[{
    "titleshort", "<>", "\"\<_\>\"", "<>", 
     "\"\<efold_timescale_plots\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"textitles", ",", 
     RowBox[{
     "titleshort", "<>", "\"\<_\>\"", "<>", "\"\<frac_remain_plots\>\""}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"copyfinalresultsscript", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<#!/bin/bash\>\"", ",", "\"\<#\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ensemblename", "=", 
      RowBox[{"ensembleroot", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemshort", "=", 
      RowBox[{"ensemblerootshort", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"outtitleprefix", "=", 
      RowBox[{
      "titleshort", "~~", "\"\<_\>\"", "~~", "ensemshort", "~~", 
       "\"\<_\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembledatafile", "=", 
      RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"config", "=", 
      RowBox[{"configs", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"configshort", "=", 
      RowBox[{"configshorts", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"configroot", "=", 
      RowBox[{"configroots", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"outputfolder", "=", 
      RowBox[{"outputfolders", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"archiveroot", "=", 
      RowBox[{"archiveroots", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colours", "=", 
      RowBox[{"coloursensem", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<ensemblename, ensemshort, ensembledatafile:\\n\\n\>\"", ",", 
       "ensemblename", ",", "\"\<, \>\"", ",", "ensemshort", ",", 
       "\"\<, \>\"", ",", "ensembledatafile"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resultsfolder", "=", 
      RowBox[{
      "resultsfoldersuffix", "~~", "titleshort", "~~", "\"\<_\>\"", "~~", 
       "ensemblename"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "[", "resultsfolder", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\\n\\nPart : \>\"", ",", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}], ",", "\"\<\\n\\n\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"plotstartyear", "=", 
         RowBox[{"plotstartyears", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nyears", "=", 
         RowBox[{"nyearss", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<nyears = \>\"", ",", "nyears", ",", "\"\<\\n\\n\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Part", " ", "1"}], " ", "-", " ", "initialise"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "configroot", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", "ensembledatafile", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<data//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"data", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tagmarkervariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
              "\[Equal]", "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"tagmarkervariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"origtagmarkervariables", "=", "tagmarkervariables"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tagmarkervariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<tagmarkervariables//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"tagmarkervariables", "//", "TableForm"}], ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nvar", "=", 
         RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vartitles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "<", "nparts"}], "&&", 
                RowBox[{"nvar", ">", "1"}]}], ",", "2", ",", "1"}], "]"}], 
             ",", "nvar"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vartitlesshort", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "<", "nparts"}], "&&", 
                RowBox[{"nvar", ">", "1"}]}], ",", "2", ",", "1"}], "]"}], 
             ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"varvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"2", "+", "j"}]}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "<", "nparts"}], "&&", 
                RowBox[{"nvar", ">", "1"}]}], ",", "2", ",", "1"}], "]"}], 
             ",", "nvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "2"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"varvaluess", "[", 
          RowBox[{"[", "e", "]"}], "]"}], "=", "varvalues"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<vartitles, vartitlesshort, varvalues:\\n\\n\>\"", ",", 
          "vartitles", ",", "vartitlesshort", ",", "varvalues", ",", 
          "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "<", "nparts"}], "&&", 
           RowBox[{"nvar", ">", "1"}]}], ",", 
          RowBox[{"nvar", "-=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"varvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "1"}], ",", 
          RowBox[{"control", "=", "1"}], ",", 
          RowBox[{"control", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"controls", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "control"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nruns", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"nvars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrunss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nruns"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coloursorig", "=", "colours"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nruns", ">", 
           RowBox[{"Length", "[", "colours", "]"}]}], ",", 
          RowBox[{"colours", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"coloursorig", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Hue", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{"1", "-", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"nruns", "-", 
                    RowBox[{"Length", "[", "colours", "]"}]}], ")"}]}]}], ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"nruns", "-", 
                    RowBox[{"Length", "[", "colours", "]"}]}], ")"}]}]}], 
                 "}"}]}], "]"}]}], "}"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prod1", "=", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prod2", "=", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"prod3", "=", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"prod2", "<=", "prod3"}], ",", "\[IndentingNewLine]", 
             RowBox[{"varstyles", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}], ",", 
                RowBox[{"{", "4", "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"varstyles", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "2", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"combine1and2", "\[Equal]", "1"}], ",", 
             RowBox[{"varstyles", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", "3", "}"}], ",", 
                RowBox[{"{", "4", "}"}]}], "}"}]}]}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"varstyles", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"varstyles", " ", "-", " ", 
            RowBox[{
             RowBox[{"e", ".", "g", ".", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "2", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ".", " ", "The"}], 
             " ", "second", " ", "and", " ", "third", " ", "lists", " ", 
             "are", " ", "grouped", " ", "depending", " ", "on", " ", 
             "variable", " ", 
             RowBox[{"numbers", ".", " ", "The"}], " ", "first", " ", "list", 
             " ", "is", " ", "colour"}]}], ";", " ", 
           RowBox[{"the", " ", "second", " ", "line", " ", "thickness"}]}], 
          ",", 
          RowBox[{
           RowBox[{"and", " ", "the", " ", "third", " ", 
            RowBox[{"dashing", ".", " ", "The"}], " ", "numbers", " ", 
            "correspond", " ", "to", " ", "the", " ", "variable", " ", 
            "numbers"}], "-", 
           RowBox[{
           "so", " ", "in", " ", "the", " ", "above", " ", "example", " ", 
            "variable", " ", "1", " ", 
            RowBox[{"(", "\"\<e.g emissions\>\"", ")"}], " ", "is", " ", 
            "represented", " ", "by", " ", "colour"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "and", " ", "variable", " ", "2", " ", "by", " ", "line"}], "-", 
            RowBox[{
             RowBox[{"thickness", " ", "[", 
              RowBox[{
               RowBox[{
               "For", " ", "variable", " ", "2", " ", "having", " ", "more", 
                " ", "members", " ", "than", " ", "variable", " ", "1"}], ",",
                " ", 
               RowBox[{
               "variables", " ", "1", " ", "and", " ", "2", " ", "are", " ", 
                "swapped", " ", "so", " ", "variable", " ", "1", " ", "is", 
                " ", "represented", " ", "by", " ", "line", " ", "thickness", 
                " ", "and", " ", "variable", " ", "2", " ", "colour"}]}], 
              "]"}], " ", "If", " ", "you", " ", "were", " ", "to", " ", 
             "have", " ", "varstyles"}]}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"it", " ", "would", " ", "be", " ", "the", " ", "same"}], 
          ",", " ", 
          RowBox[{
          "but", " ", "with", " ", "the", " ", "addition", " ", "of", " ", 
           "variables", " ", "3", " ", "and", " ", "4", " ", "being", " ", 
           "combinedly", " ", "represented", " ", "by", " ", "different", " ", 
           RowBox[{"dashing", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ensemtitles", "=", 
         RowBox[{"Tuples", "[", "varvalues", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<nvars, control, nruns, nvar, varstyles, ensemtitles:\\n\\n\>\"",
           ",", "nvars", ",", "\"\<, \>\"", ",", "control", ",", "\"\<, \>\"",
           ",", "nruns", ",", "\"\<, \>\"", ",", "nvar", ",", "\"\<, \>\"", 
          ",", "varstyles", ",", "\"\<, \>\"", ",", "ensemtitles", ",", 
          "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblevariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "individual"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"ensemblevariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenos", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nvar"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"ensemblenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"f", "<", "nparts"}], ",", "\"\<1\>\"", ",", 
              "\"\<\>\""}], "]"}], "<>"}], "*)"}], 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"ensemblenos", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"ensemblenos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ensemblevariables//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"ensemblevariables", "//", "TableForm"}], ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ensemblenos:\\n\\n\>\"", ",", "ensemblenos", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ensemblenames:\\n\\n\>\"", ",", "ensemblenames", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Part", " ", "2"}], " ", "-", " ", 
          RowBox[{"calculate", " ", "names", " ", "for", " ", "output"}]}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nruns", "\[Equal]", "1"}], ",", 
          RowBox[{"runids", "=", 
           RowBox[{"{", "configshort", "}"}]}], ",", 
          RowBox[{
           RowBox[{"runids", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
              "configshort", "~~", "\"\<.\>\"", "~~", "ensemshort", "~~", 
               "\"\<_\>\"", "~~", 
               RowBox[{"ensemblenames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", "f", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<runids:\\n\\n\>\"", ",", 
          RowBox[{"runids", "//", "TableForm"}], ",", "\"\<\\n\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"filenames", "=", 
         RowBox[{"nfilenames", "=", 
          RowBox[{"shortfilenames", "=", 
           RowBox[{"longfilenames", "=", 
            RowBox[{"filenameslist", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "nmodules", "}"}]}], "]"}]}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ntimeseries", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"direxists", "=", "False"}], ";", 
           RowBox[{"fnames", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"direxists", "\[Equal]", "False"}], "||", 
              RowBox[{"fnames", "==", 
               RowBox[{"{", "}"}]}]}], ",", 
             RowBox[{
              RowBox[{"dir", "=", 
               RowBox[{"outputfolder", "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                  "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                  "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
                RowBox[{"modules", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"direxists", "=", 
               RowBox[{"FileExistsQ", "[", "dir", "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{"direxists", ",", 
                RowBox[{
                 RowBox[{"SetDirectory", "[", "dir", "]"}], ";", 
                 RowBox[{"fnames", "=", 
                  RowBox[{"FileNames", "[", "]"}]}]}]}], "]"}], ";", 
              RowBox[{"i", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"direxists", "==", "False"}], ",", 
             RowBox[{
             "Print", "[", "\"\<ERROR: no runs have output\>\"", "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"filenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"nfilenames", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"shortfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"longfilenames", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{"{", "}"}]}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringCases", "[", 
                  RowBox[{"fnames", ",", "\"\<series\>\""}], "]"}], "[", 
                 RowBox[{"[", "o", "]"}], "]"}], "\[Equal]", 
                RowBox[{"{", "\"\<series\>\"", "}"}]}], ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"filenames", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"fnames", "[", 
                   RowBox[{"[", "o", "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"ntimeseries", "++"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"filenameslist", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"o", ",", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{
                    RowBox[{"filenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"15", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", "ntimeseries"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Length", "[", 
             RowBox[{"filenamenos", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"shortfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"o", "+", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"j", "\[Equal]", "1"}], ",", "0", ",", 
                   RowBox[{"nfilenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{
                    RowBox[{"filenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"filenamenos", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"15", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", 
                RowBox[{"nfilenames", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"longfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"o", "+", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"j", "\[Equal]", "1"}], ",", "0", ",", 
                   RowBox[{"nfilenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{
                    RowBox[{"filenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"filenamenos", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", 
                RowBox[{"nfilenames", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"i", ",", 
              RowBox[{"shortfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nfilenamestot", "=", 
         RowBox[{"Total", "[", "nfilenames", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<time series output:\\n\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "//", "TableForm"}], ",", 
            "\"\<\\n\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tabs", "=", 
         RowBox[{"tabcodes", "=", 
          RowBox[{"subdirs", "=", 
           RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tabcode1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"alpha", ",", 
             RowBox[{"{", 
              RowBox[{"tab1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"divisions", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"tabs", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tabcodes", ",", 
               RowBox[{"{", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"alpha", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"subdirs", ",", 
               RowBox[{"runids", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"divisions", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Format", "[", 
             RowBox[{"v", "[", "n_Integer", "]"}], "]"}], ":=", 
            RowBox[{"\"\<v\>\"", "<>", 
             RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"list", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"v", ",", "nvar"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"varmultipliers", "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Product", "[", 
                  RowBox[{
                   RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"n", ",", "nvar", ",", 
                    RowBox[{"nvar", "-", "m"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "0", ",", 
                   RowBox[{"nvar", "-", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
              "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"vs", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
                    RowBox[{"tabcomp", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"list", ",", "n"}], "]"}], ",", "o"}], "]"}], "-",
                     "1"}], ")"}], " ", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"varmultipliers", "[", 
                    RowBox[{"[", 
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"varmultipliers", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "]"}], "+", 
                    "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"tabcodecomp", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"alpha", ",", 
                    RowBox[{"{", 
                    RowBox[{"tabcomp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "tabcomp", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"tabs", ",", "tabcomp"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"tabcodes", ",", "tabcodecomp"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"subdirs", ",", 
                    RowBox[{"\"\<comparisons_\>\"", "~~", 
                    RowBox[{"ToString", "[", "n", "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
                 "\[IndentingNewLine]", "##"}], "]"}], "&"}], "@", 
              RowBox[{"(", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Delete", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", "n"}], 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"divisions", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"tabs", ",", "tab1"}], "]"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"AppendTo", "[", 
            RowBox[{"tabcodes", ",", "tabcode1"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"subdirs", ",", "\"\<comparisons_0_all\>\""}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ntabs", "=", 
         RowBox[{"Length", "[", "tabs", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "resultsfolder", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"partnames", "[", 
          RowBox[{"[", "f", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"partnames", "[", 
          RowBox[{"[", "f", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"datestring", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"PaddedForm", "[", 
           RowBox[{
            RowBox[{"Date", "[", "]"}], ",", "5", ",", 
            RowBox[{"NumberPadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"commas", "=", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"datestring", ",", "\"\<,\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"date", "=", 
         RowBox[{"date2", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"datestring", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"commas", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
                 RowBox[{
                  RowBox[{"commas", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "commas", "]"}]}], "}"}]}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sameoutdir", "\[Equal]", "1"}], ",", 
          RowBox[{"date", "=", "\"\<9999999999\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newdirectory", "=", "date"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "newdirectory", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "newdirectory", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ensemkey", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Prepend", "[", 
                RowBox[{"tabcode1", ",", "\"\<code\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Prepend", "[", 
                RowBox[{"tab1", ",", "\"\<tab\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Prepend", "[", 
                RowBox[{"ensemblenames", ",", "\"\<ensemble no.\>\""}], "]"}],
                "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Prepend", "[", 
                RowBox[{"ensemtitles", ",", "vartitles"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"nruns", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
          "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"ensemblename", "~~", "\"\<_key.csv\>\""}], ",", 
          "ensemkey"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Part", " ", "3"}], " ", "-", " ", 
          RowBox[{
          "collate", " ", "data", " ", "and", " ", "output", " ", "as", " ", 
           "spreadsheets"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<reading in time series data...\\n\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"data2", "=", 
         RowBox[{"columntitles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"nfilenames", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", "nruns", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"filename", "=", 
            RowBox[{"filenames", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"filenamenos", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<-- \>\"", "~~", "filename", "~~", "\"\< --\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<processing \>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"file", "=", 
               RowBox[{"outputfolder", "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                  "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                  "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
                RowBox[{"modules", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                  "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}], "~~", 
                "filename"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FileExistsQ", "[", "file", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"data", "=", 
                  RowBox[{"Import", "[", "file", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "data", "]"}], "\[Equal]", "1"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"h", "=", "1"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"h", ",", "1"}], "]"}], "]"}], "]"}], "\[Equal]", 
                    "String"}], ",", 
                    RowBox[{"h", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"data", ",", 
                    RowBox[{"h", "-", "1"}]}], "]"}]}], ";"}]}], "]"}], ";"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"data", "=", 
                  RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"data", "\[NotEqual]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"titlestring", "=", 
                 RowBox[{"StringJoin", "[", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", "\"\< \>\""}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"slashes", "=", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"titlestring", ",", 
                 RowBox[{"columntitledividers", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"slashes2", "=", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"slashes", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "slashes", "]"}]}], "}"}]}], "]"}],
                    ",", "2"}], "]"}], ",", 
                 RowBox[{"StringLength", "[", "titlestring", "]"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"slashes3", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"slashes2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{
                    RowBox[{"slashes2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "slashes2", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"columntitles", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"titlestring", ",", 
                   RowBox[{"slashes3", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", "slashes3", "]"}]}], "}"}]}], 
                "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "nruns"}], "}"}]}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"data2", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "$Failed", ",", "___"}], "}"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"data2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "//", "TableForm"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"columntitles2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"columntitles", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "o", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"filenames", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"filenamenos", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nfilenames", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"calculate", " ", "total", " ", "weathering"}], ",", " ", 
          RowBox[{"sed", " ", "burrial", " ", "and", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sed", " ", "burrial"}], " ", "-", " ", "weath"}], 
            ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newfilenamenos", "=", "filenamenos"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"extras", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "==", 
             "\"\<focnsed CaCO3\>\""}], ",", 
            RowBox[{
             RowBox[{"extras", "+=", "1"}], ";", 
             RowBox[{"focnsedCaCO3", "=", "j"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "shortfilenames", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "==", 
             "\"\<fsedocn Ca\>\""}], ",", 
            RowBox[{
             RowBox[{"extras", "+=", "1"}], ";", 
             RowBox[{"fsedocnCa", "=", "j"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "shortfilenames", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "==", 
             "\"\<weather fCaCO3\>\""}], ",", 
            RowBox[{
             RowBox[{"extras", "+=", "1"}], ";", 
             RowBox[{"weatherfCaCO3", "=", "j"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "shortfilenames", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "==", 
             "\"\<weather fCaSiO3\>\""}], ",", 
            RowBox[{
             RowBox[{"extras", "+=", "1"}], ";", 
             RowBox[{"weatherfCaSiO3", "=", "j"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "shortfilenames", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"extras", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"data2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "2", ",", "weatherfCaCO3", ",", "k", ",", "i", ",", "1"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    "2", ",", "weatherfCaCO3", ",", "k", ",", "i", ",", "2"}],
                     "]"}], "]"}], "+", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    "2", ",", "weatherfCaSiO3", ",", "k", ",", "i", ",", 
                    "2"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "weatherfCaSiO3", ",", "k"}], "]"}], 
                   "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"data2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "1", ",", "focnsedCaCO3", ",", "k", ",", "i", ",", "1"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "1", ",", "focnsedCaCO3", ",", "k", ",", "i", ",", "2"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "1", ",", "fsedocnCa", ",", "k", ",", "i", ",", "2"}], 
                    "]"}], "]"}]}], ")"}], "/", 
                  RowBox[{"10", "^", "12"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "focnsedCaCO3", ",", "k"}], "]"}], 
                   "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"data2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "2", ",", "weatherfCaSiO3", ",", "k", ",", "i", ",", "1"}],
                    "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "1", ",", "focnsedCaCO3", ",", "k", ",", "i", ",", "2"}], 
                    "]"}], "]"}], "-", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "1", ",", "fsedocnCa", ",", "k", ",", "i", ",", "2"}], 
                    "]"}], "]"}]}], ")"}], "/", 
                   RowBox[{"10", "^", "12"}]}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "2", ",", "weatherfCaCO3", ",", "k", ",", "i", ",", "2"}],
                     "]"}], "]"}], "+", 
                    RowBox[{"data2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "2", ",", "weatherfCaSiO3", ",", "k", ",", "i", ",", 
                    "2"}], "]"}], "]"}]}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "weatherfCaSiO3", ",", "k"}], "]"}], 
                   "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"columntitles2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<rokgem_series_weather_ftotal.dat\>\"", ",", "\"\<year\>\"",
                ",", "\"\<Total weathering flux (Tmol yr-1)\>\""}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"columntitles2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<rokgem_series_sed_burrial_CaCO3.dat\>\"", ",", 
               "\"\<year\>\"", ",", 
               "\"\<sed burrial of CaCO3 (Tmol yr-1)\>\""}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"columntitles2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<rokgem_series_sed_bur_minus_weath.dat\>\"", ",", 
               "\"\<year\>\"", ",", 
               "\"\<sed burrial of CaCO3 - weath (Tmol yr-1)\>\""}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "1"}], ",", 
               "\"\<weather ftotal\>\""}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "2"}], ",", 
               "\"\<sed burrial CaCO3\>\""}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"shortfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "3"}], ",", 
               "\"\<sed bur minus Si weath\>\""}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"longfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "1"}], ",", 
               "\"\<rokgem series weather ftotal\>\""}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"longfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "2"}], ",", 
               "\"\<rokgem series sed burrial CaCO3\>\""}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"longfilenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nfilenamestot", "+", "3"}], ",", 
               "\"\<rokgem_series sed bur minus Si weath\>\""}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"filenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             "\"\<rokgem_series_weather_ftotal.dat\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"filenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             "\"\<rokgem_series_sed_burrial_CaCO3.dat\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"filenames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             "\"\<rokgem_series_sed_bur_minus_Si_weath.dat\>\""}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"newfilenamenos", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"filenamenos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", "1"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"newfilenamenos", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"filenamenos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", "2"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"newfilenamenos", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"filenamenos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", "3"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+=", "3"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nfilenamestot", "+=", "3"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"calculate", " ", "sed", " ", "burrial", " ", "and", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sed", " ", "burrial"}], " ", "-", " ", 
            RowBox[{"Si", " ", "weath"}]}], ")"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\\n\\ncolumn titles:\\n\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"modules", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "~~", "\"\<:\\n\>\""}], ",", 
               
               RowBox[{
                RowBox[{"columntitles2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "//", "TableForm"}], ",", 
               "\"\<\\n\\n\>\""}], "]"}], ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"valueoutput", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "o", ",", "k", ",", "l", ",", "n"}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nfilenames", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "2", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data2", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "o", ",", 
                 RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nruns"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data2", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"valueoutput", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"valueoutput", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "5", ",", "3", ",", "4"}], "}"}]}], 
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"longestrun", "=", 
         RowBox[{"Last", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"data2", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}], 
                 ",", "j", ",", "o", ",", "k"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"o", ",", 
                 RowBox[{"nfilenames", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ",", "2"}], 
            "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"nyearsmax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"data2", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "o", ",", "k"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yearsmax0D", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"data2", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"longestrun", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"longestrun", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"longestrun", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", "i", ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nyearsmax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"columntitles2", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "o"}], "]"}], "]"}], "!=", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PrependTo", "[", 
               RowBox[{
                RowBox[{"valueoutput", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "o", ",", "n"}], "]"}], "]"}], ",", 
                "yearsmax0D"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"runids2", "=", 
               RowBox[{"Prepend", "[", 
                RowBox[{"runids", ",", 
                 RowBox[{
                  RowBox[{"columntitles2", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", 
                    RowBox[{"n", "+", "2"}]}], "]"}], "]"}], "~~", 
                  "\"\< / year:\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"PrependTo", "[", 
                 RowBox[{
                  RowBox[{"valueoutput", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "n", ",", "k"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"runids2", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "+", "1"}]}], "}"}]}], "]"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"valueoutput", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "o", ",", "n"}], "]"}], "]"}], "//", 
               "TableForm"}], "]"}], "*)"}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"data2", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "o", ",", 
                 RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], 
             "-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
         "\"\<time_series_output_list.xls\>\"", ",", "filenameslist"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
          "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "\"\<spreadsheets\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "\"\<spreadsheets\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"\"\<0_titles-\>\"", "~~", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sameoutdir", "\[Equal]", "1"}], ",", "\"\<\>\"", ",", 
              "date"}], "]"}], "~~", "\"\<.xls\>\""}], "]"}], ",", 
          "columntitles2"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"divisions", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CreateDirectory", "[", 
              RowBox[{"\"\<comparisons_\>\"", "~~", 
               RowBox[{"ToString", "[", "n", "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"vartitles", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"divisions", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{
          "CreateDirectory", "[", "\"\<comparisons_0_all\>\"", "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"exportname", "=", 
              RowBox[{"ToString", "[", 
               RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                RowBox[{"ToString", "[", "f", "]"}], "~~", "\"\<_\>\"", "~~", 
                
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"sameoutdir", "\[Equal]", "1"}], ",", "\"\<\>\"", 
                  ",", 
                  RowBox[{"\"\<_\>\"", "~~", "date"}]}], "]"}], "~~", 
                "\"\<_\>\"", "~~", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"columntitles2", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", 
                "\"\<.xls\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Export", "[", 
              RowBox[{"exportname", ",", 
               RowBox[{"valueoutput", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], ";"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"yaxislabels", "=", "columntitles2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yaxislabels", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"yaxislabels", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yaxislabels", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"yaxislabels", ",", "\"\<\>\"", ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<yaxislabels: \>\"", ",", "yaxislabels", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"data3", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"valueoutput", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"data3", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], ",", "1"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"data3", "[", 
                RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"data3", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"data4", "=", "data3"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data5", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "data4"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"saveallspreadsheets", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<\\n\\nsaving spreadsheets...\\n\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"dateref", "=", 
            RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<total time elapsed                                  time \
saving spreadsheets...\\n\>\"", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Do", "[", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tab", "=", 
               RowBox[{"tabs", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"tabcode", "=", 
               RowBox[{"tabcodes", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"DateDifference", "[", 
                 RowBox[{"starttime", ",", 
                  RowBox[{"Date", "[", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"", 
                    ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                RowBox[{"DateDifference", "[", 
                 RowBox[{"dateref", ",", 
                  RowBox[{"Date", "[", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"", 
                    ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                RowBox[{"\"\< -- runs: \>\"", "~~", 
                 RowBox[{"ToString", "[", "tab", "]"}], "~~", 
                 "\"\< -- \>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "tab", "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"SetDirectory", "[", 
                  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                   RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                   "newdirectory", "~~", "\"\</spreadsheets\>\""}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"spreadsheettitle", "=", 
                  RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                   RowBox[{"ToString", "[", "f", "]"}], "~~", "\"\<_\>\"", "~~", 
                   RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", 
                   "\"\<_all_variables_\>\"", "~~", 
                   RowBox[{"ToString", "[", "nyears", "]"}], "~~", 
                   "\"\<yr.xls\>\""}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"spreadsheet", "=", 
                  RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"spreadsheet", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"columntitles2", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}], "]"}]}], "]"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"PrependTo", "[", 
                  RowBox[{"spreadsheet", ",", 
                   RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", 
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\< / year:\>\""}]}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"spreadsheet", "=", 
                  RowBox[{"{", "spreadsheet", "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"spreadsheettitle", ",", "spreadsheet"}], "]"}]}]}],
                "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "tab", "]"}], "!=", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"spreadsheetall", "=", 
                  RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SetDirectory", "[", 
                    RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "newdirectory", "~~", "\"\</spreadsheets/\>\"", "~~", 
                    RowBox[{"subdirs", "[", 
                    RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"runids2", "=", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"runids", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"columntitles2", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "+", "q"}]}], "]"}], "]"}], "~~", 
                    "\"\< / year:\>\""}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"spreadsheettitle", "=", 
                    RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                    RowBox[{"ToString", "[", "f", "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", 
                    "\"\<_\>\"", "~~", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"longfilenames", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "2"}], "]"}], "]"}], "~~", 
                    "\"\<_units\>\"", "~~", 
                    RowBox[{"ToString", "[", "q", "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", "nyears", "]"}], "~~", 
                    "\"\<yr.xls\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"spreadsheet", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"tab", ",", "0"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"runids2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"tab", ",", "0"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "tab", "]"}], "+", "1"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"spreadsheetall", ",", "spreadsheet"}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"spreadsheet", "=", 
                    RowBox[{"{", "spreadsheet", "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Export", "[", 
                    RowBox[{"spreadsheettitle", ",", "spreadsheet"}], "]"}], 
                    ";"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"SetDirectory", "[", 
                  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                   RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                   "newdirectory", "~~", "\"\</spreadsheets\>\""}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"spreadsheettitle", "=", 
                  RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                   RowBox[{"ToString", "[", "f", "]"}], "~~", "\"\<_\>\"", "~~", 
                   RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", 
                   "\"\<_all_variables_\>\"", "~~", 
                   RowBox[{"ToString", "[", "nyears", "]"}], "~~", 
                   "\"\<yr.xls\>\""}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"spreadsheettitle", ",", "spreadsheetall"}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "tab", "]"}], "\[Equal]", "nruns"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"spreadsheetall", "=", 
                  RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"SetDirectory", "[", 
                  RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                   RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                   "newdirectory", "~~", "\"\</spreadsheets\>\""}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"spreadsheettitle", "=", 
                  RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                   RowBox[{"ToString", "[", "f", "]"}], "~~", 
                   "\"\<__all runs__all_variables_\>\"", "~~", 
                   RowBox[{"ToString", "[", "nyears", "]"}], "~~", 
                   "\"\<yr.xls\>\""}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"spreadsheet", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"spreadsheet", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"columntitles2", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"PrependTo", "[", 
                    RowBox[{"spreadsheet", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", 
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\< / year:\>\""}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"spreadsheetall", ",", "spreadsheet"}], "]"}], 
                    ";"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"spreadsheettitle", ",", "spreadsheetall"}], 
                  "]"}]}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "ntabs"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"finalresults", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetDirectory", "[", "finalresultsfolder", "]"}], ";", 
           RowBox[{"CreateDirectory", "[", "ensemblename", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SetDirectory", "[", "ensemblename", "]"}], ";", 
           RowBox[{"CreateDirectory", "[", 
            RowBox[{"partnames", "[", 
             RowBox[{"[", "f", "]"}], "]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"finalresultsfolderinuse", "=", 
            RowBox[{
            "finalresultsfolder", "<>", "titleshort", "<>", "\"\<_\>\"", "<>",
              "ensemblename"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"copyfinalresultsscript", ",", 
             RowBox[{"\"\<mkdir \>\"", "<>", "finalresultsfolderinuse"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"copyfinalresultsscript", ",", 
             RowBox[{
             "\"\<mkdir \>\"", "<>", "finalresultsfolderinuse", "<>", 
              "\"\</\>\"", "<>", 
              RowBox[{"partnames", "[", 
               RowBox[{"[", "f", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"copyfinalresultsscript", ",", 
             RowBox[{
             "\"\<cp -rf \>\"", "<>", "resultsfolder", "<>", "\"\</\>\"", "<>", 
              RowBox[{"partnames", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
              "newdirectory", "<>", "\"\</* \>\"", "<>", 
              "finalresultsfolderinuse", "<>", "\"\</\>\"", "<>", 
              RowBox[{"partnames", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "<>", "\"\</\>\""}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"copyfinalresultsscript", ",", 
             RowBox[{
             "\"\<mkdir \>\"", "<>", "finalresultsfolderinuse", "<>", 
              "\"\</\>\"", "<>", 
              RowBox[{"partnames", "[", 
               RowBox[{"[", "f", "]"}], "]"}], "<>", 
              "\"\</archived_output\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"copyfinalresultsscript", ",", 
               RowBox[{
               "\"\<cp -rf \>\"", "<>", "archiveroot", "<>", "\"\</\>\"", "<>",
                 "configs", "<>", "\"\<.\>\"", "<>", "baseline", "<>", 
                "\"\<.\>\"", "<>", "ensemblename", "<>", "\"\<_\>\"", "<>", 
                RowBox[{"ensemblenames", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
                "configshort", "<>", "\"\<.\>\"", "<>", "ensemshort", "<>", 
                "\"\<_\>\"", "<>", 
                RowBox[{"ensemblenames", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
                RowBox[{"ToString", "[", "f", "]"}], "<>", "\"\<* \>\"", "<>",
                 "finalresultsfolderinuse", "<>", "\"\</\>\"", "<>", 
                RowBox[{"partnames", "[", 
                 RowBox[{"[", "f", "]"}], "]"}], "<>", 
                "\"\</archived_output/\>\""}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"copyfinalresultsscript", ",", "\"\<\\n\>\""}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Part", " ", "4"}], " ", "-", " ", 
          RowBox[{"timeseries", " ", "plots"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"a", ".", "Calculate"}], " ", "stuff", " ", "for", " ", 
          "plots"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"startvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"maxima", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}],
                   "]"}], "==", "Real"}], ",", 
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
                ",", 
                RowBox[{"-", 
                 RowBox[{"10.", "^", "99"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"10.", "^", "99"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"minima", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}],
                   "]"}], "==", "Real"}], ",", 
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
                ",", 
                RowBox[{"10.", "^", "99"}], ",", 
                RowBox[{"10.", "^", "99"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"infotable", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"yaxislabels", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"2", "+", "j"}]}], "]"}], "]"}], ",", 
                  RowBox[{"startvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"minima", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"maxima", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"minima", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nfilenamestot"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"infotable", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<name\>\"", ",", 
            "\"\<start\>\"", ",", "\"\<min\>\"", ",", "\"\<max\>\"", ",", 
            "\"\<name\>\"", ",", "\"\<start\>\"", ",", "\"\<min\>\"", ",", 
            "\"\<max\>\"", ",", "\"\<name\>\"", ",", "\"\<start\>\"", ",", 
            "\"\<min\>\"", ",", "\"\<max\>\"", ",", "\"\<name\>\"", ",", 
            "\"\<start\>\"", ",", "\"\<min\>\"", ",", "\"\<max\>\""}], 
           "}"}]}], "]"}], ";", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"infotable", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<variable no.\>\"", ",", "\"\<variable name\>\"", ",", 
            "\"\<units 1\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
            "\"\<\>\"", ",", "\"\<units 2\>\"", ",", "\"\<\>\"", ",", 
            "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<units 3\>\"", ",", 
            "\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
            "\"\<units 4\>\""}], "}"}]}], "]"}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"Rotate", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"vartitles", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "24"}], "]"}], 
              ",", 
              RowBox[{"Pi", "/", "2"}]}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"\"\<time_series_collated.csv\>\"", ",", "infotable"}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"b", ".", "Legend"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nstyles", "=", 
         RowBox[{"Length", "[", "varstyles", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"combvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"varvalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"varstyles", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Last", "[", 
                 RowBox[{"varstyles", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prods", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", 
               RowBox[{"varstyles", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"varstyles", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"styles", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"colours", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"Thickness", "[", 
                 RowBox[{
                  RowBox[{"linethicknesses", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "*", "k"}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"prods", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ">", 
              RowBox[{"prods", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"styles", "=", 
              RowBox[{"Reverse", "[", "styles", "]"}]}]}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"colours", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"prods", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
           ";"}]}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nvar", ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"styles", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"linethicknesses", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"prods", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"styles", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"colours", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"prods", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"styles", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"colours", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"prods", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ";"}]}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", ">", "2"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"styles", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Dashing", "[", 
                RowBox[{"dashings", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"nvars", "[", 
                   RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                "}"}]}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"legstyles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "Null"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "2"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", "Null"}], 
               "]"}]}], "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphstyles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Null"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "2"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", "Null"}], 
               "]"}]}], "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"multigraphstyles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "Null"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "2"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "Null"}], 
               "]"}]}], "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphics2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Directive", "@@", 
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"graphstyles", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"graphstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphics3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Directive", "@@", 
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"multigraphstyles", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"multigraphstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"gap", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
               "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
           RowBox[{"StyleForm", "[", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "1"}]}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newlegend", "=", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"legstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                     "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"StyleForm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\< \>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", "+", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "<>", 
                    RowBox[{"Last", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
                    "\"\<\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                     "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                   RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                    RowBox[{"\"\<   \>\"", "<>", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                    ",", "\"\<\>\""}], "]"}]}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", "gap"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\\nlegend:\\n\>\"", ",", 
          RowBox[{"newlegend", "//", "TableForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"nos", "[", 
            RowBox[{"[", 
             RowBox[{"varstyles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"nos1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlegsecs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"varstyles", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legtitlenos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", ">", "1"}], ",", 
              RowBox[{
               RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legspacenos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"legtitlenos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legdisplaynos", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"legtitlenos", ",", "legspacenos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"c", ".", "Save"}], " ", "all", " ", "graphs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"saveallgraphs", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetDirectory", "[", 
            RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
             RowBox[{"partnames", "[", 
              RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
             "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CreateDirectory", "[", "\"\<graphs\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SetDirectory", "[", "\"\<graphs\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"divisions", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"CreateDirectory", "[", 
                 RowBox[{"runids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "]"}], ";"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"divisions", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"CreateDirectory", "[", 
                 RowBox[{"\"\<comparisons_\>\"", "~~", 
                  RowBox[{"ToString", "[", "n", "]"}], "~~", "\"\<_\>\"", "~~", 
                  RowBox[{"vartitles", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ";"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"divisions", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], ",", 
             RowBox[{
             "CreateDirectory", "[", "\"\<comparisons_0_all\>\"", "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"xmin", "=", "xmindefault"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"xmax", "=", "nyears"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ymin", "=", "ymindefault"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ymax", "=", "ymaxdefault"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"yauto", "=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"zerox", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"zeroy", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"correctdrift", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"title", "=", "False"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<\\n\\nsaving graphs...\\n\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"dateref", "=", 
            RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<total time elapsed                                   time \
saving graphs...\\n\>\"", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", " ", 
           RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Clear", "[", "graph", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tab", "=", 
               RowBox[{"tabs", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"tabcode", "=", 
               RowBox[{"tabcodes", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"SetDirectory", "[", 
               RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"partnames", "[", 
                 RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                "newdirectory", "~~", "\"\</graphs/\>\"", "~~", 
                RowBox[{"subdirs", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "\[Equal]", "1"}], "&&", 
                 RowBox[{"l", "\[Equal]", "1"}], "&&", 
                 RowBox[{"t", "\[Equal]", "1"}]}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"DateDifference", "[", 
                   RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                  RowBox[{"DateDifference", "[", 
                   RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                  RowBox[{"\"\< -- \>\"", "~~", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "2"}], "]"}], "]"}], "~~", 
                   "\"\< -- \>\""}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"min", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"minima", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                  RowBox[{"startvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
                 RowBox[{"minima", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"max", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                 RowBox[{
                  RowBox[{"maxima", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                  RowBox[{"startvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
                 RowBox[{"maxima", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"ymindefault", "=", 
                 RowBox[{"min", "-", 
                  RowBox[{"0.1", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"ymaxdefault", "=", 
                 RowBox[{"max", "+", 
                  RowBox[{"0.1", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"xmindefault", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"zerox", "\[Equal]", "False"}], ",", 
                   "plotstartyear", ",", "0"}], "]"}]}], ";"}], "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ymin", "=", 
               RowBox[{"min", "-", 
                RowBox[{"0.1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"maxima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                   RowBox[{"minima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"ymax", "=", 
               RowBox[{"max", "+", 
                RowBox[{"0.1", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"maxima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
                   RowBox[{"minima", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"plotlabel", "=", 
               RowBox[{"StyleForm", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<Variation of `` with time for ``\\n ``\\n ``; ``yr run\
\>\"", ",", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"shortfilenames", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "2"}], "]"}], "]"}], ",", "config", ",",
                    "info", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    "\"\<relative to preindustrial\>\"", ",", "\"\<\>\""}], 
                    "]"}], ",", "xmax"}], "]"}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
                 RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"nosinuse", "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"ensemblenos", "[", 
                    RowBox[{"[", "tab", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], 
              ";", 
              RowBox[{"nosinuse2", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"nos2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"nosinuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"nosinuse", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", 
              RowBox[{"nosinuse3", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nosinuse2", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"i", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nosinuse4", "=", 
               RowBox[{"Union", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", 
                  "legdisplaynos"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newlegendplus", "=", 
               RowBox[{"newlegend", "[", 
                RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"graph", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"l", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Grid", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1", ",", "i"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zerox", "\[Equal]", "True"}], ",", 
                    "plotstartyear", ",", "0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], "-", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"correctdrift", "\[Equal]", "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                    RowBox[{"yaxislabels", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}]}], "}"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "50"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}]}], "}"}]}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "0"}]}], "]"}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Last", "[", "ranges", "]"}], "]"}], "/", "2"}], 
                    ",", 
                    RowBox[{"ymin", "+", 
                    RowBox[{"0.715", "*", 
                    RowBox[{"(", 
                    RowBox[{"ymax", "-", "ymin"}], ")"}]}]}]}], "}"}]}], 
                    "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "500", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "60", ",", "0"}], 
                    "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", "graphics3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "11"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                    ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                 "ShowLegend", "[", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ListLogLinearPlot", "[", "##", "]"}], ",", 
                    RowBox[{"ListPlot", "[", "##", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "&"}], "@", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1", ",", "i"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zerox", "\[Equal]", "True"}], ",", 
                    "plotstartyear", ",", "0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], "-", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"correctdrift", "\[Equal]", "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", 
                    ",", "plotlabel"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<year\>\"", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                    RowBox[{"yaxislabels", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "+", "q"}]}], "]"}], "]"}]}]}], "}"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"plotstartyear", ",", "nyears"}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"yauto", ",", "Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"yeartickslog", ",", "Automatic"}], "}"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"graphics2", "[", 
                    RowBox[{"[", 
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], "}"}]}]}], "}"}]}],
                     ")"}]}], ",", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
                    RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LegendBorder", "\[Rule]", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LegendPosition", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.9", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LegendSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"graphtitle", "=", 
               RowBox[{"ensemblename", "~~", "\"\<_pt\>\"", "~~", 
                RowBox[{"ToString", "[", "f", "]"}], "~~", "\"\<_\>\"", "~~", 
                
                RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", 
                "\"\<_\>\"", "~~", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"longfilenames", ",", "1"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "2"}], "]"}], "]"}], "~~", 
                "\"\<_units\>\"", "~~", 
                RowBox[{"ToString", "[", "q", "]"}], "~~", "\"\<_\>\"", "~~", 
                
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"correctdrift", "\[Equal]", "True"}], ",", 
                  "\"\<_driftcorr_\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr_\>\"", "~~", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<log\>\"", ",", "\"\<linear\>\"", ",", 
                   "\"\<broken\>\""}], "}"}], "[", 
                 RowBox[{"[", "l", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"Export", "[", 
                 RowBox[{
                  RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
                   RowBox[{"saveformats", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], 
               "]"}], ";"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"q", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"data4", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "3"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "ntabs"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"5.", " ", "Analysis"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"timescaleanalysis", "\[Equal]", "1"}], "&&", 
           RowBox[{"f", "\[Equal]", "nparts"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"texensem", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "nplotvars", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["If",
             FontColor->GrayLevel[0]], 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox[
              RowBox[{"Not", "[", 
               RowBox[{"FileExistsQ", "[", "writeuproot", "]"}], "]"}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             RowBox[{
              RowBox[{"CreateDialog", "[", 
               RowBox[{"{", 
                RowBox[{
                 StyleBox[
                  RowBox[{
                  "\"\<writeuproot '\>\"", "<>", "writeuproot", "<>", 
                   "\"\<' does not exist or is not connected, click Abort in \
the window 'Local Kernel Interrupt' and check\>\""}],
                  FontColor->GrayLevel[0]], 
                 StyleBox[",",
                  FontColor->GrayLevel[0]], 
                 RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}], 
              StyleBox[";",
               FontColor->GrayLevel[0]], 
              StyleBox["\[IndentingNewLine]",
               FontColor->GrayLevel[0]], 
              StyleBox[
               RowBox[{"Interrupt", "[", "]"}],
               FontColor->GrayLevel[0]]}]}], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}], 
           StyleBox[";",
            FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"5", " ", 
             RowBox[{"a", ".", " ", "Timescale"}], " ", "analysis"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"analysisposs", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"filenamenos", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"analysisfilenamenos", "[", 
                  RowBox[{"[", "d", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dataset3", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"analysisposs", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                   RowBox[{"analysisunits", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "1", ",", "i"}], 
                  "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"d", "\[Equal]", "3"}], ",", "14.", ",", "0."}], 
                  "]"}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"d", "\[Equal]", "3"}], ",", 
                    RowBox[{"-", "1."}], ",", "1."}], "]"}], "*", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"analysisposs", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"analysisunits", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}]}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"analysisposs", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"analysisunits", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"del", "=", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                    ">", 
                   RowBox[{"nyearss", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"del", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dataset3", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"dataset3", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "del"}], 
                "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dataset3s", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "dataset3"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"baselines", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"baselines", "=", 
            RowBox[{"dataset3", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "1", ",", "2"}], "]"}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"baseliness", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "baselines"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"maximas", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "]"}], "\[Equal]", "Real"}], ",", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     ",", ",", "0"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"maximasout", "=", "maximas"}], ";", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"maximasout", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"d", "\[Equal]", "1"}], ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{"10", "^", "6"}]}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                  "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"maxs", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"maximas", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"peakyears", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", 
                   RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "1", ",", "1"}], "]"}], "]"}],
                    ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"maxs", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "1", ",", "1"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"maxs", "=", 
            RowBox[{"mins", "=", 
             RowBox[{"Table", "[", 
              RowBox[{",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"peakposs", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "+", "1"}], "<", 
                  RowBox[{"Length", "[", 
                   RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}], ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], ">=", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}], ",", "i", ",", "2"}], 
                    "]"}], "]"}]}]}], ",", 
                RowBox[{"i", "++"}]}], "]"}], ";", 
              RowBox[{
               RowBox[{"maxs", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", "i"}], ";", 
              RowBox[{"i", "--"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "++"}], ";", 
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "+", "1"}], "<", 
                    RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}], ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "<=", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}], ",", "i", ",", "2"}], 
                    "]"}], "]"}]}]}], ",", 
                   RowBox[{"i", "++"}]}], "]"}], ";"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"nblips", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "+", "1"}], "}"}]}], "]"}],
               ";", 
              RowBox[{
               RowBox[{"mins", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", "i"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           RowBox[{"peakyears", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxs", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "<", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "]"}]}], 
                ",", 
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", 
                   RowBox[{"k", "+", "control"}], ",", 
                   RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "1"}], "]"}], 
                 "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], ";", 
           RowBox[{"maximas", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxs", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "<", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "]"}]}], 
                ",", 
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", 
                   RowBox[{"k", "+", "control"}], ",", 
                   RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "2"}], "]"}], 
                 "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], ";", 
           RowBox[{"maximasout", "=", "maximas"}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"maximasout", "[", 
               RowBox[{"[", "d", "]"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"d", "\[Equal]", "1"}], ",", 
                RowBox[{"Round", "[", 
                 RowBox[{
                  RowBox[{"maximas", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"10", "^", "6"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"i", "+", "control"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"downcurve", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxs", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "<", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "]"}]}], 
                ",", 
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", 
                   RowBox[{"k", "+", "control"}], ",", "i"}], "]"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"maxs", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{"mins", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"downcurve", "[", 
               RowBox[{"[", 
                RowBox[{"d", ",", "k", ",", "All", ",", "2"}], "]"}], "]"}], 
              "=", 
              RowBox[{
               RowBox[{
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "All", ",", "2"}], "]"}], "]"}],
                 "*", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"10", "^", "6"}], ",", "1", ",", "1"}], "}"}], "[", 
                 RowBox[{"[", "d", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"baselines", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], ",", 
                  RowBox[{"baselines", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}]}], "}"}], 
                "[", 
                RowBox[{"[", "d", "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "+=", "1"}], ";", 
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                    "1"}]}], "&&", 
                    RowBox[{
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "downcurvecutoff"}], ")"}], "*", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}]}]}], ",", 
                   RowBox[{"i", "++"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"nblips", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "+", "1"}], "}"}]}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", 
                 RowBox[{"Length", "[", 
                  RowBox[{"downcurve", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"downcurve", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}]}], "]"}], ";"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ydata", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"downcurve", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                   ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                   "1"}]}], "}"}]}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"ydata", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], 
                ",", 
                RowBox[{
                 RowBox[{"downcurve", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
                 "-", 
                 RowBox[{
                  RowBox[{"Last", "[", 
                   RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"downcurve", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ydatas", "[", 
             RowBox[{"[", "e", "]"}], "]"}], "=", "ydata"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"logdata", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"downcurve", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], 
                ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ydata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "\[LessEqual]", "0"}], ",", "0.01", ",", 
                   RowBox[{"ydata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"downcurve", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"timescaledata", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                    "+", 
                   RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], 
                  ")"}], "/", "2"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
                    ")"}], "\[Equal]", "0"}], ",", 
                  RowBox[{"10", "^", "7"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], 
                    "]"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
                    ")"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"logdata", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"timescaledata", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "\[Equal]", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{
                RowBox[{"timescaledata", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"nyears", ",", "0"}], "}"}], "}"}]}]}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"maxyears", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "]"}], "\[Equal]", "Real"}], ",", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", ",", "0"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"avtimescales", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], 
                    "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", "1"}], 
                    ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"maxyears", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                    "2"}]}], "}"}]}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"SetDirectory", "[", 
            RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
             RowBox[{"partnames", "[", 
              RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
             "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CreateDirectory", "[", "\"\<analysis\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SetDirectory", "[", "\"\<analysis\>\"", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"5", " ", 
             RowBox[{"b", ".", " ", "Graphs"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"plotposs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "filenamenos", "]"}], ",", 
                  RowBox[{"plotfilenamenos", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "filenamenos", "]"}], ",", 
                    RowBox[{"plotfilenamenos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}], 
                    ">", "1"}], ",", "m", ",", "1"}], "]"}], ",", "1"}], 
                 "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "nmodules"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"plotfilenamenos", "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"plotdataset", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"plotposs", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                   RowBox[{"plotunits", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", "1", ",", "i"}], 
                  "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"p", "\[Equal]", "3"}], ",", "14.", ",", "0."}], 
                  "]"}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"p", "\[Equal]", "3"}], ",", 
                    RowBox[{"-", "1."}], ",", "1."}], "]"}], "*", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"plotposs", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                    RowBox[{"plotunits", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}]}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "nplotvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"plotposs", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                    RowBox[{"plotunits", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"del", "=", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                    ">", 
                   RowBox[{"nyearss", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"del", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"plotdataset", "[", 
                RowBox[{"[", 
                 RowBox[{"p", ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"plotdataset", "[", 
                  RowBox[{"[", 
                   RowBox[{"p", ",", "k"}], "]"}], "]"}], ",", "del"}], 
                "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p", ",", "nplotvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nosinuse", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ensemblenos", "[", 
                  RowBox[{"[", "tab1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"varstyles", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "tab1", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"nosinuse2", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"nos2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"nosinuse", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"nosinuse", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";", 
           RowBox[{"nosinuse3", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nosinuse2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", ">", "1"}], ",", 
                 RowBox[{
                  RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nosinuse4", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", 
               "legdisplaynos"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"newlegendplus", "=", 
            RowBox[{"newlegend", "[", 
             RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotdataset2", "=", "plotdataset"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"plotdataset2", "[", 
               RowBox[{"[", 
                RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
              "=", 
              RowBox[{
               RowBox[{
                RowBox[{"plotdataset", "[", 
                 RowBox[{"[", 
                  RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
                "*", 
                RowBox[{"unitschange", "[", 
                 RowBox[{"[", "p", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"baselines", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"baselines", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "k"}], "]"}], "]"}], ",", "0", ",", "0",
                   ",", "0"}], "}"}], "[", 
                RowBox[{"[", "p", "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "nplotvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "nruns"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"plotdataset", "[", 
                 RowBox[{"[", 
                  RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"plotrangesauto", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"plotdataset2", "[", 
                  RowBox[{"[", 
                   RowBox[{"p", ",", "All", ",", "All", ",", "2"}], "]"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"plotdataset2", "[", 
                  RowBox[{"[", 
                   RowBox[{"p", ",", "All", ",", "All", ",", "2"}], "]"}], 
                  "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "nplotvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotrangesuse", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"autoplotranges", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
              "plotrangesauto", ",", "plotranges"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphout", "=", 
               RowBox[{
               "ShowLegend", "[", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ListLogLinearPlot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<year\>\"", ",", 
                    RowBox[{
                    RowBox[{"plotvaluenames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
                    
                    RowBox[{"plotunitnames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "~~", "\"\<)\>\""}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotstartyears", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], ",", 
                    RowBox[{"nyearss", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yeartickslog", ",", "None"}], "}"}]}], "}"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", "graphics2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], 
                 ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
                   RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendBorder", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendPosition", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.94", "+", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0.03", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", 
                    "0."}], "}"}], "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"plotlabel", "=", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<`` for `` - `` - ``\>\"", ",", 
                 RowBox[{"plotvaluenames", "[", 
                  RowBox[{"[", "p", "]"}], "]"}], ",", "config", ",", "info", 
                 ",", 
                 RowBox[{"ensemoutnames", "[", 
                  RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"screenoutputgraph", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", "graphout", "]"}]}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"graphtitle", "=", 
                  RowBox[{"outtitleprefix", "~~", 
                   RowBox[{"plotvars", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "~~", "\"\<.\>\"", "~~", 
                   RowBox[{"saveformats", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"graphtitletex", "=", 
                  RowBox[{
                   RowBox[{"StringDrop", "[", 
                    RowBox[{"graphtitle", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"latex", "=", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                    RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                    "graphtitle", ",", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                    ",", "graphtitle"}], "]"}], ",", "StandardForm"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "graphtitletex", ",", "latex", ",", "\"\<Text\>\""}], "]"}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", 
                   "latex", ",", "\"\<Text\>\""}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"texinc", "[", 
                    RowBox[{"[", 
                    RowBox[{"e", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "\"\<\\input{\>\"", "~~", "graphtitletex", "~~", 
                    "\"\<}\\n\\n\>\""}]}], "]"}], "*)"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                   "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", "latex"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", 
                "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p", ",", "nplotvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphout", "=", 
               RowBox[{"Grid", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"plotvaluenames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "3"}], ",", "\"\<\\n\>\"", ",", 
                    "\"\<\>\""}], "]"}], "<>", "\"\< (\>\"", "<>", 
                    RowBox[{"plotunitnames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "~~", "\"\<)\>\""}], 
                    ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "}"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "50"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "12"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "16"}], ")"}]}]}], "}"}]}],
                     ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "0"}]}], "]"}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"20", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",",
                     "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Last", "[", "ranges", "]"}], "]"}], "/", "2"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "4"}], ",", "11", ",", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"0.715", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "500", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "60", ",", "0"}], 
                    "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", "graphics3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], "}"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                    ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"plotlabel", "=", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<`` for `` - `` - ``\>\"", ",", 
                 RowBox[{"plotvaluenames", "[", 
                  RowBox[{"[", "p", "]"}], "]"}], ",", "config", ",", "info", 
                 ",", 
                 RowBox[{"ensemoutnames", "[", 
                  RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"graphtitle", "=", 
                  RowBox[{"outtitleprefix", "~~", 
                   RowBox[{"plotvars", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "~~", "\"\<_broken.\>\"", 
                   "~~", 
                   RowBox[{"saveformats", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"graphtitletex", "=", 
                  RowBox[{
                   RowBox[{"StringDrop", "[", 
                    RowBox[{"graphtitle", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"latex", "=", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                    RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                    "graphtitle", ",", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                    ",", "graphtitle"}], "]"}], ",", "StandardForm"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "graphtitletex", ",", "latex", ",", "\"\<Text\>\""}], "]"}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", 
                   "latex", ",", "\"\<Text\>\""}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"texinc", "[", 
                    RowBox[{"[", 
                    RowBox[{"e", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "\"\<\\input{\>\"", "~~", "graphtitletex", "~~", 
                    "\"\<}\\n\\n\>\""}]}], "]"}], "*)"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                   "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", "latex"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", 
                "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p", ",", "nplotvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"runs", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "control"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"q", "*", "control"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q", "+", "1"}], ")"}], "*", "control"}]}], 
                    "}"}]}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"q", ",", 
                RowBox[{
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"runss", "[", 
             RowBox[{"[", "e", "]"}], "]"}], "=", "runs"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphout", "=", 
               RowBox[{"Grid", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "*", 
                    RowBox[{"unitschange", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "k"}], "]"}], "]"}], ",", "0", ",", "0",
                     ",", "0"}], "}"}], "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Code", " ", "for", " ", "3", " ", "emissions", " ", 
                    "scenarios", " ", "for", " ", "PhD", " ", 
                    RowBox[{"work", ":", " ", 
                    RowBox[{"runs", "[", 
                    RowBox[{"[", "q", "]"}], "]"}]}]}], "*)"}], 
                    RowBox[{"Range", "[", "nruns", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"plotvaluenames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "3"}], ",", "\"\<\\n\>\"", ",", 
                    "\"\<\>\""}], "]"}], "<>", "\"\< (\>\"", "<>", 
                    RowBox[{"plotunitnames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "~~", "\"\<)\>\""}], 
                    ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "}"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "10", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "]"}], ",", 
                    
                    RowBox[{"Length", "[", "newlegendplus", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}]}], "}"}], "}"}], "]"}], "]"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "30"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "12"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    "14"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "12", ",", 
                    "15"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"550000", ",", "1000"}], "}"}]}], "]"}], "}"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "300", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Equal]", "2"}], ",", "268", ",", "250"}], 
                    "]"}]}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "60", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Equal]", "2"}], ",", "20", ",", "3.5"}], 
                    "]"}], ",", "6"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"plotranges2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "q"}], "]"}], "]"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], "&&", 
                    RowBox[{"p", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"graphics3", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Code", " ", "for", " ", "3", " ", "emissions", " ", 
                    "scenarios", " ", "for", " ", "PhD", " ", 
                    RowBox[{"work", ":", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"nruns", "/", "3"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"nruns", "/", "3"}]}], "+", "1"}], ",", "nruns"}],
                     "}"}]}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"nruns", "/", "3"}]}]}], "}"}]}], "]"}]}], "}"}], 
                    "[", 
                    RowBox[{"[", "q", "]"}], "]"}]}]}], "*)"}], "nruns"}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "Code", " ", "for", " ", "3", " ", "emissions", " ", 
                    "scenarios", " ", "for", " ", "PhD", " ", 
                    RowBox[{"work", ":", " ", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}]}]}], 
                    ","}], "*)"}], 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                    ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"plotlabel", "=", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<`` for `` - `` - ``\>\"", ",", 
                 RowBox[{"plotvaluenames", "[", 
                  RowBox[{"[", "p", "]"}], "]"}], ",", "config", ",", "info", 
                 ",", 
                 RowBox[{"ensemoutnames", "[", 
                  RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"graphtitle", "=", 
                  RowBox[{"outtitleprefix", "~~", 
                   RowBox[{"plotvars", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "~~", "\"\<_broken2.\>\"",
                    "~~", 
                   RowBox[{"saveformats", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"graphtitletex", "=", 
                  RowBox[{
                   RowBox[{"StringDrop", "[", 
                    RowBox[{"graphtitle", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"latex", "=", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                    RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                    "graphtitle", ",", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                    ",", "graphtitle"}], "]"}], ",", "StandardForm"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "graphtitletex", ",", "latex", ",", "\"\<Text\>\""}], "]"}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", 
                   "latex", ",", "\"\<Text\>\""}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"texinc", "[", 
                    RowBox[{"[", 
                    RowBox[{"e", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "\"\<\\input{\>\"", "~~", "graphtitletex", "~~", 
                    "\"\<}\\n\\n\>\""}]}], "]"}], "*)"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                   "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", "latex"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "p", "]"}], "]"}], ",", 
                "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p", ",", "nplotvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotrangesuse", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"autoplotranges", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
              "plotrangesauto", ",", "plotranges"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tabspacing", "=", "0.1"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"graphout", "=", 
            RowBox[{"Grid", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"plotdataset2", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"plotdataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"plotvaluenames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "\[Equal]", "3"}], ",", "\"\<\\n\>\"", ",", 
                    "\"\<\>\""}], "]"}], "<>", "\"\< (\>\"", "<>", 
                    RowBox[{"plotunitnames", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "~~", "\"\<)\>\""}], 
                    ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "}"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"alpha", ",", 
                    RowBox[{"{", "p", "}"}]}], "]"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "30"}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"0.05", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"0.08", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], "&&", 
                    RowBox[{"p", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "10", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "]"}], ",", 
                    
                    RowBox[{"Length", "[", "newlegendplus", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}]}], "}"}], "}"}], "]"}], "]"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "30"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "12"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    "14"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "12", ",", 
                    "15"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"0.5", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"0.45", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "}"}]}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "300", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "==", "nplotvars"}], ",", "268", ",", 
                    "250"}], "]"}]}], "]"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "60", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "==", "nplotvars"}], ",", "20", ",", "4.5"}],
                     "]"}], ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"plotrangesuse", "[", 
                    RowBox[{"[", "p", "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], "&&", 
                    RowBox[{"p", "\[Equal]", "1"}]}], ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], "]"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", "graphics3"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], "}"}]}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "nplotvars"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"StyleForm", "[", 
                   RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                 ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plotdatasets", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "plotdataset"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newlegendpluss", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "newlegendplus"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"graphics3s", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "graphics3"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotlabel", "=", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Timeseries of key variables for `` ensemble\>\"", ",", 
              RowBox[{"ensemoutnames", "[", 
               RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"screenoutputgraph", "\[Equal]", "1"}], ",", 
             RowBox[{"Print", "[", "graphout", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphtitle", "=", 
               RowBox[{"outtitleprefix", "~~", "\"\<multi.\>\"", "~~", 
                RowBox[{"saveformats", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"graphtitletex", "=", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"graphtitle", ",", 
                  RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"latex", "=", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"latexscale", "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "1"}], ",", "0.03", ",", 
                    "0.07"}], "]"}]}], "]"}], ",", "graphtitle", ",", 
                   RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                   ",", "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitletex", ",", "latex", ",", "\"\<Text\>\""}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", "latex", 
                ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texinc", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"latex", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"plotlabel", "=", 
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<e-folding timescale of `` for `` - `` - ``\>\"", ",", 
                 RowBox[{"analysisvarslong", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], ",", "config", ",", "info", 
                 ",", 
                 RowBox[{"ensemoutnames", "[", 
                  RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"graphout", "=", 
               RowBox[{
               "ShowLegend", "[", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<year\>\"", ",", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<e-folding timescale = \[CapitalDelta]t/\
\[CapitalDelta]ln(\!\(\*SubscriptBox[\(``\), \(final\)]\)-``) (years)\>\"", 
                    ",", 
                    RowBox[{"deltas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"deltas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ",", "None", ",",
                     "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", 
                    ",", "plotlabel"}], "]"}]}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"plotstartyears", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], ",", 
                    RowBox[{"nyearss", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"500", ",", "500000"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yeartickslog", ",", "None"}], "}"}]}], "}"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"graphics2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLinesStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
                   RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendBorder", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendPosition", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.9", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"LegendSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"graphtitle", "=", 
                  RowBox[{"outtitleprefix", "~~", 
                   RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "~~", 
                   "\"\<_e-folding.\>\"", "~~", 
                   RowBox[{"saveformats", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"graphtitletex", "=", 
                  RowBox[{
                   RowBox[{"StringDrop", "[", 
                    RowBox[{"graphtitle", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"latex", "=", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                    RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                    "graphtitle", ",", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                    ",", "graphtitle"}], "]"}], ",", "StandardForm"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"graphtitletex", ",", 
                   RowBox[{"latex", "~~", "\"\<\\n\\\\clearpage\\n\\n\>\""}], 
                   ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", 
                   "latex", ",", "\"\<Text\>\""}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"texinc", "[", 
                    RowBox[{"[", 
                    RowBox[{"e", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "\"\<\\input{\>\"", "~~", "graphtitletex", "~~", 
                    "\"\<}\\n\\n\\n\\n\\\\clearpage\\n\\n\>\""}]}], "]"}], 
                  "*)"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                   "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], 
               "]"}], ";"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"humps", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Mean", "@", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"timescaledata", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "*", ".7"}],
                     "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "*", ".9"}],
                     "]"}]}], "}"}]}], "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxefoldranges", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"autoplotranges", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Max", "@", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MovingAverage", "[", 
                    RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], ",", 
                    "efoldmovavg"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", 
                    RowBox[{"3", "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"humps", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<", "0"}], ",", 
                    RowBox[{"yefoldmax", "/", "2"}], ",", 
                    RowBox[{"humps", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "]"}]}]}], "&"}], 
                    ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                "yefoldmax"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxefoldranges", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"maxefoldranges", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{"Round", "[", "maxefoldranges", "]"}], "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}], "-", "1"}], 
                  ")"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"graphout", "=", 
            RowBox[{"Grid", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"ListLogPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"MovingAverage", "[", 
                    RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], ",", 
                    "efoldmovavg"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<e-folding timescale = \\n\[CapitalDelta]t/\
\[CapitalDelta]ln(\!\(\*SubscriptBox[\(``\), \(final\)]\)-``) (years)\>\"", 
                    ",", 
                    RowBox[{"deltas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"deltas", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "}"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"alpha", ",", 
                    RowBox[{"{", "d", "}"}]}], "]"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "30"}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"0.05", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"500", "+", 
                    RowBox[{"0.6", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxefoldranges", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "-", "500"}], ")"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], "&&", 
                    RowBox[{"d", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "10", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "]"}], ",", 
                    
                    RowBox[{"Length", "[", "newlegendplus", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}]}], "}"}], "}"}], "]"}], "]"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "30"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "12"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    "14"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "12", ",", 
                    "15"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2450", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"500", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxefoldranges", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "-", "500"}], ")"}], "/", 
                    "15"}]}], "]"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"500", ",", 
                    RowBox[{
                    RowBox[{"Round", "[", "maxefoldranges", "]"}], "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "335", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "==", "ndroptabvars"}], ",", "268", ",", 
                    "250"}], "]"}]}], "]"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "95", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "==", "ndroptabvars"}], ",", "20", ",", 
                    "3.8"}], "]"}], ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], "&&", 
                    RowBox[{"d", "\[Equal]", "1"}]}], ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], "]"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"graphics3", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], "}"}]}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"StyleForm", "[", 
                   RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                 ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"screenoutputgraph", "\[Equal]", "1"}], ",", 
             RowBox[{"Print", "[", "graphout", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotlabel", "=", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<\\\\textit{e}-folding timescales of key variables for `` \
ensemble\>\"", ",", 
              RowBox[{"ensemoutnames", "[", 
               RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphtitle", "=", 
               RowBox[{"outtitleprefix", "~~", "\"\<multi_e-folding.\>\"", "~~", 
                RowBox[{"saveformats", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"graphtitletex", "=", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"graphtitle", ",", 
                  RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"latex", "=", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                   RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                   "graphtitle", ",", 
                   RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                   ",", "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitletex", ",", 
                RowBox[{"latex", "~~", "\"\<\\n\\\\clearpage\\n\\n\>\""}], 
                ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", "latex", 
                ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texinc", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"ndroptabvars", "*", 
                    RowBox[{"(", 
                    RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "3"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"latex", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"5", " ", 
             RowBox[{"c", ".", " ", "Tabular"}], " ", "analysis"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"ensemtitlesshort", "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"ensemtitles", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], 
               "]"}], ",", "vartitlesshort"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"droptable", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"Null", ",", 
              RowBox[{"{", "ndroptabvars", "}"}], ",", 
              RowBox[{"{", "ndrop", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"nruns", "-", "control"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ndrops", "=", 
            RowBox[{"{", 
             RowBox[{
             "ndropyears", ",", "ndropyears", ",", "ndropvalues", ",", 
              "ndropfracs"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"droptable", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x", ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"Table", "[", 
                RowBox[{"\"\<-\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"ndrops", "[", 
                   RowBox[{"[", "x", "]"}], "]"}], "}"}]}], "]"}]}], ";"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "ndrop"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Quiet", "[", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", "=", 
                RowBox[{"maxs", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", 
                   RowBox[{"k", "-", "control"}]}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"While", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "<=", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "&&", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "<", 
                    RowBox[{"dropyears", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "<", 
                    RowBox[{"dropyears", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     ">", 
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "+", 
                    RowBox[{"dropvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "f"}], "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ">", 
                    RowBox[{
                    RowBox[{"dropfracs", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "-", "control"}]}], "]"}], "]"}], ",", "2"}],
                     "]"}], "]"}], "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}]}]}]}], 
                    "}"}], "[", 
                   RowBox[{"[", "x", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"i", "++"}], ";"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "<=", 
                  RowBox[{"Length", "[", 
                   RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"droptable", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "x", ",", 
                    RowBox[{"k", "-", "control"}], ",", "f"}], "]"}], "]"}], 
                  "=", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"10", "^", "6"}], "*", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "<", "0.00001"}],
                     ",", "0.0", ",", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"100", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", 
                    RowBox[{"k", "-", "control"}]}], "]"}], "]"}], ",", "2"}],
                     "]"}], "]"}], "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "-", "control"}]}], "]"}], "]"}], ",", "2"}],
                     "]"}], "]"}], ">", 
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "+", 
                    RowBox[{"dropvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "f"}], "]"}], "]"}]}]}], ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "/", "10"}], "]"}], "*", "10"}], "]"}], ",", 
                    "\"\<-\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "/", "10"}], "]"}], "*", "10"}], "]"}]}], "}"}], "[", 
                   RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "ndrop"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"f", ",", 
                RowBox[{"ndrops", "[", 
                 RowBox[{"[", "x", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PrependTo", "[", 
               RowBox[{
                RowBox[{"droptable", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "3", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{"peakyears", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "/", "10"}], "]"}],
                  "*", "10"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"PrependTo", "[", 
               RowBox[{
                RowBox[{"droptable", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "3", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{"maximasout", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dropvalheads", "=", 
               RowBox[{"Prepend", "[", 
                RowBox[{
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dropvalues", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{"10", "^", "6"}]}], "+", "278"}], "]"}], ",", 
                    RowBox[{"dropvalues", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ",", 
                   "\"\<at year\>\""}], "]"}], ",", "\"\<peak\>\""}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"PrependTo", "[", 
               RowBox[{
                RowBox[{"droptable", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "dropyearnames", ",", "dropyearnames", ",", "dropvalheads", 
                   ",", "dropfracnames"}], "}"}], "[", 
                 RowBox[{"[", "x", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "ndrop"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"droptable2", "=", "droptable"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"PrependTo", "[", 
              RowBox[{
               RowBox[{"droptable", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x", ",", "k"}], "]"}], "]"}], ",", 
               RowBox[{"ensemtitlesshort", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", 
                  RowBox[{"nvar", "+", "1", "-", "j"}]}], "]"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "ndrop"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nruns", "-", "control", "+", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nvar"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"droptables", "[", 
             RowBox[{"[", "e", "]"}], "]"}], "=", "droptable"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"dropnames", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<.xls\>\""}], ",", 
                RowBox[{"droptable", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "x"}], "]"}], "]"}]}], "]"}], ";"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "3"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"\"\<alltabs_\>\"", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<.xls\>\""}], ",", 
                RowBox[{"droptable", "[", 
                 RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nvar", ">", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"control2", "=", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", "nvar"}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"singlelines", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"i", "*", "control2"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "0", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ")"}], "*", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"singlelines", "=", 
               RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"doublelines", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{"i", "*", "control"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "2"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lines", "=", 
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"singlelines", ",", "doublelines"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"texdroptablebase", "=", 
            RowBox[{"texdroptable", "=", 
             RowBox[{"texdroptableapp", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"Null", ",", 
                RowBox[{"{", "ndroptabvars", "}"}], ",", 
                RowBox[{"{", "ndrop", "}"}]}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"texdroptablebase", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"TeXForm", "[", 
                    RowBox[{"droptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], "]"}], "]"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"8", ",", 
                    RowBox[{"-", "9"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"\"\<array\>\"", "\[Rule]", "\"\<tabular\>\""}]}], 
                "]"}]}], ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"newlines", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                    "\"\<\\n\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                    "\"\<\\n\>\""}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"texdroptablebase", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                    "\"\<\\\\hline\\n\>\"", ",", 
                    RowBox[{"newlines", "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "-", "1", "+", 
                    RowBox[{"lines", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}]}], 
                   "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", 
                  RowBox[{"Length", "[", "lines", "]"}]}], "}"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"columnpos", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{
                   RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                   RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<c\>\"", ",", 
                    RowBox[{"{", "nvar", "}"}]}], "]"}], "]"}]}], "]"}], "[", 
                 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tabtop", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{
                   RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<c\>\"", ",", 
                    RowBox[{"{", "nvar", "}"}]}], "]"}], "]"}], "<>", 
                    "\"\<}\>\""}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "3"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptablebase", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "=", 
               RowBox[{"StringInsert", "[", 
                RowBox[{
                 RowBox[{"texdroptablebase", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                 "\"\<|\>\"", ",", "columnpos"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptablebase", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "=", 
               RowBox[{"StringInsert", "[", 
                RowBox[{
                 RowBox[{"texdroptablebase", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                 RowBox[{"\"\<\\hline\\n\\multicolumn{\>\"", "~~", 
                  RowBox[{"ToString", "[", "nvar", "]"}], "~~", 
                  "\"\<}{c|}{\\\\textbf{variables}}&\\multicolumn{\>\"", "~~", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"ndrops", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "]"}], "~~", 
                  "\"\<}{c}{\\\\textbf{\>\"", "~~", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"x", "\[Equal]", "3"}], ",", 
                    RowBox[{
                    RowBox[{"analysisvarslong", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\< (\>\"", "~~", 
                    
                    RowBox[{"analysisunitnames", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<)\>\""}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"x", "\[Equal]", "4"}], ",", "\"\<fraction\>\"", 
                    ",", "\"\<year\>\""}], "]"}]}], "]"}], "~~", 
                  "\"\<}} \\\\\\\\\\n\\hline\\n\>\""}], ",", "tabtop"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", "4"}], ",", 
                RowBox[{
                 RowBox[{"texdroptablebase", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "=", 
                 RowBox[{"StringInsert", "[", 
                  RowBox[{
                   RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                   "\"\<|\>\"", ",", 
                   RowBox[{"columnpos", "+", "6"}]}], "]"}]}]}], "]"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", "3"}], ",", 
                RowBox[{
                 RowBox[{"texdroptablebase", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "=", 
                 RowBox[{"StringInsert", "[", 
                  RowBox[{
                   RowBox[{"texdroptablebase", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], ",", 
                   "\"\<|\>\"", ",", 
                   RowBox[{"columnpos", "+", "3"}]}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"captionlength", "=", 
               RowBox[{"StringLength", "[", 
                RowBox[{
                 RowBox[{"analysiscaptions1", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "~~", 
                 RowBox[{"analysisvarslong", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", 
                 RowBox[{"analysiscaptions2", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "x"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"caption", "=", 
               RowBox[{
                RowBox[{"analysiscaptions1", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], "~~", "\"\<\\\\textbf{\>\"", 
                "~~", 
                RowBox[{"analysisvarslong", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<}\>\"", "~~", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"captionlength", ">", "maxcaptionlength"}], ",", 
                  "\"\<\\\\\\\\\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                RowBox[{"analysiscaptions2", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "x"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptable", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
               RowBox[{
               "\"\<\\\\begin{table}[htbp]\\n\\caption{\>\"", "~~", "caption",
                 "~~", "\"\<}\\n\>\"", "~~", 
                RowBox[{"texdroptablebase", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "~~", 
                "\"\<\\n\\label{tab:\>\"", "~~", 
                RowBox[{"tabletypesshort", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"analysisvars", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                "ensemshort", "~~", "\"\<}\\n\\\\end{table}\\n\\n\>\""}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"texdroptable", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
                 RowBox[{"StringReplace", "[", 
                  RowBox[{
                   RowBox[{"texdroptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e${}^{\\wedge}$-``\>\"", ",", "i"}], "]"}], 
                    "]"}], "\[Rule]", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e$^{-``}$\>\"", ",", "i"}], "]"}], "]"}]}]}],
                   "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptable", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"texdroptable", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<pCO2\>\"", "->", "\"\<pCO$_2$\>\""}], ",", 
                   RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}], 
                   ",", 
                   RowBox[{"\"\<_CO$_2$\>\"", "->", "\"\<_CO2\>\""}], ",", 
                   RowBox[{"\"\<oC\>\"", "->", "\"\<$^{\\circ}$C\>\""}]}], 
                  "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptableapp", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
               RowBox[{"\"\<\\\\begin{table}[htbp]\>\"", "<>", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"e", "==", "1"}], ",", 
                  RowBox[{
                  "\"\<\\n\\caption{\>\"", "<>", "caption", "<>", 
                   "\"\<}\>\""}], ",", "\"\<\>\""}], "]"}], "<>", 
                "\"\<\\n\>\"", "<>", 
                RowBox[{"texdroptablebase", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", " ", "x"}], "]"}], "]"}], "<>", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"e", "==", "1"}], ",", 
                  RowBox[{"\"\<\\n\\label{tab:\>\"", "<>", 
                   RowBox[{"tabletypesshort", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
                   RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", "\"\<}\>\""}], ",", 
                  "\"\<\>\""}], "]"}], "<>", 
                "\"\<\\n\\\\end{table}\\n\\n\>\""}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"texdroptableapp", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
                 RowBox[{"StringReplace", "[", 
                  RowBox[{
                   RowBox[{"texdroptableapp", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e${}^{\\wedge}$-``\>\"", ",", "i"}], "]"}], 
                    "]"}], "\[Rule]", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e$^{-``}$\>\"", ",", "i"}], "]"}], "]"}]}]}],
                   "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"texdroptableapp", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "x"}], "]"}], "]"}], "=", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"texdroptableapp", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "x"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<pCO2\>\"", "->", "\"\<pCO$_2$\>\""}], ",", 
                   RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}], 
                   ",", 
                   RowBox[{"\"\<_CO$_2$\>\"", "->", "\"\<_CO2\>\""}], ",", 
                   RowBox[{"\"\<oC\>\"", "->", "\"\<$^{\\circ}$C\>\""}]}], 
                  "}"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "ndrop"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"texdroptableout", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"StringJoin", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"texdroptable", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"texdroptableout", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", 
                 "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"outtitleprefix", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<_tab.tex\>\""}], 
                ",", 
                RowBox[{"texdroptableout", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "outtitleprefix", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<_tab.tex\>\""}], 
                ",", 
                RowBox[{"texdroptableout", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"texinc", "[", 
                   RowBox[{"[", 
                    RowBox[{"e", ",", "3"}], "]"}], "]"}], ",", 
                  RowBox[{"\"\<\\input{\>\"", "~~", "outtitleprefix", "~~", 
                   RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "~~", "\"\<_tab.tex\>\"", 
                   "~~", "\"\<}\\n\\n\\\\clearpage\\n\\n\>\""}]}], "]"}], 
                ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"outtitleprefix", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", 
                 "\"\<_fig_tab.tex\>\""}], ",", 
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "outtitleprefix", "~~", 
                 RowBox[{"analysisvars", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "~~", 
                 "\"\<_fig_tab.tex\>\""}], ",", 
                RowBox[{"texensem", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], "]"}],
               ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"5", " ", 
             RowBox[{"d", ".", " ", "Timescale"}], " ", "analysis", " ", 
             "fitting"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"timescalefitting", "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\<Time-scale curve fitting...\>\"", "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"rsquareds", "=", 
               RowBox[{"aics", "=", 
                RowBox[{"bics", "=", 
                 RowBox[{"paramconfss", "=", 
                  RowBox[{"paramconftabs", "=", 
                   RowBox[{"resouts", "=", 
                    RowBox[{"timescaless", "=", 
                    RowBox[{"weightingss", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"Null", ",", 
                    RowBox[{"{", "ndroptabvars", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nruns", "-", "control"}], "}"}]}], 
                    "]"}]}]}]}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bases", "=", 
               RowBox[{"peaks", "=", 
                RowBox[{"fittingselections", "=", 
                 RowBox[{"autofits", "=", 
                  RowBox[{"plots", "=", 
                   RowBox[{"results", "=", 
                    RowBox[{"restables", "=", 
                    RowBox[{"fittabs", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"Null", ",", 
                    RowBox[{"{", "ndroptabvars", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nruns", "-", "control"}], "}"}]}], 
                    "]"}]}]}]}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"rsquaredsall", "=", 
               RowBox[{"aicsall", "=", 
                RowBox[{"bicsall", "=", 
                 RowBox[{"paramconfssall", "=", 
                  RowBox[{"paramconftabsall", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "ndroptabvars", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nruns", "-", "control"}], "}"}]}], 
                    "]"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"timescalessall", "=", 
               RowBox[{"weightingssall", "=", 
                RowBox[{"basesall", "=", 
                 RowBox[{"peaksall", "=", 
                  RowBox[{"autofitsall", "=", 
                   RowBox[{"fittabsall", "=", 
                    RowBox[{"acceptablefitsall", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "ndroptabvars", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nruns", "-", "control"}], "}"}]}], 
                    "]"}]}]}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"titles1", "=", 
               RowBox[{"Tuples", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"vartitles", "[", 
                    RowBox[{"[", "v", "]"}], "]"}], "<>", "\"\<: \>\"", "<>", 
                   
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"v", ",", "w"}], "]"}], "]"}], "<>", 
                   "\"\<; \>\""}], ",", 
                  RowBox[{"{", 
                   RowBox[{"v", ",", "nvar"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"w", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"v", "\[Equal]", "1"}], ",", "2", ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "v", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
               ";", 
              RowBox[{"titles2", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"StringJoin", "[", 
                  RowBox[{"titles1", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"commentary", "==", "1"}], ",", 
                   RowBox[{"Print", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"analysisvarslong", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "Bold", ",", "Red", 
                    ",", "12"}], "]"}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"commentary", "==", "1"}], ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"titles2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "Bold", ",", "Green",
                     ",", "12"}], "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"start", "=", 
                    RowBox[{"peakyears", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ";", 
                    RowBox[{"fin", "=", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"start", ",", "fin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "0.0"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "1"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "0", ",", "1"}], 
                    "]"}]}]}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nexpfits", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"bic", "=", 
                    RowBox[{"bignumber", "-", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldbic", "=", "bignumber"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"timescales", "=", 
                    RowBox[{"weightings", "=", 
                    RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"rsquared", "=", 
                    RowBox[{"aic", "=", 
                    RowBox[{"paramconf", "=", 
                    RowBox[{"baseline", "=", 
                    RowBox[{"peak", "=", "0"}]}]}]}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"biccutoff", "\[Equal]", "1"}], ",", 
                    RowBox[{"bic", "<", "oldbic"}], ",", 
                    RowBox[{"nexpfits", "<", "maxnexpfits"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nexpfits", "+=", "1"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"commentary", "==", "1"}], ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<number of exponentials fitted = \>\"", "<>", 
                    RowBox[{"ToString", "[", "nexpfits", "]"}]}], ",", "Bold",
                     ",", "Blue", ",", "12"}], "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Format", "[", 
                    RowBox[{"w", "[", "n_Integer", "]"}], "]"}], ":=", 
                    RowBox[{"\"\<w\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
                    RowBox[{"weights", "=", 
                    RowBox[{"Array", "[", 
                    RowBox[{"w", ",", "nexpfits"}], "]"}]}], ";", 
                    RowBox[{"weights", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Symbol", "[", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"weights", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "nexpfits"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Format", "[", 
                    RowBox[{"t", "[", "n_Integer", "]"}], "]"}], ":=", 
                    RowBox[{"\"\<t\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
                    RowBox[{"taus", "=", 
                    RowBox[{"Array", "[", 
                    RowBox[{"t", ",", "nexpfits"}], "]"}]}], ";", 
                    RowBox[{"taus", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Symbol", "[", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"taus", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "nexpfits"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"autofit", "=", 
                    RowBox[{"NonlinearModelFit", "[", 
                    RowBox[{
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"b", "+", 
                    RowBox[{"height", "*", 
                    RowBox[{"(", 
                    RowBox[{"Plus", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"weights", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "*", 
                    RowBox[{"fitbase", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "start"}], ")"}]}], "/", 
                    RowBox[{"taus", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "nexpfits"}], "}"}]}], "]"}]}], "]"}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "height", ",", 
                    RowBox[{"Sequence", "@@", "weights"}], ",", 
                    RowBox[{"Sequence", "@@", "taus"}]}], "}"}], ",", "t", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"ConfidenceLevel", "\[Rule]", "confidence"}], ",", 
                    RowBox[{"MaxIterations", "\[Rule]", "maxiterations"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"PrecisionGoal", "\[Rule]", "6"}], ",", 
                    RowBox[{"AccuracyGoal", "\[Rule]", "6"}]}], "*)"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldrsquared", "=", "rsquared"}], ";", 
                    RowBox[{"rsquared", "=", 
                    RowBox[{"autofit", "[", "\"\<RSquared\>\"", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldaic", "=", "aic"}], ";", 
                    RowBox[{"aic", "=", 
                    RowBox[{"autofit", "[", "\"\<AIC\>\"", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldbic", "=", "bic"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"autofit", "[", "\"\<BIC\>\"", "]"}], "\[Equal]", 
                    
                    RowBox[{"Missing", "[", "]"}]}], ",", 
                    RowBox[{"bic", "=", "bignumber"}], ",", ",", 
                    RowBox[{"bic", "=", 
                    RowBox[{"autofit", "[", "\"\<BIC\>\"", "]"}]}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"oldparamconfs", "=", "paramconfs"}], ";", 
                    RowBox[{"paramconfs", "=", 
                    RowBox[{
                    "autofit", "[", "\"\<ParameterConfidenceIntervals\>\"", 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"paramcontab", "=", 
                    RowBox[{
                    "autofit", "[", 
                    "\"\<ParameterConfidenceIntervalTable\>\"", "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"oldtimescales", "=", "timescales"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Depth", "[", 
                    RowBox[{"autofit", "[", "t", "]"}], "]"}], "<", "9"}], 
                    ",", 
                    RowBox[{"timescales", "=", 
                    RowBox[{"{", 
                    RowBox[{"1", "/", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], 
                    "]"}]}], "}"}]}], ",", 
                    RowBox[{"timescales", "=", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "2", ",", "2", ",", "i", ",", "2", ",", "2", ",", "1"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"oldweightings", "=", "weightings"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Depth", "[", 
                    RowBox[{"autofit", "[", "t", "]"}], "]"}], "<", "9"}], 
                    ",", 
                    RowBox[{"weightings", "=", 
                    RowBox[{"{", "1", "}"}]}], ",", 
                    RowBox[{"weightings", "=", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "/", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldbase", "=", "base"}], ";", 
                    RowBox[{"base", "=", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"oldpeak", "=", "peak"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Depth", "[", 
                    RowBox[{"autofit", "[", "t", "]"}], "]"}], "<", "9"}], 
                    ",", 
                    RowBox[{"peak", "=", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"peak", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
                    "base"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"autofitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "autofit"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"rsquaredsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "rsquared"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"aicsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "aic"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"bicsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "bic"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"paramconfssall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    "paramconfs"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"paramconftabsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    "paramcontab"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"timescalessall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    "timescales"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"weightingssall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    "weightings"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"basesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "base"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"peaksall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "peak"}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"commentary", ">", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"autofit", "[", "t", "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"autofit", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<old BIC: \>\"", ",", "oldbic"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"autofit", "[", "#", "]"}]}], "}"}], "&"}], "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<AdjustedRSquared\>\"", ",", "\"\<AIC\>\"", ",", 
                    "\"\<BIC\>\"", ",", "\"\<RSquared\>\"", ",", 
                    "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<timescales: \>\"", ",", "timescales"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<weightings: \>\"", ",", "weightings"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<total of weightings : \>\"", ",", 
                    RowBox[{"Total", "[", "weightings", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<base: \>\"", ",", "base"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<peak: \>\"", ",", "peak"}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"graphoutput", "\[Equal]", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bands95", "[", "x_", "]"}], "}"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"autofit", "[", 
                    RowBox[{"\"\<MeanPredictionBands\>\"", ",", 
                    RowBox[{"ConfidenceLevel", "\[Rule]", "cl"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"cl", ",", 
                    RowBox[{"{", "0.95", "}"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"LogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"autofit", "[", "t", "]"}], ",", 
                    RowBox[{"bands95", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "start", ",", "fin"}], "}"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "PlotLabel", "\[Rule]", 
                    "\"\<model in red, fit in blue\>\""}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"start", ",", "fin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "0.0"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "1"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "0", ",", "1"}], 
                    "]"}]}]}]}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
                     "]"}]}]}], "]"}]}]}], "]"}], ";"}], 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"biccutoff", "\[Equal]", "1"}], ",", 
                    "\"\<BIC increased; aborting\\n\>\"", ",", 
                    "\"\<max no of exponential reached; stopping\>\""}], 
                    "]"}], ",", "Bold", ",", "Magenta", ",", "15"}], "]"}], 
                    "]"}], "*)"}], ",", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"confintervaltabfull", "=", 
                  RowBox[{
                   RowBox[{"autofitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], "[", 
                   "\"\<ParameterConfidenceIntervalTable\>\"", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"paramnames", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"confintervaltabfull", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"confintervaltabfull", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"confintervaletab", "=", 
                  RowBox[{
                   RowBox[{"autofitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], "[", 
                   "\"\<ParameterConfidenceIntervalTableEntries\>\"", "]"}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"fittab", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"paramnames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"confintervaletab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"confintervaletab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"confintervaletab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3", ",", "1"}], "]"}], "]"}]}], ")"}], 
                    "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "confintervaletab", "]"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"fittabsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "fittab"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"acceptablefit", "=", 
                  RowBox[{
                   RowBox[{"And", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"threshold", ">", 
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[GreaterEqual]", 
                    "0.000000001"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], "&&", 
                   RowBox[{"And", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"threshold", ">", 
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[GreaterEqual]", 
                    "0.000000001"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], "&&", "\[IndentingNewLine]", 
                   RowBox[{"And", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "/", 
                    "paramrelerrorthreshold"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"acceptablefitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                   "acceptablefit"}], "]"}], ";"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"autofitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"bicsallacceptable", "=", "bicsall"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"acceptablefitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], 
                   "\[Equal]", "True"}], ",", 
                  RowBox[{
                   RowBox[{"bicsallacceptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], "=", 
                   RowBox[{"bicsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"bicsallacceptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "j"}], "]"}], "]"}], "=", 
                   "bignumber"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "nexpfits"}], "}"}]}], "]"}], ";", 
              RowBox[{"minbics", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"bicsallacceptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"bicsallacceptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}]}], ";", 
              RowBox[{"fittingselections2", "=", "minbics"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bicsallacceptable", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}], 
                   "\[Equal]", "bignumber"}], ",", 
                  RowBox[{
                   RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", "0"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   
                   RowBox[{
                    RowBox[{
                    RowBox[{"autofits", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"autofitsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"graphoutput", "\[Equal]", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bands95", "[", "x_", "]"}], "=", 
                    RowBox[{
                    RowBox[{"autofits", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "[", 
                    RowBox[{"\"\<MeanPredictionBands\>\"", ",", 
                    RowBox[{"ConfidenceLevel", "\[Rule]", "0.95"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"plots", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"LogLinearPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"autofits", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "[", "t", "]"}], 
                    ",", 
                    RowBox[{"bands95", "[", "t", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"peakyears", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "PlotLabel", "\[Rule]", 
                    "\"\<model in red, fit in blue\\nwith .95 confidence \
interval shown\>\""}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"peakyears", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "0.0"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maximas", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", "6"}]}], ",", "1"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "+", "control"}]}], "]"}], "]"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "0", ",", "1"}], 
                    "]"}]}]}]}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}]}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"rsquareds", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"rsquaredsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"aics", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"aicsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bics", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"bicsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"paramconfss", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"paramconfssall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"paramconftabs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"paramconftabsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"timescaless", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"timescalessall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"weightingss", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"weightingssall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bases", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"basesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"peaks", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"peaksall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"fittabs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                    RowBox[{"fittabsall", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"fittab", "=", 
                    RowBox[{"fittabs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"paramnames", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"weighttot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "/=", 
                    RowBox[{"(", 
                    RowBox[{"weighttot", "/", "100.0"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "j"}], "]"}], "]"}], "*=", 
                    RowBox[{"(", "weighttot", ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"decimalstokeep", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RealDigits", "[", 
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ")"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"errors", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"values", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"fittab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", 
                    RowBox[{"decimalstokeep", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"decimalstokeep", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", "0", ",", 
                    RowBox[{"decimalstokeep", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"fittab2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"paramnames", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"values", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"errors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "fittab", "]"}]}], "}"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"ts", "=", 
                    RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"3", "+", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Length", "[", "fittab2", "]"}]}], "}"}]}], "]"}],
                     ",", "First"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"ordering", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"ws", "=", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", 
                    RowBox[{"2", "+", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     "[", 
                    RowBox[{"[", "ordering", "]"}], "]"}]}], ";", 
                    RowBox[{"restable", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<timescale \>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<: \>\""}],
                     ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"ws", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    "\"\< +/- \>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"ws", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
                    "\"\< at \>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    "\"\< +/- \>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], ",", 
                    "\"\<yr\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"PrependTo", "[", 
                    RowBox[{"restable", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<height: \>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", "\"\< +/- \>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"PrependTo", "[", 
                    RowBox[{"restable", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<base: \>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
                    ",", "\"\< +/- \>\"", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"restables", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", "restable"}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"ts2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"AccountingForm", "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ts", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"ws2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"AccountingForm", "[", 
                    RowBox[{"ws", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ws", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ws", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ts2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{
                    RowBox[{"ts2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"ts2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ts2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ws2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{
                    RowBox[{"ws2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"ws2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ws2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ws3", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ws2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<>", "\"\<+-\>\"",
                     "<>", 
                    RowBox[{"ws2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ws2", "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"ts3", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ts2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<>", "\"\<+-\>\"",
                     "<>", 
                    RowBox[{"ts2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ts2", "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"AccountingForm", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"resout", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"ws3", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<bb\>\"", ",", 
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "<>", "\"\<+-\>\"",
                     "<>", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\"\<ww (%)\>\""}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{"ts3", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<hh\>\"", ",", 
                    RowBox[{
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "<>", "\"\<+-\>\"",
                     "<>", 
                    RowBox[{"fittab2", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
                    "\"\<tautau (yr)\>\""}], "}"}]}], "]"}], "]"}]}], "}"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PrependTo", "[", 
                    RowBox[{
                    RowBox[{"resout", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\"\<multirowstart\>\"", "<>", 
                    RowBox[{"ensemtitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"nvar", "+", "1", "-", "j"}]}], "]"}], "]"}], 
                    "<>", "\"\<multirowend\>\""}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PrependTo", "[", 
                    RowBox[{
                    RowBox[{"resout", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "nvar"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"rsquaredout", "=", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"rsquareds", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "12"}], "]"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"i", "=", "3"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"rsquaredout", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], "\[Equal]", 
                    "\"\<9\>\""}], ",", 
                    RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"rsquaredout2", "=", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"rsquaredout", ",", "i"}], "]"}]}], ";"}], "*)"}],
                     "\[IndentingNewLine]", 
                    RowBox[{"rsquaredout2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"rsquaredout", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], "\[Equal]", 
                    "\"\<0\>\""}], ",", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"rsquareds", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "2"}], ")"}]}]}]}], "]"}]}], ",", 
                    "12"}], "]"}], "]"}], ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "<>", "\"\<0\>\""}], 
                    ",", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"1.", "*", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"rsquareds", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "2"}], ")"}]}]}]}], "]"}]}], ",", 
                    "12"}], "]"}], "]"}], ",", "i"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"resout2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"resout", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"nvar", "+", "3", "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{"resout", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<multirowstart\>\"", "<>", "rsquaredout2", "<>", 
                    "\"\<multirowend\>\""}], ",", "\"\<\>\""}], "}"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";"}], ",", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"resout2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"\"\<multirowstart\>\"", "<>", 
                    RowBox[{"ensemtitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "j"}], "]"}], "]"}], "<>", 
                    "\"\<multirowend\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "nvar"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<multirowstart-multirowend\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"nvar", "+", "4", "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"resouts", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", "resout2"}], 
                 ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"resouts", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "=", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"resouts", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "1"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", "\"\<R2\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ensemtitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "nvar"}], "}"}]}], "]"}], ",", 
                    "\"\<\>\"", ",", 
                    RowBox[{"analysisshorts", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<ii\>\""}], 
                    "}"}]}], "]"}], "]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"alltimescaless", "[", 
                RowBox[{"[", 
                 RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "timescaless"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"allweightingss", "[", 
                RowBox[{"[", 
                 RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "weightingss"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"allbases", "[", 
                RowBox[{"[", 
                 RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "bases"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"allpeaks", "[", 
                RowBox[{"[", 
                 RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "peaks"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"textimescalebase", "=", 
               RowBox[{"textimescale", "=", 
                RowBox[{"textimescaleindiv", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{",", 
                   RowBox[{"{", "ndroptabvars", "}"}]}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"TeXForm", "[", 
                    RowBox[{
                    RowBox[{"resouts", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "//", "TableForm"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"\"\<array\>\"", "\[Rule]", "\"\<tabular\>\""}]}],
                    "]"}]}], ";", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newlines", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<\\n\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<\\n\>\""}], 
                    "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "=", 
                    RowBox[{"StringInsert", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    "\"\<\\\\hline\\n\>\"", ",", 
                    RowBox[{"newlines", "[", 
                    RowBox[{"[", 
                    RowBox[{"l", "-", "1", "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"lines", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}]}], "]"}], "]"}]}], 
                    "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"Length", "[", "lines", "]"}]}], "}"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"dashlineposs", "=", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"2", "+", 
                    RowBox[{"i", "*", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"nruns", "-", "control", "-", "1"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"lines", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"Length", "[", "lines", "]"}]}], "}"}]}], "]"}]}],
                     "]"}], "-", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newlines", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<\\\\\\\\\>\""}],
                     "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "3"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<\\\\\\\\\>\""}],
                     "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "=", 
                    RowBox[{"StringInsert", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    "\"\<\\\\hdashline\\n\>\"", ",", 
                    RowBox[{"newlines", "[", 
                    RowBox[{"[", 
                    RowBox[{"dashlineposs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "dashlineposs", "]"}]}], "}"}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"lll", "=", 
                  RowBox[{"StringPosition", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<lll\>\""}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplacePart", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"StringJoin", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<c\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"Last", "[", "lll", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"First", "[", "lll", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "lll", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "lll", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"columnpos", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<c\>\"", ",", 
                    RowBox[{"{", "nvar", "}"}]}], "]"}], "]"}]}], "]"}], "[", 
                    
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tabtop", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<c\>\"", ",", 
                    RowBox[{"{", "nvar", "}"}]}], "]"}], "]"}], "<>", 
                    "\"\<}\>\""}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "3"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<|\>\"", ",", 
                    "columnpos"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"\"\<\\hline\\n\\multicolumn{\>\"", "<>", 
                    RowBox[{"ToString", "[", "nvar", "]"}], "<>", 
                    "\"\<}{c|}{\\\\textbf{variables}}&\\multicolumn{\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}], "+", "4"}], "]"}], 
                    "<>", "\"\<}{c}{\>\"", "<>", 
                    "\"\<fit to \\\\begin{math}\>\"", "<>", 
                    RowBox[{"analysisvshorts", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                    "\"\<(t)=b+h\\\\sum_i w_i \>\"", "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fitbase", "\[Equal]", "E"}], ",", "\"\<e\>\"", 
                    ",", 
                    RowBox[{"ToString", "[", "fitbase", "]"}]}], "]"}], "<>", 
                    "\"\<^{-(t-t_0)/\\\\tau_i}\\\\end{math}\>\"", "<>", 
                    "\"\<} \\\\\\\\\\n\\hline\\n\>\""}], ",", "tabtop"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<|\>\"", ",", 
                    RowBox[{"columnpos", "+", "3"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<|\>\"", ",", 
                    RowBox[{"columnpos", "+", "5"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescalebase", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringInsert", "[", 
                   RowBox[{
                    RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<|\>\"", ",", 
                    RowBox[{"columnpos", "+", "5", "+", 
                    RowBox[{"Max", "[", 
                    RowBox[{"fittingselections2", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "]"}], "+", "1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"captionlength", "=", 
                  RowBox[{"StringLength", "[", 
                   RowBox[{
                   "\"\<\\\\textbf{Timescale fitting} for excess \>\"", "<>", 
                    
                    RowBox[{"analysisvarslong", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", "\"\< decay\>\""}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"caption", "=", 
                  RowBox[{
                  "\"\<Timescale fitting for excess \>\"", "<>", 
                   "\"\<\\\\textbf{\>\"", "<>", 
                   RowBox[{"analysisvarslong", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", "\"\<}\>\"", "<>", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"captionlength", ">", "maxcaptionlength"}], ",", 
                    "\"\<\\\\\\\\\>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                   "\"\< decay\>\""}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescale", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{
                  "\"\<\\n\\n\\\\begin{table}[htbp]\\n\\\\begin{small}\\n\\\\\
centering\>\"", "<>", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "==", "1"}], ",", 
                    RowBox[{
                    "\"\<\\n\\caption{\>\"", "<>", "caption", "<>", 
                    "\"\<}\>\""}], ",", "\"\<\>\""}], "]"}], "<>", 
                   "\"\<\\n\>\"", "<>", 
                   RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "==", "1"}], ",", 
                    RowBox[{
                    "\"\<\\n\\label{tab:\>\"", "<>", "\"\<timescale\>\"", 
                    "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", "\"\<}\>\""}], ",", 
                    "\"\<\>\""}], "]"}], "<>", 
                   "\"\<\\n\\\\end{small}\\n\\\\end{table}\\n\\n\>\""}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescaleindiv", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{
                  "\"\<\\n\\n\\\\begin{table}[htbp]\\n\\\\begin{small}\\n\\\\\
centering\>\"", "<>", "\"\<\\n\\caption{\>\"", "<>", "caption", "<>", 
                   "\"\<}\>\"", "<>", "\"\<\\n\>\"", "<>", 
                   RowBox[{"textimescalebase", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                   "\"\<\\n\\label{tab:\>\"", "<>", "\"\<timescale\>\"", 
                   "<>", "\"\<_\>\"", "<>", "outtitleprefix", "<>", 
                   RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", "\"\<}\>\"", "<>", 
                   "\"\<\\n\\\\end{small}\\n\\\\end{table}\\n\\n\>\""}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "=", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e${}^{\\wedge}$-``\>\"", ",", "i"}], "]"}], 
                    "]"}], "\[Rule]", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e$^{-``}$\>\"", ",", "i"}], "]"}], "]"}]}]}],
                     "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescale", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<multirowstart\>\"", "->", 
                    "\"\<\\\\multirow{2}{*}{\>\""}], ",", 
                    RowBox[{"\"\<multirowend\>\"", "->", "\"\<}\>\""}], ",", 
                    RowBox[{"\"\<ic pCO2\>\"", "->", "\"\<ic pCO$_2$\>\""}], 
                    ",", 
                    RowBox[{"\"\<pCO2 (\>\"", "->", "\"\<pCO$_2$ (\>\""}], 
                    ",", 
                    RowBox[{"\"\<}pCO2\>\"", "->", "\"\<}pCO_2\>\""}], ",", 
                    RowBox[{
                    "\"\<\\Delta pCO2\>\"", "->", "\"\<\\Delta pCO_2\>\""}], 
                    ",", 
                    RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}], 
                    ",", 
                    RowBox[{"\"\<oC\>\"", "->", "\"\<$^{\\circ}$C\>\""}], ",", 
                    RowBox[{
                    "\"\<tautau\>\"", "->", 
                    "\"\<\\\\textit{$\\\\tau$$_i$}\>\""}], ",", 
                    RowBox[{"\"\<hh\>\"", "->", "\"\<\\\\textit{h}\>\""}], 
                    ",", 
                    RowBox[{"\"\<ww\>\"", "->", "\"\<\\\\textit{w$_i$}\>\""}],
                     ",", 
                    RowBox[{"\"\<bb\>\"", "->", "\"\<\\\\textit{b}\>\""}], 
                    ",", 
                    RowBox[{"\"\<ii\>\"", "->", "\"\<\\\\textit{i}\>\""}], 
                    ",", 
                    RowBox[{"\"\<+-\>\"", "->", "\"\<$\\\\pm$\>\""}], ",", 
                    RowBox[{"\"\<R2\>\"", "\[Rule]", "\"\<R$^2$\>\""}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescale", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}]}],
                    "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "=", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e${}^{\\wedge}$-``\>\"", ",", "i"}], "]"}], 
                    "]"}], "\[Rule]", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<e$^{-``}$\>\"", ",", "i"}], "]"}], "]"}]}]}],
                     "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "9"}], "}"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescaleindiv", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<multirowstart\>\"", "->", 
                    "\"\<\\\\multirow{2}{*}{\>\""}], ",", 
                    RowBox[{"\"\<multirowend\>\"", "->", "\"\<}\>\""}], ",", 
                    RowBox[{"\"\<ic pCO2\>\"", "->", "\"\<ic pCO$_2$\>\""}], 
                    ",", 
                    RowBox[{"\"\<pCO2 (\>\"", "->", "\"\<pCO$_2$ (\>\""}], 
                    ",", 
                    RowBox[{"\"\<}pCO2\>\"", "->", "\"\<}pCO_2\>\""}], ",", 
                    RowBox[{
                    "\"\<\\Delta pCO2\>\"", "->", "\"\<\\Delta pCO_2\>\""}], 
                    ",", 
                    RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}], 
                    ",", 
                    RowBox[{"\"\<oC\>\"", "->", "\"\<$^{\\circ}$C\>\""}], ",", 
                    RowBox[{
                    "\"\<tautau\>\"", "->", 
                    "\"\<\\\\textit{$\\\\tau$$_i$}\>\""}], ",", 
                    RowBox[{"\"\<hh\>\"", "->", "\"\<\\\\textit{h}\>\""}], 
                    ",", 
                    RowBox[{"\"\<ww\>\"", "->", "\"\<\\\\textit{w$_i$}\>\""}],
                     ",", 
                    RowBox[{"\"\<bb\>\"", "->", "\"\<\\\\textit{b}\>\""}], 
                    ",", 
                    RowBox[{"\"\<ii\>\"", "->", "\"\<\\\\textit{i}\>\""}], 
                    ",", 
                    RowBox[{"\"\<+-\>\"", "->", "\"\<$\\\\pm$\>\""}], ",", 
                    RowBox[{"\"\<R2\>\"", "\[Rule]", "\"\<R$^2$\>\""}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"textimescaleindiv", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "=", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                    RowBox[{"\"\<GEM-CO$_2$\>\"", "->", "\"\<GEM-CO2\>\""}]}],
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"texensem", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "~~", 
                    "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"outtitleprefix", "<>", 
                    RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                    "\"\<_fittab.tex\>\""}], ",", 
                   RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"writeuproot", "<>", "outtitleprefix", "<>", 
                    RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                    "\"\<_fittab.tex\>\""}], ",", 
                   RowBox[{"textimescaleindiv", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"outtitleprefix", "<>", 
                    RowBox[{"analysisvars", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                    "\"\<_fig_tab.tex\>\""}], ",", 
                   RowBox[{"texensem", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], ",", "\"\<Text\>\""}], 
                  "]"}], ";"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"break", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"nvar", ">", "2"}], ",", "\"\<\\hline\\n\\hline\>\"",
                  ",", "\"\<\\hline\>\""}], "]"}]}], ";", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"nruns", "-", "control"}], ">", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "/", "3"}], "*", "maxtableportraitrows"}], 
                    ")"}], "/", "2"}], "]"}]}], "&&", 
                   RowBox[{"nvar", ">", "1"}], "&&", 
                   RowBox[{"d", "\[NotEqual]", "2"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "=", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"#", ",", "break"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    "1"}]}], "]"}], "<>", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"#", ",", "\"\<\\n\\end{tabular}\>\""}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"StringLength", "[", "#", "]"}]}], "}"}]}], "]"}],
                     "<>", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"#", ",", "break"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}]}], "]"}], "<>", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"#", ",", "break"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "+", "1"}], 
                    ",", 
                    RowBox[{"StringLength", "[", "#", "]"}]}], "}"}]}], 
                    "]"}]}], ")"}], "&"}], "@", 
                    RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"texinc", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "x"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{
                    RowBox[{"texdroptableapp", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], "<>", 
                    "\"\<\\n\\n\\n\>\""}]}], "]"}], ";"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "ndrop"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"texinc", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", "*", 
                    RowBox[{"(", 
                    RowBox[{"ndrop", "+", "1"}], ")"}]}]}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "1"}], "&&", 
                    RowBox[{"d", "\[NotEqual]", "2"}]}], ",", 
                    "\"\<\\\\begin{landscape}\\n\>\"", ",", "\"\<\>\""}], 
                    "]"}], "<>", 
                   RowBox[{"textimescale", "[", 
                    RowBox[{"[", "d", "]"}], "]"}], "<>", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "nensem"}], "&&", 
                    RowBox[{"d", "\[NotEqual]", "2"}]}], ",", 
                    "\"\<\\n\\\\end{landscape}\\n\\n\>\"", ",", 
                    "\"\<\\n\\n\>\""}], "]"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "ndroptabvars"}], "}"}]}], "]"}], ";"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"texinc", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", "1"}], ")"}], "*", "ndrop"}], "+", 
                    "x"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"texdroptableapp", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "x"}], "]"}], "]"}], "<>", 
                  "\"\<\\n\\n\\n\>\""}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "ndrop"}], "}"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"5", " ", 
             RowBox[{"e", ".", " ", "Remaining"}], " ", "fraction", " ", 
             "plots"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"remainingfrac", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxs", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", 
                    RowBox[{"k", "-", "control"}]}], "]"}], "]"}], "<", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"100", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"maxs", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", 
                    RowBox[{"k", "-", "control"}]}], "]"}], "]"}], ",", "2"}],
                     "]"}], "]"}], "-", 
                    RowBox[{"baselines", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}]}], ")"}]}]}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"dataset3", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"graphout", "=", 
            RowBox[{"Grid", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"remainingfrac", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nruns", "-", "control"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<percentage of\\n`` remaining\>\"", ",", 
                    RowBox[{
                    StyleBox["plotvaluenames",
                    FontColor->GrayLevel[0]], "[", 
                    RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "}"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", 
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"alpha", ",", 
                    RowBox[{"{", "d", "}"}]}], "]"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "30"}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
                    RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"0.05", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
                    "92"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], "&&", 
                    RowBox[{"d", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "10", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"TableForm", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"newlegendplus", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "]"}], ",", 
                    
                    RowBox[{"Length", "[", "newlegendplus", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"TableSpacing", "\[Rule]", "tabspacing"}]}], 
                    "]"}]}], "}"}], "}"}], "]"}], "]"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"ImageSize", "\[Rule]", "30"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], 
                    ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "12"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "11", ",", 
                    "14"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", "13"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"e", "\[Equal]", "liths"}], ",", "12", ",", 
                    "15"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameStyle", "\[Rule]", "White"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "]"}], ",", 
                    "Null"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"550000", ",", "50"}], "}"}]}], "]"}]}], "}"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "335", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "==", "ndroptabvars"}], ",", "268", ",", 
                    "250"}], "]"}]}], "]"}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "95", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "==", "ndroptabvars"}], ",", "20", ",", 
                    "3.8"}], "]"}], ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], "&&", 
                    RowBox[{"d", "\[Equal]", "1"}]}], ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{"gridlines", ",", "Automatic"}], "}"}]}], "]"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"graphics3", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "15"}], "}"}]}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "ndroptabvars"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"StyleForm", "[", 
                   RowBox[{"year", ",", "Bold", ",", 
                    RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}], "]"}], 
                 ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"screenoutputgraph", "\[Equal]", "1"}], ",", 
             RowBox[{"Print", "[", "graphout", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"plotlabel", "=", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Percentages of key variables remaining for `` ensemble\>\"",
               ",", 
              RowBox[{"ensemoutnames", "[", 
               RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphtitle", "=", 
               RowBox[{"outtitleprefix", "~~", "\"\<multi_frac_remain.\>\"", "~~", 
                RowBox[{"saveformats", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"graphtitletex", "=", 
               RowBox[{
                RowBox[{"StringDrop", "[", 
                 RowBox[{"graphtitle", ",", 
                  RowBox[{"-", "4"}]}], "]"}], "~~", "\"\<_fig.tex\>\""}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"latex", "=", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<\\\\begin{figure}[htp]\\n\\\\centering\\n\\\\\
includegraphics[scale=``]{``}\\n\\\\caption{``}\\n\\\\label{fig:``}\\n\\\\end{\
figure}\\n\>\"", ",", 
                   RowBox[{"ToString", "[", "latexscale", "]"}], ",", 
                   "graphtitle", ",", 
                   RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "plotlabel", "]"}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\_\>\""}]}], "]"}], 
                   ",", "graphtitle"}], "]"}], ",", "StandardForm"}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitletex", ",", 
                RowBox[{"latex", "~~", "\"\<\\n\\\\clearpage\\n\\n\>\""}], 
                ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"graphtitle", ",", "graphout"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitletex"}], ",", "latex", 
                ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"texinc", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"ndroptabvars", "*", 
                    RowBox[{"(", 
                    RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "2"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"latex", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"writeuproot", "~~", "graphtitle"}], ",", 
                "graphout"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"outtitleprefix", "~~", "\"\<.tex\>\""}], ",", 
             RowBox[{"Flatten", "[", "texensem", "]"}], ",", "\"\<Text\>\""}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"writeuproot", "~~", 
              RowBox[{"StringDrop", "[", 
               RowBox[{"outtitleprefix", ",", 
                RowBox[{"-", "1"}]}], "]"}], "~~", "\"\<.tex\>\""}], ",", 
             RowBox[{"Flatten", "[", "texensem", "]"}], ",", "\"\<Text\>\""}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"texall", "[", 
              RowBox[{"[", "e", "]"}], "]"}], ",", 
             RowBox[{"Flatten", "[", "texensem", "]"}]}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Part", " ", "6"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "savenetcdfmovies", "]"}], "\[NotEqual]", 
            "0"}], "&&", 
           RowBox[{"f", "\[Equal]", "npartsoutput"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["If",
             FontColor->GrayLevel[0]], 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            RowBox[{
             StyleBox[
              RowBox[{"Not", "[", 
               RowBox[{"FileExistsQ", "[", "landmaskfile", "]"}], "]"}],
              FontColor->GrayLevel[0]], 
             StyleBox[",",
              FontColor->GrayLevel[0]], 
             RowBox[{
              RowBox[{"CreateDialog", "[", 
               RowBox[{"{", 
                RowBox[{
                 StyleBox[
                  RowBox[{
                  "\"\<landmaskfile '\>\"", "<>", "landmaskfile", "<>", 
                   "\"\<' does not exist or is not connected, click Abort in \
the window 'Local Kernel Interrupt' and check\>\""}],
                  FontColor->GrayLevel[0]], 
                 StyleBox[",",
                  FontColor->GrayLevel[0]], 
                 RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}], 
              StyleBox[";",
               FontColor->GrayLevel[0]], 
              StyleBox["\[IndentingNewLine]",
               FontColor->GrayLevel[0]], 
              StyleBox[
               RowBox[{"Interrupt", "[", "]"}],
               FontColor->GrayLevel[0]]}]}], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"MemoryConstrained", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"$HistoryLength", "=", "0"}], ";", 
              RowBox[{"Share", "[", "]"}], ";", 
              RowBox[{"Unprotect", "[", 
               RowBox[{"In", ",", "Out"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"SetDirectory", "[", 
               RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"partnames", "[", 
                 RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"CreateDirectory", "[", "\"\<movies\>\"", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"SetDirectory", "[", "\"\<movies\>\"", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"CreateDirectory", "[", 
                 RowBox[{"runids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"CreateDirectory", "[", 
                  RowBox[{"\"\<comparisons_\>\"", "~~", 
                   RowBox[{"ToString", "[", "n", "]"}], "~~", "\"\<_\>\"", "~~", 
                   RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ";"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "nvar"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
              "CreateDirectory", "[", "\"\<comparisons_0_all\>\"", "]"}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"6", " ", 
                 RowBox[{"a", ".", " ", "Net"}]}], "-", 
                RowBox[{"CDF", " ", "set"}], "-", "up"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"nfilenamesnetcdf", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"filenamenosnetcdf", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"nfilenamestotnetcdf", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"nfilenamesnetcdf", ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"years1", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "1"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                    "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"years1", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{"years1", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "\[NotEqual]", 
                    "\"\<sedgem\>\""}], ",", " ", "1", ",", " ", "0"}], 
                    "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nnetcdfmodules", ">", "3"}], ",", 
                RowBox[{
                 RowBox[{"newyears", "=", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "i"}], "]"}], "]"}], ">=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"newyears", ",", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ";", 
                 RowBox[{
                  RowBox[{"years1", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "=", "newyears"}]}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\nnetcdf years:\\n\>\"", ",", 
                RowBox[{"years1", "//", "TableForm"}], ",", 
                "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"nnetcdfyears", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"years1", "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"allnames", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                   RowBox[{"{", "\"\<Datasets\>\"", "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", 
              RowBox[{"datanames", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"allnames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"nhousekeepingdata", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"allnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", "6", "}"}]}], "}"}]}], "]"}]}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"netcdfoutputlist", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "1", ",", "i"}], "]"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PrependTo", "[", 
                  RowBox[{
                   RowBox[{"netcdfoutputlist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"\"\<fields_\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_2d\>\""}]}], 
                    "}"}]}], "]"}], ";"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<datanames:\\n\>\"", ",", 
                  RowBox[{"netcdfoutputlist", "//", "TableForm"}], ",", 
                  "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"SetDirectory", "[", 
               RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"partnames", "[", 
                 RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                "newdirectory"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
               "\"\<2D_output_list.xls\>\"", ",", "netcdfoutputlist"}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "2"}], 
                ",", 
                RowBox[{
                 RowBox[{"netcdfoutputlist3d", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", "i"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "\"\<3D_output_list.xls\>\"", ",", "netcdfoutputlist3d"}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"filenamesnetcdf", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"filenamesnetcdfdisp", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"i", "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", ">", "1"}], ",", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"mm", ",", "dd"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"mm", ",", 
                    RowBox[{"m", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"dd", ",", "d"}], "}"}]}], "]"}], ",", "0"}], 
                    "]"}]}], "]"}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "2"}], ",", "\"\<-3D\>\"", ",", 
                    "\"\<\>\""}], "]"}]}], ",", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"d", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<netcdf output:\\n\>\"", ",", 
                RowBox[{"filenamesnetcdfdisp", "//", "TableForm"}], ",", 
                "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
               "\"\<2D_collated.csv\>\"", ",", "filenamesnetcdfdisp"}], "]"}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"nrealdata", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"annotations", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                   RowBox[{"{", "\"\<Annotations\>\"", "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", 
              RowBox[{"annotations", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"annotations", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{
                    RowBox[{"nhousekeepingdata", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"allnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"annotations", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"annotations", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "5", "}"}], ",", 
                    RowBox[{"{", "6", "}"}]}], "}"}]}], "]"}]}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"headings", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"annotations", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l", ",", "i", ",", "1"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"annotations", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "]"}]}], 
                  "}"}]}], "]"}]}], ";", 
              RowBox[{"unitposition", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"headings", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\<units\>\""}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"headings", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\<units\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", 
              RowBox[{"units", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"unitposition", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", "\"\<\>\"", ",", 
                   RowBox[{"annotations", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l", ",", 
                    RowBox[{"unitposition", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "2"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"longnameposition", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"headings", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\<long_name\>\""}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"headings", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\<long_name\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", 
              RowBox[{"longnames", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"longnameposition", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", "\"\<\>\"", ",", 
                   RowBox[{"annotations", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l", ",", 
                    RowBox[{"longnameposition", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "2"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"longnames", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"longnames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\< (\>\"", "~~", 
                  RowBox[{"units", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\<)\>\""}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"longnamesunbroken", "=", "longnames"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"longnames", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringLength", "[", 
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "]"}], 
                    ">", "maxnetcdftitlestringlength"}], ",", 
                   RowBox[{"StringInsert", "[", 
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\<\\n\>\"", ",", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                    "\"\< \>\""}], "]"}], "]"}], ",", 
                    "maxnetcdftitlestringlength"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"nrealdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"vartitlesplot", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringLength", "[", 
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], ">", 
                    "maxnetcdfsubtitlestringlength"}], ",", 
                   RowBox[{"StringInsert", "[", 
                    RowBox[{
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\"\< \>\""}], "]"}],
                     "]"}], ",", "maxnetcdfsubtitlestringlength"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Format", "[", 
                RowBox[{"v", "[", "n_Integer", "]"}], "]"}], ":=", 
               RowBox[{"\"\<v\>\"", "<>", 
                RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"list", "=", 
               RowBox[{"Array", "[", 
                RowBox[{"v", ",", "nvar"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"varmultipliers", "=", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "nvar", ",", 
                    RowBox[{"nvar", "-", "m"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "0", ",", 
                    RowBox[{"nvar", "-", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
                 "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"genielatsused", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{"180", "*", 
                   RowBox[{
                    RowBox[{"ArcSin", "[", 
                    RowBox[{"k", "/", 
                    RowBox[{"(", 
                    RowBox[{"genielat", "/", "2"}], ")"}]}], "]"}], "/", 
                    "\[Pi]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"genielat", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"genielatsused", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Reverse", "[", "genielatsused", "]"}]}], ",", "0",
                   ",", "genielatsused"}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"latdiffs", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"Differences", "[", "genielatsused", "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"genielatsused", "=", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"genielatsused", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], "+", 
                RowBox[{"latdiffs", "/", "2."}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"landmask1", "=", 
               RowBox[{"Import", "[", 
                RowBox[{"landmaskfile", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
              RowBox[{"landmask2", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"landmask1", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\<  \>\"", "\[Rule]", "\"\< 0\>\""}]}], "]"}], 
                    ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"3", "*", "i"}], "-", "2"}], ",", 
                    RowBox[{
                    RowBox[{"3", "*", "i"}], "-", "1"}]}], "}"}]}], "]"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"genielon", "+", "2"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"genielat", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
              RowBox[{"landmask3", "=", 
               RowBox[{"ToExpression", "[", "landmask2", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"landmask4", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"landmask3", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "genielat"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"landmask", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"landmask4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "90"}], ",", 
                   "1", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "genielat"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"landmask", "=", 
               RowBox[{"Reverse", "[", "landmask", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"seamask", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"landmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], 
                   ",", "1", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "genielat"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"landmask4", "=", 
               RowBox[{"Reverse", "[", "landmask4", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"oceanmask", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"landmask4", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"nlevels", "+", "1", "-", "z"}]}], ",", "1", ",", 
                   "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "genielat"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"seabedmask", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"oceanmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", "i", ",", "j"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "genielat"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"ArrayPlot", "[", "seamask", "]"}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"masknames", "=", 
               RowBox[{"{", 
                RowBox[{
                "\"\<land and sea\>\"", ",", "\"\<land only\>\"", ",", 
                 "\"\<sea only\>\"", ",", "\"\<ocean only\>\""}], "}"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"6", " ", 
                RowBox[{"b", ".", " ", "Animations"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"savenetcdfmovies", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{"savenetcdfmovies", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{"savenetcdfmovies", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Do", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dateref", "=", 
                    RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"(", 
                    RowBox[{"k", "=", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], "-", "1"}], 
                    ")"}], "*", "varmultipliers"}], "]"}], "+", "1"}]}], 
                    ")"}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"outname", "=", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "2"}], ",", "\"\<_3D\>\"", ",", 
                    "\"\<\>\""}], "]"}], "~~", "\"\<_movie\>\"", "~~", 
                    RowBox[{"ToString", "[", "s", "]"}], "~~", 
                    "\"\<.gif\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<-- \>\"", "~~", "outname", "~~", "\"\< --\>\""}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<importing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                    "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", 
                    RowBox[{
                    RowBox[{"newyears", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ">=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"newyears", ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}], 
                    ";", 
                    RowBox[{"years", "=", 
                    RowBox[{"1.", "*", "newyears"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"years", "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "\[NotEqual]", "2"}], ",", "1", ",", "0"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nnetcdfyears2", "=", 
                    RowBox[{"Length", "[", "years", "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                    RowBox[{
                    RowBox[{"netcdfdata", " ", "=", " ", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", " ", "2", ",", " ", "1"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nnetcdfyears2"}], "}"}]}], "]"}]}], 
                    ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", " ", "=", " ", 
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<processing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"quant", "=", 
                    RowBox[{"1.", "*", 
                    RowBox[{"netcdfplotthreshold", "/", 
                    RowBox[{"(", 
                    RowBox[{"genielat", "*", "genielon"}], ")"}]}]}]}], ";"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"numbers", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", "netcdfdata", "]"}], "]"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}]}], "]"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"numbers", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"numbers", "=", 
                    RowBox[{"{", "0", "}"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"maxima", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "numbers", "]"}], "<", "3"}], ",", 
                    
                    RowBox[{"Last", "[", "numbers", "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "numbers", "]"}], "-", 
                    "netcdfoutliers"}], "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minima", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "numbers", "]"}], "<", "3"}], ",", 
                    
                    RowBox[{"First", "[", "numbers", "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "netcdfoutliers"}], "]"}], "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"med", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"minima", "+", "maxima"}], ")"}], "/", "2."}]}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", 
                    RowBox[{"gap", "=", "\"\<\\n\>\""}], ",", 
                    RowBox[{"gap", "=", "\"\<      \>\""}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfplottitles", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], "]"}], "]"}]}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "\[Equal]", "nvar"}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ")"}]}]}], ",", 
                    "\"\<\\n\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"x", "\[Equal]", "nvar"}], ",", "\"\<\>\"", ",", 
                    "\"\<\\n\>\""}], "]"}], ",", "\"\<; \>\""}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "nvar"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", "\"\<\\n\>\"", 
                    ",", "\"\<: \>\""}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"gap", "~~", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "gap", "~~", "\"\<year \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    "]"}]}]}], "]"}], "]"}], ",", "Black", ",", "Bold", ",", 
                    "17"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"a", "=", "1"}], ";", 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nans", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"landtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "landmask"}], ",", 
                    "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"seatot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seamask"}], ",", 
                    "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"landtot", ">", "bignumber"}], "||", 
                    RowBox[{"landtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "3"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"seatot", ">", "landtot"}]}], ")"}], "||", 
                    RowBox[{"seatot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "2"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"landtot", ">", "bignumber"}]}], ",", 
                    RowBox[{"nans", "=", "1"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"neither", " ", "land", " ", "nor", " ", "sea"}], 
                    "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"seabedtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seabedmask"}], ",", 
                    "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seabedtot", ">", "bignumber"}], "||", 
                    RowBox[{"seabedtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "4"}]}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"ocean", " ", "only"}], " ", "-", " ", 
                    RowBox[{"3", "D"}]}], "*)"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "2"}], ",", 
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "*", "landmask"}], "+", 
                    RowBox[{"med", "*", "seamask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "3"}], ",", 
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "*", "seamask"}], "+", 
                    RowBox[{"med", "*", "landmask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "4"}], ",", 
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "*", "oceanmask"}], "+", 
                    RowBox[{"med", "*", "seabedmask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"nans", "\[Equal]", "1"}], ",", 
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], 
                    "\[Rule]", "med"}], ",", "4"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<NaNs? \>\"", ",", "nans"}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "netcdfimagesize", 
                    ",", 
                    RowBox[{"netcdfimagesize", "/", "2"}]}], "]"}], "}"}]}], 
                    ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"med", "\[Rule]", "nodatacolour"}], "}"}]}], ",", 
                    
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z"}], "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "netcdfimagesize", 
                    ",", 
                    RowBox[{"netcdfimagesize", "/", "2"}]}], "]"}], "/", 
                    "3"}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"med", "\[Rule]", "nodatacolour"}], "}"}]}], ",", 
                    
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"\"\<level \>\"", "~~", 
                    RowBox[{"ToString", "[", "z", "]"}], "~~", 
                    "\"\<\\n  \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"depths", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "~~", 
                    "\"\<m\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "20", ",", "10"}], 
                    "]"}]}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "27"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"x", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"100", "/", "6"}], ",", 
                    RowBox[{"100", "/", "3"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ticks", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Min", "[", "numbers", "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}], "<>", "\"\<<-\>\""}]}], "}"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"minima", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "x"}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"maxima", "-", "minima"}], ")"}], "/", 
                    "100"}]}]}], ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "x", ",", 
                    RowBox[{"100", "+", "x"}], ",", "x"}], "}"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"100", "+", 
                    RowBox[{"2", "*", "x"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}]}], ",", 
                    RowBox[{"\"\<->\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", "numbers", "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "+=", "1"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"legend", "=", 
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"0", "-", "x"}], ",", 
                    RowBox[{"100", "+", "x"}]}], "}"}]}], "]"}], "}"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "netcdfimagesize", 
                    ",", 
                    RowBox[{"netcdfimagesize", "/", "2"}]}], "]"}], "}"}]}], 
                    ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ticks", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"-", "x"}], "/", "2"}], "*)"}], ",", "100"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"+", "x"}], "/", "2"}], "*)"}], "}"}]}], ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"-", "1"}]}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"101", "<=", "#"}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}]}], "}"}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"charttable1", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"netcdfplottitles", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "legend", "}"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"Text", "[", 
                    RowBox[{"longnamesunbroken", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "]"}], "}"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "||", 
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}]}], 
                    ")"}], "&&", 
                    RowBox[{"s", ">", "1"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "med"}], 
                    "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "med", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", "med"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"yy", ",", "z"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"yy", ",", "z"}], "]"}], "]"}], "]"}], ",", 
                    "med"}], "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "med", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"yy", ",", "z"}], "]"}], "]"}], "]"}], ",", 
                    "med"}], "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{"yearsdata", ",", "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", "1.6", ",", 
                    "1.8"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", "180", ",", 
                    "180"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "20", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "Automatic"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    "}"}], ",", "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "8"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<year\>\"", ",", "13"}], "]"}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{"yearsdata", ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", "0.4", ",", 
                    "0.45"}], "]"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    "colours"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "400", "}"}]}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    "}"}], ",", "None"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "med"}], 
                    "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i"}], "]"}], "]"}], ",", "med"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i"}], "]"}], "]"}], ",", 
                    "med"}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i"}], "]"}], "]"}], ",", 
                    "med"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    StyleBox["latdataplots",
                    FontColor->GrayLevel[0]], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    "colours"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "400", "}"}]}], ",", " ", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "None", ",", "None"}], "}"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "2"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"charttable1", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"netcdfplottitles", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{"yearsdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                    "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"legend", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"longnamesunbroken", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "3"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"xaxisrepeats", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"100", "*", 
                    RowBox[{"Differences", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}], "]"}]}], "}"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{
                    RowBox[{"netcdflattime3", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                    "1", ",", 
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "]"}], "}"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lattimegraphs", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{"netcdflattime3", ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "400", "}"}]}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"Mesh", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "18", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "}"}]}], "}"}]}],
                     ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdflattime3", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "z", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                    "1", ",", 
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "]"}], "}"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lattimegraphs", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdflattime3", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "netcdfimagesize", 
                    ",", 
                    RowBox[{"netcdfimagesize", "/", "2"}]}], "]"}], "/", 
                    "3"}], "}"}]}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Mesh", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "18", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"xaxisrepeats", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "}"}]}], "}"}]}],
                     ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"charttable1", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"netcdfplottitles", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", "SpanFromLeft"}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{"yearsdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):  latitudinal (top left), global (top right) and \
lat-time (bottom right)\>\""}], ",", "Black", ",", "Bold", ",", "15"}], "]"}],
                     "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    RowBox[{"lattimegraphs", "[", 
                    RowBox[{"[", "y", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"legend", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"longnamesunbroken", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "nnetcdfyears2"}], 
                    "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<exporting... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "newdirectory", "~~", "\"\</movies/\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "outname"}], ",", "charttable1"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nlinks", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"LinkClose", "[", 
                    RowBox[{
                    RowBox[{"Links", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nlinks", "-", "4"}], "}"}]}], "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"s", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "##"}], 
                   "]"}], "&"}], "@", 
                 RowBox[{"(", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ")"}]}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"6", " ", 
                RowBox[{"c", ".", " ", "Comparison"}], " ", "Animations"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"savenetcdfmovies", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{"savenetcdfmovies", "[", 
                   RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dateref", "=", 
                    RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"vs", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ks", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"list", ",", "n"}], "]"}], ",", "o"}], "]"}], "-",
                     "1"}], ")"}], "*", "\[IndentingNewLine]", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"varmultipliers", "[", 
                    RowBox[{"[", 
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"varmultipliers", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "+", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"outname", "=", 
                    RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"alpha", ",", 
                    RowBox[{"{", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}], 
                    "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "2"}], ",", "\"\<_3D\>\"", ",", 
                    "\"\<\>\""}], "]"}], "~~", "\"\<_movie\>\"", "~~", 
                    RowBox[{"ToString", "[", "s", "]"}], "~~", 
                    "\"\<.gif\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<-- \>\"", "~~", "outname", "~~", "\"\< --\>\""}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<importing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                    "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", 
                    RowBox[{
                    RowBox[{"newyears", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "i"}], "]"}], "]"}], ">=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"newyears", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ";", 
                    RowBox[{"years", "=", 
                    RowBox[{"1.", "*", "newyears"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"years", " ", "-", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "!=", "2"}], ",", " ", "1", ",", " ", "0"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nnetcdfyears2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                    RowBox[{
                    RowBox[{"netcdfdata", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], " ", "~~", 
                    " ", "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", " ", "2", ",", " ", "1"}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"nnetcdfyears2", "[", 
                    RowBox[{"[", "o", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", " ", "=", "  ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], " ", "~~", 
                    " ", "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<processing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"minyear", "=", 
                    RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "-", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}]}]}], "]"}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"numbers", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"netcdfdata", ",", "netcdfdatadiff"}], "}"}], "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "=", 
                    RowBox[{"{", "0", "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"maxima", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "<", "3"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "-", 
                    "netcdfoutliers"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minima", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "<", "3"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", 
                    RowBox[{"1", "+", "netcdfoutliers"}]}], "]"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"med", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"minima", "+", "maxima"}], ")"}], "/", "2."}]}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"x", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"100", "/", "6"}], ",", 
                    RowBox[{"100", "/", "2"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ticks", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}], "<>", "\"\<<-\>\""}]}], "}"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "x"}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "-", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}]}], ")"}], "/", "100"}]}]}],
                     ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "x", ",", 
                    RowBox[{"100", "+", "x"}], ",", "x"}], "}"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"100", "+", 
                    RowBox[{"2", "*", "x"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}]}], ",", 
                    RowBox[{"\"\<->\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "+=",
                     "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"legend", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"0", "-", "x"}], ",", 
                    RowBox[{"100", "+", "x"}]}], "}"}]}], "]"}], "}"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "320", "}"}]}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                    "}"}], "[", 
                    RowBox[{"[", "z", "]"}], "]"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"-", "x"}], "/", "2"}], "*)"}], ",", "100"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"+", "x"}], "/", "2"}], "*)"}], "}"}]}], ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"-", "1"}]}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"101", "<=", "#"}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"a", "=", "1"}], ";", 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nans", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"landtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "landmask"}], 
                    ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"seatot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "seamask"}], 
                    ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"landtot", ">", "bignumber"}], "||", 
                    RowBox[{"landtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "3"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"seatot", ">", "landtot"}]}], ")"}], "||", 
                    RowBox[{"seatot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "2"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"landtot", ">", "bignumber"}]}], ",", 
                    RowBox[{"nans", "=", "1"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"neither", " ", "land", " ", "nor", " ", "sea"}], 
                    "*)"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"seabedtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    "seabedmask"}], ",", "3"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seabedtot", ">", "bignumber"}], "||", 
                    RowBox[{"seabedtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "4"}]}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"ocean", " ", "only"}], " ", "-", " ", 
                    RowBox[{"3", "D"}]}], "*)"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "landmask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seamask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "landmask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "seamask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "seamask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "landmask"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "seamask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "landmask"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "4"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "oceanmask"}],
                     "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seabedmask"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", "oceanmask"}],
                     "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "seabedmask"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"nans", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], 
                    "\[Rule]", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "4"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], 
                    "\[Rule]", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "4"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<NaNs? \>\"", ",", "nans"}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdiffplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], 
                    ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "100", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"\"\<level \>\"", "~~", 
                    RowBox[{"ToString", "[", "z", "]"}], "~~", 
                    "\"\<\\n  \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"depths", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "~~", 
                    "\"\<m\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "20", ",", "10"}], 
                    "]"}]}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "27"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdiffplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "100", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], 
                    ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"\"\<level \>\"", "~~", 
                    RowBox[{"ToString", "[", "z", "]"}], "~~", 
                    "\"\<\\n  \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"depths", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "~~", 
                    "\"\<m\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "20", ",", "10"}], 
                    "]"}]}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "27"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "yearsdata", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"yearsdata", ",", "1"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "158", ",", "158"}], 
                    "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "20", ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "nranges"}], ",", "5", ",", 
                    "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "Automatic"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<year\>\"", ",", "Bold", ",", "15"}], "]"}], 
                    "]"}], ",", "SpanFromLeft"}], "}"}]}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{"yearsdata", ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "580", "}"}]}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"oldticks", "=", 
                    RowBox[{
                    RowBox[{"FullOptions", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}], ",", 
                    "Automatic"}], "}"}]}], ",", 
                    RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], 
                    "]"}], ",", "FrameTicks"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "5"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"newlatdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamin", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "latdatadiffmin"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}],
                     "/", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    "\[Equal]", "0."}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], 
                    "]"}], ")"}]}]}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"newlatdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamin", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "latdatadiffmin"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}],
                     "/", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    "\[Equal]", "0."}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], 
                    "]"}], ")"}]}]}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "z"}], "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}]}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"newticks", "=", "oldticks"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "\"\<\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", "\"\<\>\""}], 
                    ",", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"latdatadiffmin", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    "latdatamin"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "\[Equal]", 
                    "0."}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], "==", 
                    "0."}], ",", "1", ",", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], 
                    "]"}], ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], 
                    ")"}]}]}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newticks", "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "\"\<\>\""}], ",", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newticks", "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "\"\<\>\""}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"newticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newticks", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "\"\<\>\""}], ",", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "oldticks", "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "\"\<\>\""}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "]"}], "\[Equal]", 
                    "\"\<.\>\""}], ",", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{
                    RowBox[{"oldticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "oldticks", "]"}]}], "}"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "5"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    StyleBox["latdataplots",
                    FontColor->GrayLevel[0]], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"newlatdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"newlatdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "250", "}"}]}], ",", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}],
                     ",", " ", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"oldticks", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "newticks", ",", "None"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "Orange", "}"}]}], "}"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"linethicknesses", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "Orange", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Thickness", "[", 
                    RowBox[{"linethicknesses", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thickness", "[", 
                    RowBox[{"3", "*", 
                    RowBox[{"linethicknesses", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"FrameTicksStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "Bold", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    StyleBox["latdataplots",
                    FontColor->GrayLevel[0]], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "250", "}"}]}], ",", " ", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}],
                     ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"oldticks", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "Blue", "}"}], "}"}], ",", "colours"}], 
                    "]"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"charttable", "=", 
                    RowBox[{
                    "Table", "[", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", 
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "]"}], "]"}], "<>", 
                    "\"\<: \>\"", "<>", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"list", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], "]"}], "]"}]}], "~~", 
                    "\"\<\\n\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
                    "Black", ",", "Bold", ",", "20"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "~~", "\"\<\\n\>\""}], ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", "Bold", ",", 
                    "20"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "SpanFromLeft", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"vartitlesplot", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold",
                     ",", "15"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<output\>\"", ",", "Blue", ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<output\>\"", ",", "15"}], "]"}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<difference from control\>\"", ",", "Orange", ",", 
                    "Bold", ",", "15"}], "]"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<difference from control\>\"", ",", "Bold", ",", 
                    "15"}], "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                    "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", "Bold", ",", 
                    "15"}], "]"}], "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}],
                     "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdiffplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    StyleBox[
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}],
                    FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"legend", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"legend", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<exporting... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "newdirectory", "~~", "\"\</movies/comparisons_\>\"", "~~", 
                    RowBox[{"ToString", "[", "n", "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "outname"}], ",", "charttable"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nlinks", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"LinkClose", "[", 
                    RowBox[{
                    RowBox[{"Links", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nlinks", "-", "4"}], "}"}]}], "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"s", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "##"}], 
                    "]"}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", "n"}], 
                    "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", "1", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"6", " ", 
                RowBox[{"d", ".", " ", "Comparison"}], " ", "Animations", " ", 
                RowBox[{"(", "All", ")"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"savenetcdfmovies", "[", 
                  RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Do", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    "Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dateref", "=", 
                    RowBox[{"Date", "[", "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"outname", "=", 
                    RowBox[{"ensemblename", "~~", "\"\<_all_\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "2"}], ",", "\"\<_3D\>\"", ",", 
                    "\"\<\>\""}], "]"}], "~~", "\"\<_movie\>\"", "~~", 
                    RowBox[{"ToString", "[", "s", "]"}], "~~", 
                    "\"\<.gif\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<-- \>\"", "~~", "outname", "~~", "\"\< --\>\""}], 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<importing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", 
                    "~~", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                    "\"\<d.nc\>\""}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                    "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", 
                    RowBox[{
                    RowBox[{"newyears", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ">=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"newyears", ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}], 
                    ";", 
                    RowBox[{"years", "=", 
                    RowBox[{"1.", "*", "newyears"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"years", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"years", "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "\[NotEqual]", "2"}], ",", "1", ",", "0"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nnetcdfyears2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                    RowBox[{
                    RowBox[{"netcdfdata", " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", " ", "2", ",", " ", "1"}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"nnetcdfyears2", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdata", " ", "=", "  ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    RowBox[{
                    "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", 
                    " ", 
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\</fields_\>\"", " ", "~~", " ", 
                    RowBox[{"netcdfmodules", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                    "\"\<_\>\"", " ", "~~", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                     " ", "\"\<d.nc\>\""}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Datasets\>\"", ",", " ", 
                    RowBox[{"filenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}]}], "]"}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<processing... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"minyear", "=", 
                    RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"combinations", "=", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "nruns", "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ncombs", "=", 
                    RowBox[{"Length", "[", "combinations", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"newcombs", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Reverse", "[", "combinations", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "combinations", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"triangle1", "=", 
                    RowBox[{"Split", "[", 
                    RowBox[{"newcombs", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "===", 
                    RowBox[{"First", "[", "#2", "]"}]}], "&"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"triangle2", "=", 
                    RowBox[{"Reverse", "[", "triangle1", "]"}]}], ";", 
                    RowBox[{"triangle2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", 
                    RowBox[{"triangle2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "triangle2", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"triangle1a", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"triangle1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "triangle1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"triangle1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"triangle2a", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"triangle2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "triangle2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"triangle2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"combinations", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "1"}], "]"}], "]"}], ",", "y"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"combinations", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "2"}], "]"}], "]"}], ",", "y"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"numbers", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"netcdfdata", ",", "netcdfdatadiff"}], "}"}], "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "=", 
                    RowBox[{"{", "0", "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"maxima", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "<", "3"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "-", 
                    "netcdfoutliers"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minima", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "<", "3"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", 
                    RowBox[{"z", ",", 
                    RowBox[{"1", "+", "netcdfoutliers"}]}], "]"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"med", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"minima", "+", "maxima"}], ")"}], "/", "2."}]}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"x", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", 
                    RowBox[{"100", "/", "6"}], ",", 
                    RowBox[{"100", "/", "4"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ticks", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}], "<>", "\"\<<-\>\""}]}], "}"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "x"}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "-", 
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "z", "]"}], "]"}]}], ")"}], "/", "100"}]}]}],
                     ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "x", ",", 
                    RowBox[{"100", "+", "x"}], ",", "x"}], "}"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"100", "+", 
                    RowBox[{"2", "*", "x"}], "-", 
                    RowBox[{"Round", "[", 
                    RowBox[{"x", "/", "10"}], "]"}]}], ",", 
                    RowBox[{"\"\<->\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"TraditionalForm", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"numbers", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "+=",
                     "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"legend", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"0", "-", "x"}], ",", 
                    RowBox[{"100", "+", "x"}]}], "}"}]}], "]"}], "}"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "600", "}"}]}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<runs\>\"", ",", "Blue", ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<runs\>\"", ",", "15"}], "]"}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<difference between runs\>\"", ",", "Orange", ",", 
                    "Bold", ",", "15"}], "]"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<difference between runs\>\"", ",", "Bold", ",", 
                    "15"}], "]"}], "]"}]}], "]"}]}], "}"}], "[", 
                    RowBox[{"[", "z", "]"}], "]"}]}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ticks", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                    "}"}], "[", 
                    RowBox[{"[", "z", "]"}], "]"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"-", "x"}], "/", "2"}], "*)"}], ",", "100"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"+", "x"}], "/", "2"}], "*)"}], "}"}]}], ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"-", "1"}]}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"101", "<=", "#"}], "&"}], ")"}]}], "\[Rule]", 
                    "White"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"a", "=", "1"}], ";", 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nans", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"landtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "landmask"}], 
                    ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"seatot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "seamask"}], 
                    ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"landtot", ">", "bignumber"}], "||", 
                    RowBox[{"landtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "3"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"seatot", ">", "landtot"}]}], ")"}], "||", 
                    RowBox[{"seatot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "2"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seatot", ">", "bignumber"}], "&&", 
                    RowBox[{"landtot", ">", "bignumber"}]}], ",", 
                    RowBox[{"nans", "=", "1"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"neither", " ", "land", " ", "nor", " ", "sea"}], 
                    "*)"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"seabedtot", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    "seabedmask"}], ",", "3"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"seabedtot", ">", "bignumber"}], "||", 
                    RowBox[{"seabedtot", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"a", "=", "4"}]}], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"ocean", " ", "only"}], " ", "-", " ", 
                    RowBox[{"3", "D"}]}], "*)"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], "*", "landmask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seamask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], "*", "landmask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "seamask"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], "*", "seamask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "landmask"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], "*", "seamask"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "landmask"}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "4"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], "*", "oceanmask"}],
                     "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "seabedmask"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], "*", "oceanmask"}],
                     "+", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "seabedmask"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"nans", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], 
                    "\[Rule]", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "4"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"netcdfdatadiffmask", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], 
                    "\[Rule]", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "4"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<NaNs? \>\"", ",", "nans"}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdiffplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], 
                    ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"netcdfplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "100", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{
                    "ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}],
                     ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"\"\<level \>\"", "~~", 
                    RowBox[{"ToString", "[", "z", "]"}], "~~", 
                    "\"\<\\n  \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"depths", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "~~", 
                    "\"\<m\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "20", ",", "10"}], 
                    "]"}]}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "27"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"netcdfdiffplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ArrayPlot", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "100", "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"minima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"maxima", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], 
                    ",", 
                    RowBox[{"ColorRules", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    "nodatacolour"}], "}"}]}], ",", 
                    RowBox[{"ClippingStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{
                    RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{"\"\<level \>\"", "~~", 
                    RowBox[{"ToString", "[", "z", "]"}], "~~", 
                    "\"\<\\n  \>\"", "~~", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"depths", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], "]"}], "~~", 
                    "\"\<m\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"savenetcdfmovies", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
                    RowBox[{"s", "\[Equal]", "1"}]}], ",", "20", ",", "10"}], 
                    "]"}]}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "27"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Sqrt", "[", "nlevels", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "yy", ",", "z"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "yearsdata", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"yearsdata", ",", "1"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.6"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "250", ",", "250"}], 
                    "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "1"}], ",", "20", ",", "1"}], 
                    "]"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"20", ",", "8.5"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ranges", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "Automatic"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"yeartickslin", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], ",", "None"}], "}"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", "nruns"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], "}"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "nranges"}], "}"}]}], "]"}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<year\>\"", ",", "13"}], "]"}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"yearsdataplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListLogLinearPlot", "[", 
                    RowBox[{"yearsdata", ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"0.5", "/", "3.5"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", "Automatic", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"300", "*", "3.5"}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<year\>\"", ",", 
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                    RowBox[{"GridLines", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdata", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatamax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatamin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    StyleBox["latdataplots",
                    FontColor->GrayLevel[0]], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "y"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", " ", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "Blue", "}"}], "}"}], ",", "colours"}], 
                    "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "i", ",", "1"}], "]"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"latdatadiff", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", 
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "z", ",",
                     "i"}], "]"}], "]"}], ",", 
                    RowBox[{"med", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffmin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "z", ",", "i", ",", "1"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"latdatadiffplots", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{
                    RowBox[{"latdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "y"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatadiffmin", ",", "latdatadiffmax"}], 
                    "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", " ", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", "Orange", "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "z", "]"}], "]"}], ",", 
                    RowBox[{"Thickness", "[", 
                    RowBox[{"3", "*", 
                    RowBox[{"linethicknesses", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "nlevels"}], "}"}]}], "]"}]}], 
                    "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "ncombs"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"runidtitles", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Dashing", "[", 
                    RowBox[{"dashings", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.2"}], ",", 
                    RowBox[{"-", "0.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "0.15"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"runidtext", "=", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Run ID\>\"", ",", "Black", ",", "Italic", ",", 
                    "15"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"bottomrowtext", "=", 
                    RowBox[{"{", 
                    RowBox[{"runidtext", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", 
                    RowBox[{"nruns", "+", "1", "-", "k"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ",", 
                    "\"\<\>\"", ",", "runidtext"}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"toprowtext", "=", 
                    RowBox[{"{", 
                    RowBox[{"runidtext", ",", "\"\<\>\"", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ",", 
                    "runidtext"}], "}"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"charttable", "=", 
                    RowBox[{
                    "Table", "[", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", 
                    RowBox[{"filenamenosnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "~~", "\"\<\\n\>\""}], ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", "Bold", ",", 
                    "20"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "SpanFromLeft", ",", "\[IndentingNewLine]", 
                    RowBox[{"ensemkey", "//", "TableForm"}], ",", 
                    "\[IndentingNewLine]", "SpanFromLeft", ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"yearsdataplots", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"legend", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "SpanFromLeft", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"legend", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "SpanFromLeft", ",", 
                    
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                    "Black", ",", "Bold", ",", "15"}], "]"}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "toprowtext", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "nruns", "]"}], "]"}], ",", 
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"nruns", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"latdatadiffplots", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"triangle2a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "nruns"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"netcdfdiffplots", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"triangle1a", "[", 
                    RowBox[{"[", 
                    RowBox[{"nruns", "-", "1"}], "]"}], "]"}], ",", "y"}], 
                    "]"}], "]"}]}], ",", 
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"nruns", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "nruns", "]"}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", 
                    RowBox[{"nruns", "+", "1", "-", "i"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"netcdfdiffplots", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"triangle1a", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "y"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"netcdfplots", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"nruns", "+", "1", "-", "i"}], ",", "y"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"latdataplots", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "y"}], "]"}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"latdatadiffplots", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"triangle2a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "y"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"runidtitles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", "bottomrowtext"}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<exporting... \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"starttime", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DateDifference", "[", 
                    RowBox[{"dateref", ",", 
                    RowBox[{"Date", "[", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"",
                     ",", "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
                    RowBox[{"partnames", "[", 
                    RowBox[{"[", "f", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                    "newdirectory", "~~", 
                    "\"\</movies/comparisons_0_all/\>\"", "~~", "outname"}], 
                    ",", "charttable"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nlinks", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"LinkClose", "[", 
                    RowBox[{
                    RowBox[{"Links", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Links", "[", "]"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nlinks", "-", "4"}], "}"}]}], "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"dimensions", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"nfilenamesnetcdf", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}], ",",
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "6", ",", "6"}], "}"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "maxmem"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"f", ",", "1", ",", "npartsoutput"}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4716960299082947`*^9, 3.471696032065754*^9}, {
   3.474743995388166*^9, 3.474743995526576*^9}, {3.474753072554669*^9, 
   3.474753072825268*^9}, {3.4748117487458344`*^9, 3.4748117491755533`*^9}, {
   3.4748171488147984`*^9, 3.4748171597171087`*^9}, {3.474817668489501*^9, 
   3.474817691687319*^9}, {3.474818212474127*^9, 3.474818223565349*^9}, {
   3.474818267597672*^9, 3.474818268078169*^9}, {3.474819106857888*^9, 
   3.474819186820212*^9}, {3.474819372007197*^9, 3.4748193753346157`*^9}, {
   3.474819426045575*^9, 3.474819429018928*^9}, {3.474820466344245*^9, 
   3.474820480406763*^9}, {3.474824576151536*^9, 3.474824606300096*^9}, {
   3.4748249786993027`*^9, 3.474824978914095*^9}, 3.474829903108068*^9, {
   3.474829965757491*^9, 3.4748299673426447`*^9}, {3.4748300000746927`*^9, 
   3.474830045209715*^9}, {3.474830109634406*^9, 3.4748301340891743`*^9}, {
   3.474833450896472*^9, 3.474833458623054*^9}, {3.474833509995707*^9, 
   3.474833523359276*^9}, {3.474833627980247*^9, 3.474833628319137*^9}, {
   3.4748337375353127`*^9, 3.4748337618189363`*^9}, {3.474834933965674*^9, 
   3.4748349529429398`*^9}, {3.4748350087043743`*^9, 3.474835025927992*^9}, {
   3.474835058371855*^9, 3.474835063847795*^9}, {3.474835265726943*^9, 
   3.4748353000363407`*^9}, 3.474835418920562*^9, {3.474838582923246*^9, 
   3.4748385952338743`*^9}, {3.4748386548059263`*^9, 3.474838661620125*^9}, {
   3.4748388968928432`*^9, 3.474838897867242*^9}, {3.47483923878094*^9, 
   3.474839241767006*^9}, {3.474840201277958*^9, 3.4748402305181417`*^9}, {
   3.4748432716533318`*^9, 3.4748432889653*^9}, {3.474843387919674*^9, 
   3.474843402119424*^9}, {3.47484494015422*^9, 3.474844940526312*^9}, {
   3.4748459923473473`*^9, 3.4748460580093937`*^9}, {3.474846088669948*^9, 
   3.4748460899714203`*^9}, {3.4748461892181997`*^9, 3.474846230076136*^9}, {
   3.474846324698011*^9, 3.47484636010327*^9}, {3.4748466248809967`*^9, 
   3.474846626055395*^9}, 3.474846916074769*^9, {3.474900638575335*^9, 
   3.474900661762288*^9}, {3.474904190790888*^9, 3.474904192120387*^9}, 
   3.4749116456520643`*^9, {3.474912154374642*^9, 3.47491216970131*^9}, {
   3.4749122199807663`*^9, 3.474912266810473*^9}, {3.474912358556326*^9, 
   3.474912399725007*^9}, {3.474912455325802*^9, 3.4749124934271793`*^9}, {
   3.474912536299747*^9, 3.4749125768384523`*^9}, {3.474912653160448*^9, 
   3.474912676441296*^9}, {3.4749128072868643`*^9, 3.4749128144899693`*^9}, {
   3.47491318609902*^9, 3.4749132629039297`*^9}, {3.474982916575379*^9, 
   3.4749829170505943`*^9}, {3.4749837758429823`*^9, 3.474983798116303*^9}, {
   3.47498414826437*^9, 3.4749841717066193`*^9}, {3.47498459038485*^9, 
   3.474984608137754*^9}, {3.475243488301895*^9, 3.4752434937240963`*^9}, {
   3.4752435739846077`*^9, 3.475243673275271*^9}, {3.4752438615526114`*^9, 
   3.475243915108191*^9}, {3.475243956315042*^9, 3.4752440487945213`*^9}, {
   3.475248579825274*^9, 3.4752485917652407`*^9}, {3.4752492545735683`*^9, 
   3.475249261680023*^9}, {3.475249371293468*^9, 3.4752494070789833`*^9}, {
   3.475249526571052*^9, 3.475249551092218*^9}, {3.475249631921442*^9, 
   3.475249665804358*^9}, {3.475249850620387*^9, 3.475249852691701*^9}, {
   3.47525004097423*^9, 3.475250099020877*^9}, {3.4752513664795523`*^9, 
   3.475251403599496*^9}, {3.475251448511335*^9, 3.4752515519937267`*^9}, {
   3.4752528452321587`*^9, 3.475252867248548*^9}, {3.475253041679471*^9, 
   3.475253059212747*^9}, {3.4752531258636436`*^9, 3.475253159518654*^9}, 
   3.475254054878366*^9, {3.4752571002379007`*^9, 3.475257101542543*^9}, {
   3.475934725317745*^9, 3.475934761786261*^9}, {3.4759349482627687`*^9, 
   3.4759349512292213`*^9}, 3.475934991233272*^9, {3.476110060382842*^9, 
   3.476110062169532*^9}, {3.476110142128586*^9, 3.476110163089815*^9}, {
   3.476110197198204*^9, 3.4761102005008373`*^9}, {3.476789369283956*^9, 
   3.4767893699369793`*^9}, 3.476790322329145*^9, 3.476790872819742*^9, 
   3.4788580516974487`*^9, 3.4788591234422007`*^9, {3.478859212034972*^9, 
   3.478859222676783*^9}, {3.478859545492084*^9, 3.4788595738279133`*^9}, {
   3.478860449224229*^9, 3.478860495416041*^9}, {3.4788605262914667`*^9, 
   3.4788605535214643`*^9}, {3.478861911454693*^9, 3.47886191783746*^9}, {
   3.4788624906492157`*^9, 3.4788624971144447`*^9}, {3.478863853083764*^9, 
   3.478863910011999*^9}, {3.478864388552154*^9, 3.478864425618534*^9}, {
   3.478864864937639*^9, 3.4788649140476627`*^9}, {3.478865159766328*^9, 
   3.4788651799243593`*^9}, {3.478865445066306*^9, 3.47886545037072*^9}, {
   3.4788654930859222`*^9, 3.478865493455555*^9}, {3.478865670529985*^9, 
   3.478865677048472*^9}, {3.4788686090732193`*^9, 3.478868609439073*^9}, {
   3.478958938243019*^9, 3.478958963891468*^9}, {3.478958995642877*^9, 
   3.478959076941059*^9}, {3.478959144246002*^9, 3.478959312602067*^9}, {
   3.478959371418989*^9, 3.478959418187174*^9}, {3.478959562200657*^9, 
   3.4789595745250463`*^9}, {3.4789600821535597`*^9, 3.478960122921352*^9}, {
   3.47896180019007*^9, 3.478961800542119*^9}, {3.478962570243759*^9, 
   3.4789625916412363`*^9}, {3.4789629714189672`*^9, 
   3.4789630123224163`*^9}, {3.478964178923272*^9, 3.478964196746101*^9}, {
   3.481376400212455*^9, 3.481376409587666*^9}, {3.48137647343293*^9, 
   3.481376495643447*^9}, {3.48137656102127*^9, 3.48137656723452*^9}, {
   3.481995205469285*^9, 3.481995235671112*^9}, {3.481995382084601*^9, 
   3.4819954079329042`*^9}, {3.481995562295147*^9, 3.48199559490994*^9}, {
   3.4819963979565897`*^9, 3.481996399478312*^9}, 3.4820013624531727`*^9, {
   3.482001761941668*^9, 3.482001762809965*^9}, {3.4820019834467*^9, 
   3.482001989412456*^9}, {3.482002026997157*^9, 3.482002027962721*^9}, {
   3.482002679233342*^9, 3.4820027745722303`*^9}, {3.482002861197814*^9, 
   3.48200297828651*^9}, {3.4820030561016407`*^9, 3.482003080040675*^9}, {
   3.482003275048402*^9, 3.482003284098281*^9}, {3.4820036760404167`*^9, 
   3.482003737083713*^9}, 3.482004442928978*^9, {3.482004499234997*^9, 
   3.482004515518976*^9}, {3.482005069538789*^9, 3.482005069917718*^9}, 
   3.482053539491538*^9, 3.482053954432568*^9, {3.482054616143385*^9, 
   3.4820546325868483`*^9}, {3.48205506172147*^9, 3.482055062125147*^9}, {
   3.48205559423028*^9, 3.482055611890855*^9}, {3.4820557344771748`*^9, 
   3.4820557410621*^9}, {3.48205591929539*^9, 3.48205593192168*^9}, {
   3.482056104844632*^9, 3.482056109460587*^9}, {3.48205625206057*^9, 
   3.482056274106391*^9}, {3.4820563280559998`*^9, 3.482056332729516*^9}, {
   3.482056547038844*^9, 3.4820565525770273`*^9}, {3.4820567022457447`*^9, 
   3.482056713287594*^9}, {3.482056851307062*^9, 3.482056852959484*^9}, {
   3.482057166644533*^9, 3.482057193535784*^9}, {3.4820585958987513`*^9, 
   3.482058598474769*^9}, {3.4820586881300297`*^9, 3.4820586991395407`*^9}, {
   3.482059519129929*^9, 3.482059519943165*^9}, {3.482060006578115*^9, 
   3.482060009420657*^9}, {3.482060096307753*^9, 3.482060217244261*^9}, {
   3.482061346851297*^9, 3.482061372951256*^9}, {3.482061705268979*^9, 
   3.482061705670027*^9}, {3.4820620574933767`*^9, 3.482062098649539*^9}, {
   3.482062159245812*^9, 3.482062236840946*^9}, 3.482062304066443*^9, {
   3.4820631568068523`*^9, 3.482063159608307*^9}, {3.482063266813479*^9, 
   3.482063271666449*^9}, {3.482072896752018*^9, 3.482072905036538*^9}, {
   3.482073015780787*^9, 3.482073020808757*^9}, {3.482074208870267*^9, 
   3.4820742092626343`*^9}, 3.4820742690717697`*^9, {3.482074312411775*^9, 
   3.48207432639635*^9}, {3.48207443185176*^9, 3.482074434134227*^9}, {
   3.482074690617972*^9, 3.482074705325487*^9}, {3.482075181564375*^9, 
   3.482075229611026*^9}, {3.4820754354034147`*^9, 3.482075487524077*^9}, {
   3.482075858941029*^9, 3.4820758742252417`*^9}, {3.482076051164527*^9, 
   3.482076070605337*^9}, 3.4820764593070908`*^9, {3.482076617801578*^9, 
   3.4820766428390293`*^9}, {3.482077472599353*^9, 3.4820774784636383`*^9}, 
   3.482077772213181*^9, {3.482078023375804*^9, 3.482078052077441*^9}, {
   3.482078350886054*^9, 3.482078388314698*^9}, {3.482078665432076*^9, 
   3.482078665875422*^9}, {3.48208119433396*^9, 3.48208119712107*^9}, {
   3.4820814743067207`*^9, 3.482081513078002*^9}, {3.482081562595097*^9, 
   3.482081580038911*^9}, {3.4820816496782713`*^9, 3.482081655944916*^9}, {
   3.4820817762059927`*^9, 3.482081776975936*^9}, {3.482082116702401*^9, 
   3.482082119192787*^9}, {3.4820824323514957`*^9, 3.482082447506777*^9}, {
   3.482082687233412*^9, 3.482082708503223*^9}, {3.482082781343856*^9, 
   3.482082844032311*^9}, {3.482082930532824*^9, 3.482082931261142*^9}, {
   3.4820832308182573`*^9, 3.482083236980158*^9}, {3.4820840130730124`*^9, 
   3.482084077788703*^9}, 3.48250538090755*^9, {3.482678894428323*^9, 
   3.4826788950030518`*^9}, 3.482679034381587*^9, {3.4840344627398643`*^9, 
   3.484034478567691*^9}, {3.484034625153458*^9, 3.4840346285409393`*^9}, 
   3.484034746110301*^9, {3.4840347955569363`*^9, 3.4840347959034758`*^9}, {
   3.484034938698168*^9, 3.484034940521134*^9}, {3.484035433383507*^9, 
   3.4840354844158583`*^9}, {3.484035654749708*^9, 3.484035712118496*^9}, {
   3.484044146775126*^9, 3.48404432293687*^9}, {3.4840444080104103`*^9, 
   3.484044446813785*^9}, 3.484044563338269*^9, {3.484044737978335*^9, 
   3.484044742443613*^9}, {3.484045011259256*^9, 3.484045015982236*^9}, {
   3.48404520265862*^9, 3.484045207284519*^9}, {3.4841465056548853`*^9, 
   3.484146518364849*^9}, {3.484556291165372*^9, 3.484556347653344*^9}, {
   3.484556388406945*^9, 3.484556485919688*^9}, {3.484556726631946*^9, 
   3.484556747776082*^9}, {3.484556790924636*^9, 3.4845569013134813`*^9}, {
   3.484557026157064*^9, 3.484557041220298*^9}, {3.484557594280121*^9, 
   3.48455759906728*^9}, {3.484557747132936*^9, 3.484557777090987*^9}, 
   3.484558231033906*^9, {3.484562181868415*^9, 3.484562197964184*^9}, {
   3.484562599075364*^9, 3.48456260300174*^9}, {3.484562951610834*^9, 
   3.484562952736944*^9}, {3.484563081091675*^9, 3.484563085563448*^9}, {
   3.4845633661167107`*^9, 3.484563381608575*^9}, {3.484563713815156*^9, 
   3.484563736516095*^9}, {3.4845639335871487`*^9, 3.484563937780764*^9}, {
   3.4845676132851553`*^9, 3.484567614394412*^9}, {3.48456828498699*^9, 
   3.484568302507955*^9}, {3.4845691777845287`*^9, 3.484569189726091*^9}, {
   3.484569224255774*^9, 3.48456925201056*^9}, 3.484569670381461*^9, {
   3.4845736611422787`*^9, 3.484573664552718*^9}, {3.4845741398741083`*^9, 
   3.4845741653825417`*^9}, {3.484575162488771*^9, 3.48457522146106*^9}, {
   3.484577662988523*^9, 3.484577664312046*^9}, {3.48457787156295*^9, 
   3.484577903891118*^9}, {3.4846430541545467`*^9, 3.4846430605634117`*^9}, {
   3.484644162532878*^9, 3.4846441646505947`*^9}, {3.484644199083253*^9, 
   3.484644207219388*^9}, {3.484644909117631*^9, 3.484644959557906*^9}, {
   3.484645163709444*^9, 3.484645182653839*^9}, {3.484645318197987*^9, 
   3.484645333189794*^9}, {3.484647556436858*^9, 3.484647556879322*^9}, {
   3.4846478514223623`*^9, 3.48464785266295*^9}, {3.4846486011592093`*^9, 
   3.484648639115314*^9}, {3.484648685602106*^9, 3.484648703381586*^9}, {
   3.484650043483288*^9, 3.4846500494603367`*^9}, 3.4846505188955297`*^9, 
   3.484665852323876*^9, {3.485075177583116*^9, 3.485075177931226*^9}, {
   3.485080880535255*^9, 3.485080891860753*^9}, {3.4850809682970057`*^9, 
   3.4850810303092623`*^9}, 3.4850810951000013`*^9, {3.485081365311701*^9, 
   3.485081377545217*^9}, {3.485081667021047*^9, 3.485081727485197*^9}, {
   3.485082148846471*^9, 3.485082161373288*^9}, {3.4850822119645157`*^9, 
   3.485082214594295*^9}, {3.48508299866047*^9, 3.4850829990430527`*^9}, {
   3.485083034177775*^9, 3.485083051030703*^9}, {3.485083112602532*^9, 
   3.48508314708418*^9}, {3.4850833338699007`*^9, 3.4850833811323633`*^9}, {
   3.485083480506181*^9, 3.485083497252816*^9}, {3.485083647971964*^9, 
   3.485083648422514*^9}, {3.4850839343836813`*^9, 3.485083934832267*^9}, {
   3.485084438307804*^9, 3.485084534926119*^9}, {3.485084729509203*^9, 
   3.485084785137866*^9}, {3.485084819508943*^9, 3.4850848288189363`*^9}, {
   3.4850848651147833`*^9, 3.4850848739443407`*^9}, {3.485085384107073*^9, 
   3.48508551473717*^9}, {3.485089138967764*^9, 3.485089139390328*^9}, {
   3.485089271884939*^9, 3.485089306280356*^9}, {3.485089379594981*^9, 
   3.485089398767964*^9}, {3.485089451338756*^9, 3.485089467154755*^9}, {
   3.4850895749117727`*^9, 3.485089575607162*^9}, {3.4850897586025743`*^9, 
   3.4850897882782803`*^9}, {3.485090195469975*^9, 3.485090217908292*^9}, {
   3.48509179345582*^9, 3.485091795146085*^9}, {3.485092014992158*^9, 
   3.485092019514183*^9}, {3.4850922228910627`*^9, 3.4850922285678368`*^9}, {
   3.485092843099019*^9, 3.485092883571287*^9}, {3.485093099342527*^9, 
   3.4850931125256157`*^9}, {3.485093606248247*^9, 3.485093610147469*^9}, {
   3.4850941215967417`*^9, 3.485094122664916*^9}, {3.485094348022037*^9, 
   3.485094355448387*^9}, {3.485094674803693*^9, 3.485094718322652*^9}, {
   3.4850950153341208`*^9, 3.485095067699582*^9}, {3.485095430554193*^9, 
   3.485095437430868*^9}, {3.485096190455854*^9, 3.485096205752796*^9}, {
   3.485098617524336*^9, 3.485098617828413*^9}, {3.485098771034734*^9, 
   3.48509877135236*^9}, {3.485098897411894*^9, 3.4850988978175983`*^9}, {
   3.485099040821229*^9, 3.4850990573727083`*^9}, {3.485099353475832*^9, 
   3.485099355148185*^9}, {3.485099665089888*^9, 3.485099680888489*^9}, {
   3.48509971989008*^9, 3.4850997840105877`*^9}, {3.4851002319678183`*^9, 
   3.485100243037673*^9}, {3.485100762377182*^9, 3.485100765840461*^9}, {
   3.4851009418511744`*^9, 3.485100946359696*^9}, {3.485101084713047*^9, 
   3.485101123830329*^9}, {3.485101310017324*^9, 3.485101346120867*^9}, {
   3.485101858200992*^9, 3.4851018591484203`*^9}, {3.485101930509439*^9, 
   3.485102043489951*^9}, {3.485102280707054*^9, 3.485102307635075*^9}, {
   3.485102360303679*^9, 3.48510236085452*^9}, {3.485103175036351*^9, 
   3.485103252380924*^9}, {3.4851035703571577`*^9, 3.485103581952824*^9}, {
   3.48510379941466*^9, 3.485103846478236*^9}, {3.48510390940561*^9, 
   3.485103917765334*^9}, {3.4851040695187674`*^9, 3.485104079970331*^9}, {
   3.485104558779315*^9, 3.4851046047714577`*^9}, {3.485104858615329*^9, 
   3.485104881296411*^9}, {3.4851051355809317`*^9, 3.4851051561109333`*^9}, {
   3.485105209616015*^9, 3.485105210276353*^9}, {3.4851054360197287`*^9, 
   3.4851054593717833`*^9}, {3.485106069312561*^9, 3.485106082753064*^9}, {
   3.4851062185466127`*^9, 3.485106236402515*^9}, 3.485106509841197*^9, {
   3.485107087038237*^9, 3.485107087609571*^9}, {3.485107462497505*^9, 
   3.485107473862587*^9}, {3.485107829047168*^9, 3.4851079948869467`*^9}, {
   3.485111666575234*^9, 3.4851117395165873`*^9}, {3.485111801227295*^9, 
   3.485111806879034*^9}, {3.485112219604994*^9, 3.485112222729195*^9}, {
   3.4851148434268723`*^9, 3.4851148460572653`*^9}, {3.4851569469301443`*^9, 
   3.485156965163348*^9}, {3.485157102986854*^9, 3.485157107499503*^9}, {
   3.48515730963251*^9, 3.485157347010146*^9}, {3.485157404836162*^9, 
   3.485157456665063*^9}, {3.485157542678556*^9, 3.4851576020537233`*^9}, {
   3.4851602423802834`*^9, 3.485160283407221*^9}, {3.485160699224699*^9, 
   3.4851607238531227`*^9}, {3.4851636091897993`*^9, 
   3.4851636184618473`*^9}, {3.4851644110601797`*^9, 3.485164411580127*^9}, {
   3.485164522683784*^9, 3.485164615021537*^9}, {3.4851648465180817`*^9, 
   3.485164888329547*^9}, {3.4851649257028303`*^9, 3.4851649367769814`*^9}, {
   3.485165272021063*^9, 3.4851652759093533`*^9}, {3.485165422991086*^9, 
   3.485165515245364*^9}, {3.4851656107322083`*^9, 3.485165658961693*^9}, 
   3.4851664664384537`*^9, {3.485167452764913*^9, 3.4851674561962023`*^9}, {
   3.485167932393004*^9, 3.4851679521906424`*^9}, {3.485168057883112*^9, 
   3.4851680589492083`*^9}, 3.485168160797056*^9, {3.485169010742181*^9, 
   3.485169013230151*^9}, {3.4851690495365067`*^9, 3.485169070412148*^9}, {
   3.4851692467007027`*^9, 3.485169254939505*^9}, {3.485170725710032*^9, 
   3.485170858802442*^9}, {3.485171132110237*^9, 3.485171134407845*^9}, {
   3.485171483494856*^9, 3.485171504413615*^9}, {3.4851722334633923`*^9, 
   3.485172234190016*^9}, {3.4851725902638474`*^9, 3.485172673917953*^9}, 
   3.485172729643174*^9, {3.485172855182201*^9, 3.485172856343511*^9}, {
   3.485172953874587*^9, 3.485172954253621*^9}, {3.485176630260664*^9, 
   3.485176631346052*^9}, {3.485179233603405*^9, 3.485179272009062*^9}, {
   3.485179402158038*^9, 3.4851794050509377`*^9}, {3.485181050706747*^9, 
   3.4851811927743387`*^9}, {3.4851876568217916`*^9, 3.485187658014349*^9}, {
   3.4851877676760902`*^9, 3.4851878338088293`*^9}, {3.485187919253241*^9, 
   3.485187952125003*^9}, {3.48560977914718*^9, 3.485609944295171*^9}, {
   3.4856213760389767`*^9, 3.485621385136353*^9}, 3.4856240746601343`*^9, {
   3.4856241344637136`*^9, 3.485624175282722*^9}, {3.4856276072997723`*^9, 
   3.48562760764357*^9}, {3.485628429627266*^9, 3.48562843288999*^9}, {
   3.4856284662925243`*^9, 3.48562847307578*^9}, {3.485628608788682*^9, 
   3.48562861172053*^9}, 3.4856289657237663`*^9, {3.485629004100807*^9, 
   3.485629019204517*^9}, {3.485629329862629*^9, 3.4856293302373753`*^9}, {
   3.4856294755573807`*^9, 3.4856295280878363`*^9}, {3.485629619612011*^9, 
   3.485629656092407*^9}, {3.485767914387268*^9, 3.4857680358269053`*^9}, {
   3.4857699723697557`*^9, 3.485769999083275*^9}, {3.485771788574956*^9, 
   3.485771794713254*^9}, {3.485775997224085*^9, 3.485776022260741*^9}, {
   3.485776283542803*^9, 3.485776291387957*^9}, {3.4857813188671627`*^9, 
   3.485781326783313*^9}, {3.4857848059698*^9, 3.485784874211289*^9}, {
   3.48578589253913*^9, 3.485785925099731*^9}, {3.485788207711499*^9, 
   3.485788227872806*^9}, {3.485788607154533*^9, 3.48578870609477*^9}, 
   3.485796504597653*^9, {3.485796671658163*^9, 3.485796673174317*^9}, {
   3.485796720782509*^9, 3.485796736541883*^9}, 3.485796948410849*^9, {
   3.485849804193674*^9, 3.485849958268124*^9}, {3.485857782842093*^9, 
   3.4858578626580877`*^9}, {3.4858580256752663`*^9, 3.485858027293488*^9}, {
   3.4858580664393044`*^9, 3.485858075775453*^9}, {3.4858585176237183`*^9, 
   3.4858585278231153`*^9}, {3.485858716801462*^9, 3.4858587547444687`*^9}, {
   3.485858845662137*^9, 3.485858852823019*^9}, {3.485858884998446*^9, 
   3.485858885444557*^9}, {3.485867694347219*^9, 3.4858677430836563`*^9}, {
   3.485867824622684*^9, 3.485867856117584*^9}, 3.4858678904884167`*^9, {
   3.4858683252219343`*^9, 3.485868339388796*^9}, 3.485868474973134*^9, {
   3.4858685595227747`*^9, 3.485868580464164*^9}, {3.486151140115202*^9, 
   3.4861512561654987`*^9}, {3.486154123178678*^9, 3.486154148255458*^9}, {
   3.486154219096294*^9, 3.486154220097917*^9}, {3.4861546613061657`*^9, 
   3.4861546660794487`*^9}, {3.486154733212669*^9, 3.486154759574913*^9}, {
   3.486154844141432*^9, 3.486154846711134*^9}, {3.486155045354526*^9, 
   3.486155052173312*^9}, 3.486230448148635*^9, 3.486237849562389*^9, {
   3.4862884824001102`*^9, 3.4862884837697887`*^9}, 3.486366970522778*^9, 
   3.4863673592013617`*^9, {3.48636806252404*^9, 3.486368098125226*^9}, {
   3.486372211414822*^9, 3.486372218143098*^9}, {3.4863722556758833`*^9, 
   3.486372280302308*^9}, {3.4863723211119556`*^9, 3.486372398589181*^9}, {
   3.48637282008904*^9, 3.486372821709372*^9}, 3.4863734650494328`*^9, 
   3.486374112621428*^9, {3.487593295009568*^9, 3.487593295275382*^9}, {
   3.4876044450042467`*^9, 3.48760446748435*^9}, {3.487604512315735*^9, 
   3.487604512725425*^9}, {3.4876259260222473`*^9, 3.4876259841676607`*^9}, {
   3.487626150743766*^9, 3.4876261891814537`*^9}, {3.487627015807269*^9, 
   3.4876270349717417`*^9}, {3.487693013297449*^9, 3.487693014435628*^9}, 
   3.487693189947138*^9, {3.487693717792428*^9, 3.487693718444458*^9}, {
   3.488208512990321*^9, 3.4882085429622917`*^9}, {3.488222900900814*^9, 
   3.488222937255967*^9}, {3.4882231032191963`*^9, 3.488223136600232*^9}, {
   3.488636436280151*^9, 3.4886364473711367`*^9}, {3.488640868359849*^9, 
   3.488640967769936*^9}, {3.488643674367489*^9, 3.488643677970173*^9}, {
   3.4886452462535*^9, 3.488645360583786*^9}, {3.4886503467936687`*^9, 
   3.488650400542099*^9}, {3.488650865589806*^9, 3.4886509094273443`*^9}, {
   3.4886521660405197`*^9, 3.48865238758777*^9}, 3.488663090879282*^9, {
   3.488663596606152*^9, 3.488663723405923*^9}, {3.488663870100662*^9, 
   3.48866389967934*^9}, {3.488664337705922*^9, 3.488664346509481*^9}, {
   3.488705956336499*^9, 3.4887059694474916`*^9}, {3.488706024876845*^9, 
   3.4887060255752573`*^9}, {3.488706142505047*^9, 3.488706171962042*^9}, {
   3.488706211611446*^9, 3.488706213535058*^9}, {3.4887070100301847`*^9, 
   3.488707010959021*^9}, {3.4887072046004353`*^9, 3.488707205417818*^9}, {
   3.488707441913672*^9, 3.488707447628623*^9}, {3.488709764153923*^9, 
   3.48870986918736*^9}, {3.488709913244239*^9, 3.488709917852291*^9}, {
   3.488710027655861*^9, 3.488710134170055*^9}, {3.488710288105475*^9, 
   3.488710303240574*^9}, {3.4887103576636057`*^9, 3.48871035985599*^9}, 
   3.488711083067287*^9, {3.488711234530219*^9, 3.488711262427063*^9}, {
   3.4887113473446083`*^9, 3.488711354919795*^9}, {3.488711484735359*^9, 
   3.488711690267535*^9}, {3.488711768907234*^9, 3.488711775367728*^9}, {
   3.488712272420006*^9, 3.488712367116371*^9}, {3.4887124680465393`*^9, 
   3.4887124724253283`*^9}, {3.4887128540579243`*^9, 3.488712888892*^9}, {
   3.488713209762868*^9, 3.488713212940728*^9}, {3.488713484945442*^9, 
   3.4887134928887997`*^9}, {3.488713597855595*^9, 3.488713610069519*^9}, {
   3.488713674036813*^9, 3.488713674985539*^9}, {3.488713709589829*^9, 
   3.488713710088109*^9}, {3.4887142255894003`*^9, 3.488714255599066*^9}, {
   3.488714414204447*^9, 3.488714438215974*^9}, {3.488714503155539*^9, 
   3.4887145203042192`*^9}, {3.4887146131716423`*^9, 3.488714658509034*^9}, {
   3.488714712115554*^9, 3.488714731201281*^9}, {3.4887147674002647`*^9, 
   3.488714869573593*^9}, {3.488715003673805*^9, 3.488715004502865*^9}, {
   3.4887151201122017`*^9, 3.488715120597088*^9}, {3.4887152252802*^9, 
   3.48871525626512*^9}, {3.488715464139621*^9, 3.488715496619569*^9}, {
   3.488715536674836*^9, 3.488715563648941*^9}, {3.488715707357185*^9, 
   3.488715750215156*^9}, {3.488715891550682*^9, 3.488715918893928*^9}, {
   3.488715970726102*^9, 3.488716070475309*^9}, {3.4887164308068733`*^9, 
   3.4887165893766203`*^9}, 3.488718006511793*^9, {3.48871806512562*^9, 
   3.488718068944796*^9}, {3.488718141336776*^9, 3.488718142331641*^9}, {
   3.488718444835919*^9, 3.488718521878552*^9}, 3.488724803113453*^9, {
   3.4887250457561483`*^9, 3.488725100458262*^9}, {3.488725148011653*^9, 
   3.488725221799066*^9}, {3.4887265933847733`*^9, 3.488726605759398*^9}, {
   3.4887286124643297`*^9, 3.488728620941649*^9}, {3.4893180860893707`*^9, 
   3.4893181149443827`*^9}, {3.489318159345152*^9, 3.489318185119544*^9}, 
   3.489318661980893*^9, {3.4893186961555862`*^9, 3.489318702059495*^9}, {
   3.48931917637915*^9, 3.489319290368085*^9}, {3.489320334540677*^9, 
   3.489320439511037*^9}, {3.4893209535455713`*^9, 3.489320990475833*^9}, {
   3.4893210229872103`*^9, 3.4893210623502703`*^9}, {3.489321143714056*^9, 
   3.489321144221095*^9}, {3.489321203539399*^9, 3.489321277496747*^9}, 
   3.489490886212346*^9, {3.490631062317869*^9, 3.4906310702398252`*^9}, {
   3.490631128032954*^9, 3.49063113159689*^9}, {3.490631176414497*^9, 
   3.490631229073132*^9}, {3.4906314188371353`*^9, 3.4906314239673147`*^9}, {
   3.490965114116287*^9, 3.490965141675131*^9}, {3.490973248744647*^9, 
   3.490973284002946*^9}, 3.491061888560749*^9, {3.4910685466024637`*^9, 
   3.491068560445752*^9}, {3.491069263726543*^9, 3.491069285265176*^9}, {
   3.491069504889412*^9, 3.49106950836644*^9}, 3.491078188842301*^9, 
   3.491078227579965*^9, {3.4910783581818447`*^9, 3.491078365221621*^9}, {
   3.491078849331443*^9, 3.491078861211287*^9}, {3.491079296353484*^9, 
   3.4910793447840233`*^9}, {3.491141527521936*^9, 3.49114154693673*^9}, 
   3.4911427756931753`*^9, {3.491145157458702*^9, 3.4911451689389544`*^9}, {
   3.4911452632348337`*^9, 3.49114527773634*^9}, {3.491145323588703*^9, 
   3.491145347888987*^9}, {3.4911453847789392`*^9, 3.491145387477262*^9}, {
   3.491146041519248*^9, 3.491146070013114*^9}, {3.491146320742813*^9, 
   3.49114632547167*^9}, {3.491195478228703*^9, 3.491195499301673*^9}, {
   3.491196510945566*^9, 3.49119651588806*^9}, {3.491196547607752*^9, 
   3.491196566906672*^9}, {3.491202244177433*^9, 3.4912022901522713`*^9}, {
   3.491202327459979*^9, 3.491202412989355*^9}, {3.49120314637591*^9, 
   3.49120315972788*^9}, {3.491203744923215*^9, 3.491203763437975*^9}, {
   3.4912041942804403`*^9, 3.4912042057199287`*^9}, {3.492600296454463*^9, 
   3.4926003356317167`*^9}, {3.492600437320635*^9, 3.4926004396409187`*^9}, {
   3.4926005398013277`*^9, 3.492600691558092*^9}, {3.492600767452224*^9, 
   3.492600767880228*^9}, {3.4926008630271397`*^9, 3.49260086542013*^9}, {
   3.492600966554377*^9, 3.492600969025453*^9}, {3.492607640094837*^9, 
   3.4926076500840807`*^9}, {3.492614311265139*^9, 3.492614323013105*^9}, {
   3.492614784375761*^9, 3.492614832460823*^9}, {3.4926153452278547`*^9, 
   3.4926153596134567`*^9}, {3.4926226093017673`*^9, 3.492622613673235*^9}, {
   3.492622658056106*^9, 3.49262268600978*^9}, {3.492622794634444*^9, 
   3.492622806045313*^9}, {3.492622843978479*^9, 3.4926228444795437`*^9}, {
   3.49266680156316*^9, 3.492666802647853*^9}, {3.4926824356877537`*^9, 
   3.492682470706943*^9}, {3.492682554812812*^9, 3.4926825834302*^9}, {
   3.492682643680887*^9, 3.492682644977296*^9}, {3.492682832460734*^9, 
   3.4926828331321087`*^9}, {3.492682870689432*^9, 3.492682871569728*^9}, {
   3.492683464329142*^9, 3.4926834649580812`*^9}, {3.4926840106720943`*^9, 
   3.4926840195734262`*^9}, {3.492684625609283*^9, 3.492684661700976*^9}, {
   3.4926846921612186`*^9, 3.49268469336101*^9}, {3.492685057057747*^9, 
   3.492685072235392*^9}, 3.492685114310802*^9, {3.492685150457448*^9, 
   3.492685155525599*^9}, {3.492685334785144*^9, 3.492685342913402*^9}, {
   3.492685393816493*^9, 3.492685469101265*^9}, {3.4926855261693077`*^9, 
   3.4926855316988153`*^9}, {3.492685563995481*^9, 3.492685613645006*^9}, 
   3.492686273894824*^9, {3.492686554801071*^9, 3.492686595198*^9}, {
   3.492686642937643*^9, 3.492686650397174*^9}, {3.49268686278299*^9, 
   3.492686869102035*^9}, {3.492687176057555*^9, 3.492687194882456*^9}, {
   3.492687231881488*^9, 3.492687288182542*^9}, {3.492687541864275*^9, 
   3.492687553608096*^9}, {3.492687596127212*^9, 3.492687602528515*^9}, {
   3.492687786988003*^9, 3.492687798885734*^9}, {3.492688156363503*^9, 
   3.492688158957163*^9}, {3.4926901200736732`*^9, 3.4926901390731583`*^9}, {
   3.492690213158399*^9, 3.4926902164856443`*^9}, {3.492690350480083*^9, 
   3.49269036448965*^9}, {3.492690480828909*^9, 3.4926905369931793`*^9}, {
   3.4926915415493193`*^9, 3.4926915480285482`*^9}, 3.492691652667906*^9, {
   3.492694023302746*^9, 3.492694025001575*^9}, {3.492695106795021*^9, 
   3.4926951142823477`*^9}, {3.492696657561914*^9, 3.492696661310408*^9}, {
   3.492768607084145*^9, 3.492768607580881*^9}, 3.492768665197715*^9, {
   3.492768770588511*^9, 3.492768789946995*^9}, {3.492768827905898*^9, 
   3.492768829209404*^9}, 3.4927691633771887`*^9, 3.492769516806184*^9, 
   3.492769716222753*^9, {3.492769854905525*^9, 3.492769875848699*^9}, {
   3.492771601345826*^9, 3.492771606398518*^9}, {3.4927716417386208`*^9, 
   3.492771667157699*^9}, {3.492771739260179*^9, 3.492771815563631*^9}, 
   3.492773137057028*^9, {3.4927756900303802`*^9, 3.49277570168887*^9}, {
   3.492775743176278*^9, 3.4927757649785833`*^9}, {3.492775916214979*^9, 
   3.492775925729295*^9}, {3.4927759564375257`*^9, 3.4927760637834463`*^9}, {
   3.492776094565269*^9, 3.492776118932631*^9}, {3.492776243405045*^9, 
   3.492776247432438*^9}, {3.4927764295296183`*^9, 3.492776528511862*^9}, {
   3.492776568063846*^9, 3.492776571260501*^9}, {3.4927768074039087`*^9, 
   3.492776854951552*^9}, {3.49277693394629*^9, 3.492776938208877*^9}, {
   3.4927772531122847`*^9, 3.492777312154016*^9}, {3.4927773440286922`*^9, 
   3.492777373327183*^9}, {3.49277955167174*^9, 3.4927795623356447`*^9}, 
   3.4927803408349257`*^9, {3.492780382662353*^9, 3.492780442519106*^9}, {
   3.492780619784601*^9, 3.492780629606675*^9}, {3.492780676057548*^9, 
   3.492780676988009*^9}, {3.492780849348134*^9, 3.492780883350327*^9}, {
   3.492781080805278*^9, 3.492781082717313*^9}, {3.492783084884117*^9, 
   3.492783105521678*^9}, {3.4927831570572987`*^9, 3.492783202838048*^9}, 
   3.4927832490332317`*^9, {3.49278423648519*^9, 3.492784287303915*^9}, {
   3.492784636243293*^9, 3.492784655039839*^9}, {3.49278468509734*^9, 
   3.492784702303134*^9}, 3.492785599844644*^9, {3.492785635377241*^9, 
   3.492785646602935*^9}, {3.4927905883619947`*^9, 3.492790598983781*^9}, {
   3.492796422877948*^9, 3.49279643210255*^9}, {3.492796485404624*^9, 
   3.492796501282238*^9}, 3.4928391460825768`*^9, {3.492842959353115*^9, 
   3.492842959898775*^9}, {3.492863230354752*^9, 3.492863242012916*^9}, 
   3.492867658438109*^9, {3.492867697306644*^9, 3.492867700766255*^9}, {
   3.492867823228013*^9, 3.49286788056898*^9}, {3.492867924117716*^9, 
   3.49286794624755*^9}, {3.4928688748168592`*^9, 3.4928688781190977`*^9}, {
   3.49286891599291*^9, 3.492868952654181*^9}, {3.492869060619218*^9, 
   3.49286906166031*^9}, {3.492869104173051*^9, 3.4928691082623863`*^9}, {
   3.4928691518791523`*^9, 3.492869223529049*^9}, 3.492869318158161*^9, {
   3.49286945158563*^9, 3.4928694538280687`*^9}, {3.492869506929791*^9, 
   3.492869545038207*^9}, {3.4928695823664503`*^9, 3.492869644033751*^9}, {
   3.4928697747664747`*^9, 3.492869795173946*^9}, {3.4928700563642483`*^9, 
   3.4928700794911327`*^9}, {3.492870364244096*^9, 3.492870435019586*^9}, {
   3.492870526266675*^9, 3.492870558198798*^9}, {3.492870733096549*^9, 
   3.492870810988614*^9}, {3.49287092251756*^9, 3.492870964336063*^9}, 
   3.492872884544229*^9, {3.492875309117053*^9, 3.492875325452039*^9}, 
   3.492875359154749*^9, 3.492876363841486*^9, {3.492877598423025*^9, 
   3.492877611974444*^9}, 3.492878529449465*^9, {3.4928786271503983`*^9, 
   3.492878693907058*^9}, {3.492929739116081*^9, 3.492929767895862*^9}, {
   3.492930061758974*^9, 3.492930075122587*^9}, {3.4929430579903927`*^9, 
   3.492943060435511*^9}, 3.492943207609074*^9, 3.492943463492289*^9, {
   3.492943520985265*^9, 3.49294359246343*^9}, {3.49302809031854*^9, 
   3.493028091290842*^9}, {3.4930397211845083`*^9, 3.493039731534693*^9}, 
   3.493040461643228*^9, {3.493043588581905*^9, 3.493043613546805*^9}, {
   3.4930485784618483`*^9, 3.493048682764091*^9}, {3.493048738016059*^9, 
   3.493048779871379*^9}, {3.493048844841379*^9, 3.493048870446969*^9}, {
   3.49304891086532*^9, 3.493048913256537*^9}, {3.493048948941145*^9, 
   3.4930490124027863`*^9}, {3.493049129962283*^9, 3.4930491876928263`*^9}, {
   3.49304930796056*^9, 3.493049312792856*^9}, {3.493055370683086*^9, 
   3.493055371240301*^9}, {3.4930554699807158`*^9, 3.493055470733429*^9}, {
   3.493055599401247*^9, 3.493055606375503*^9}, {3.493057428710888*^9, 
   3.4930574624721107`*^9}, {3.493058510079069*^9, 3.49305853246143*^9}, {
   3.49305869660856*^9, 3.4930587362596188`*^9}, {3.493058812017942*^9, 
   3.4930588226682253`*^9}, {3.493102973410383*^9, 3.493102987267408*^9}, {
   3.4931032623931007`*^9, 3.493103263435854*^9}, 3.493104892036117*^9, {
   3.493105504856832*^9, 3.4931055129083*^9}, {3.493107398587442*^9, 
   3.493107400232192*^9}, {3.493114446715239*^9, 3.493114450445819*^9}, 
   3.4931150737543993`*^9, {3.493404435363304*^9, 3.49340447852046*^9}, {
   3.4934079606750298`*^9, 3.4934080596298018`*^9}, {3.493408356424055*^9, 
   3.493408361249977*^9}, {3.49340842105241*^9, 3.4934084534463377`*^9}, 
   3.4934085548995333`*^9, {3.493408829251697*^9, 3.493408856119028*^9}, {
   3.4934088920739803`*^9, 3.493408893642931*^9}, 3.493408997896574*^9, {
   3.493409049663501*^9, 3.4934090514174147`*^9}, 3.493410696194714*^9, {
   3.493410735689835*^9, 3.493410757889183*^9}, {3.49345143920262*^9, 
   3.493451484444573*^9}, {3.4934533411253*^9, 3.493453341719798*^9}, {
   3.4934554385274067`*^9, 3.4934554430686817`*^9}, {3.4934555647802563`*^9, 
   3.493455568980042*^9}, {3.4934557991408043`*^9, 3.49345582062461*^9}, {
   3.493456673671989*^9, 3.493456699914362*^9}, {3.493457354355866*^9, 
   3.493457354979892*^9}, {3.493457556049016*^9, 3.493457565015603*^9}, {
   3.493458593554031*^9, 3.493458673259016*^9}, {3.4934600671156273`*^9, 
   3.49346013143432*^9}, {3.4934642103852863`*^9, 3.493464227274111*^9}, {
   3.4934643589724617`*^9, 3.493464371729484*^9}, {3.49346454925264*^9, 
   3.493464558835832*^9}, 3.4934646347121553`*^9, 3.493465192925439*^9, {
   3.493465837377926*^9, 3.4934659236942787`*^9}, 3.493470592975561*^9, {
   3.493471935159275*^9, 3.49347194013548*^9}, {3.4934726028584223`*^9, 
   3.493472617495303*^9}, 3.493473602239038*^9, {3.4934742418276033`*^9, 
   3.4934742429190187`*^9}, {3.493475114113572*^9, 3.4934751447601624`*^9}, {
   3.4934819123927402`*^9, 3.4934819324318533`*^9}, 3.493482406726375*^9, 
   3.493482790495267*^9, 3.4934829473306828`*^9, 3.493483232907957*^9, {
   3.493485190046723*^9, 3.4934852513156967`*^9}, {3.493531231643577*^9, 
   3.493531263747016*^9}, {3.4935317832216253`*^9, 3.493531799207161*^9}, {
   3.493531840973958*^9, 3.493531851156579*^9}, {3.493532116659258*^9, 
   3.493532148873599*^9}, {3.493532891753971*^9, 3.4935328954005117`*^9}, {
   3.493532928286323*^9, 3.493532960229257*^9}, {3.4935336421528997`*^9, 
   3.493533761495843*^9}, {3.493533854309444*^9, 3.493533895702737*^9}, {
   3.49353393382026*^9, 3.493534007693686*^9}, {3.4935340420966043`*^9, 
   3.493534089820221*^9}, {3.493534440164538*^9, 3.493534485834147*^9}, {
   3.4935347548017597`*^9, 3.4935348096653757`*^9}, {3.493534993914765*^9, 
   3.493534995121441*^9}, {3.4935397988924437`*^9, 3.493539803507843*^9}, {
   3.493539854827724*^9, 3.493539880679368*^9}, {3.493541463845211*^9, 
   3.4935414894031277`*^9}, {3.4935415353980293`*^9, 3.4935416274507837`*^9}, 
   3.493717604907736*^9, {3.4937176455705748`*^9, 3.4937176528329477`*^9}, {
   3.493987439647873*^9, 3.493987491816461*^9}, {3.4939877879108343`*^9, 
   3.4939877965707693`*^9}, 3.4939881307837133`*^9, 3.4939907817675323`*^9, {
   3.494004537244191*^9, 3.49400458214823*^9}, {3.4940046718767014`*^9, 
   3.494004672532568*^9}, {3.494053802706086*^9, 3.494053812050311*^9}, 
   3.494062829119602*^9, {3.494063273260303*^9, 3.494063291903563*^9}, 
   3.4940634586352177`*^9, {3.494063635438521*^9, 3.494063657294438*^9}, 
   3.494063787842778*^9, {3.49407007095962*^9, 3.4940700898537273`*^9}, {
   3.4940701226436853`*^9, 3.494070147635631*^9}, {3.494070275268165*^9, 
   3.494070331860983*^9}, {3.494071164255279*^9, 3.4940711704319057`*^9}, {
   3.494143780590287*^9, 3.494143843304182*^9}, {3.494155377323821*^9, 
   3.49415542286051*^9}, {3.494158676116858*^9, 3.49415868648155*^9}, {
   3.494160517190523*^9, 3.494160534879058*^9}, 3.494178195139841*^9, {
   3.4941784728274183`*^9, 3.4941784737783117`*^9}, 3.494179853898612*^9, {
   3.4942285841014357`*^9, 3.494228609718412*^9}, {3.494228699995329*^9, 
   3.4942287429831343`*^9}, 3.494228976015623*^9, {3.494229472972897*^9, 
   3.4942296017935457`*^9}, {3.494229717194906*^9, 3.4942297925424232`*^9}, {
   3.4942298298779383`*^9, 3.494229836981654*^9}, {3.4942306812631483`*^9, 
   3.49423069186825*^9}, {3.494232557756201*^9, 3.49423256033615*^9}, {
   3.4942326127589827`*^9, 3.4942326181283073`*^9}, {3.494234125963059*^9, 
   3.49423412904834*^9}, {3.494234279516067*^9, 3.49423428436908*^9}, {
   3.494254886932908*^9, 3.49425489302324*^9}, {3.494254937191203*^9, 
   3.494254954669075*^9}, {3.494254984879397*^9, 3.4942550137159777`*^9}, {
   3.4942577265841227`*^9, 3.4942577282720413`*^9}, {3.494258834869458*^9, 
   3.494258897036478*^9}, {3.494259306504282*^9, 3.494259308481708*^9}, {
   3.4942656207623987`*^9, 3.494265647767536*^9}, {3.494265677848269*^9, 
   3.494265741178903*^9}, {3.49431955027448*^9, 3.494319633278645*^9}, {
   3.494319679428341*^9, 3.494319716058935*^9}, {3.494319810676862*^9, 
   3.494319823603529*^9}, {3.49432691220009*^9, 3.494326918750923*^9}, {
   3.494330123208119*^9, 3.4943301275152893`*^9}, {3.494330180521715*^9, 
   3.4943301811336613`*^9}, 3.494330384283414*^9, {3.494333974157214*^9, 
   3.494333984756858*^9}, {3.494346782797804*^9, 3.4943468123544607`*^9}, {
   3.494346891455927*^9, 3.4943469046725483`*^9}, {3.494346946167527*^9, 
   3.4943469756443243`*^9}, {3.4943480747829647`*^9, 3.494348101696504*^9}, {
   3.4943481771932917`*^9, 3.494348205923896*^9}, {3.494348240913611*^9, 
   3.494348250518456*^9}, {3.494395766980555*^9, 3.494395787056896*^9}, {
   3.494396342579029*^9, 3.494396343795787*^9}, {3.49439684947167*^9, 
   3.494396929134563*^9}, {3.4943970364214087`*^9, 3.494397057087698*^9}, {
   3.494397292255053*^9, 3.494397350699938*^9}, {3.4943978165661583`*^9, 
   3.494397906523282*^9}, {3.494398374179762*^9, 3.494398399937908*^9}, {
   3.494398470244705*^9, 3.494398515332163*^9}, {3.494398757233533*^9, 
   3.494398786173175*^9}, 3.4943990459889193`*^9, {3.494399242359271*^9, 
   3.494399288834612*^9}, {3.4943995415470448`*^9, 3.494399640632349*^9}, {
   3.494399815801828*^9, 3.494399848832299*^9}, {3.49440549236173*^9, 
   3.494405495698897*^9}, {3.494405544071969*^9, 3.494405574864064*^9}, {
   3.4944056111946487`*^9, 3.494405650728437*^9}, 3.494407900022808*^9, 
   3.4944080257643423`*^9, {3.494414301745669*^9, 3.4944143092767897`*^9}, {
   3.494414678072021*^9, 3.494414679168908*^9}, {3.494415801318825*^9, 
   3.494415801953321*^9}, 3.4944158332633953`*^9, {3.4947699522278423`*^9, 
   3.494769969995501*^9}, 3.494770082305208*^9, {3.4947754456376343`*^9, 
   3.494775450939876*^9}, 3.4947766360559196`*^9, {3.497092270711179*^9, 
   3.4970922807482777`*^9}, 3.4970923167469587`*^9, {3.5002157900919952`*^9, 
   3.50021583425725*^9}, {3.500215910511313*^9, 3.500215913299076*^9}, {
   3.503169808445047*^9, 3.503169820558276*^9}, {3.503169879578348*^9, 
   3.503169884511294*^9}, {3.503404299067626*^9, 3.503404375207176*^9}, 
   3.5034937431373262`*^9, 3.503494631315127*^9, 3.503665478950337*^9, 
   3.503666329424252*^9, {3.5036663744041348`*^9, 3.5036663750498447`*^9}, {
   3.5039263627814693`*^9, 3.503926421999509*^9}, {3.503927756231186*^9, 
   3.503927758114253*^9}, {3.50512233605683*^9, 3.505122340033733*^9}, {
   3.5087648617440042`*^9, 3.508764883285351*^9}, {3.508764991763646*^9, 
   3.508764998023429*^9}, {3.508765481185337*^9, 3.508765610306262*^9}, {
   3.508765788328998*^9, 3.508765794896699*^9}, {3.508765845110778*^9, 
   3.50876600270959*^9}, {3.508767211899139*^9, 3.508767224150098*^9}, {
   3.508790100634947*^9, 3.50879010125753*^9}, {3.508847427292983*^9, 
   3.508847429640213*^9}, 3.508850230339621*^9, {3.509784846626493*^9, 
   3.509784850622736*^9}, {3.509785786667069*^9, 3.509785790891963*^9}, {
   3.510653422448758*^9, 3.510653432952054*^9}, {3.511531666558548*^9, 
   3.511531703947124*^9}, {3.5115319897458057`*^9, 3.511531990682023*^9}, {
   3.511534249377757*^9, 3.5115343441935596`*^9}, {3.511600125003972*^9, 
   3.5116001475736713`*^9}, {3.512062945952715*^9, 3.51206299282969*^9}, {
   3.52242423080998*^9, 3.5224242355469227`*^9}, {3.525594547401723*^9, 
   3.525594558423216*^9}, {3.528531897801401*^9, 3.5285318995592823`*^9}, {
   3.5285320020210037`*^9, 3.528532003794833*^9}, {3.528532036359158*^9, 
   3.528532056920216*^9}, {3.528532090305249*^9, 3.52853211649748*^9}, {
   3.528533140057126*^9, 3.5285331509814167`*^9}, 3.528533226691703*^9, 
   3.528533352984799*^9, {3.5285352916738453`*^9, 3.528535318663793*^9}, {
   3.5285364279302607`*^9, 3.528536438872265*^9}, {3.52854990785713*^9, 
   3.528549916397029*^9}, {3.532867501124001*^9, 3.53286752253491*^9}, {
   3.532958115111717*^9, 3.5329581296415167`*^9}, {3.532958176758278*^9, 
   3.532958288377832*^9}, {3.532958572898919*^9, 3.5329585849628563`*^9}, {
   3.532958700633564*^9, 3.53295870601679*^9}, {3.532958788360351*^9, 
   3.532958813618492*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"timescaleanalysis", "\[Equal]", "1"}], "&&", 
     RowBox[{"npartsoutput", "\[Equal]", "3"}]}], ",", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"writeuproot", "~~", "titleshort", "~~", "\"\<.tex\>\""}], ",", 
       RowBox[{"Flatten", "[", "texall", "]"}], ",", "\"\<Text\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"writeuproot", "~~", "titleshort", "~~", "\"\<_inc.tex\>\""}],
         ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<\\n\\n\\\\clearpage\\n\\n\\\\subsection{\>\"", "~~", 
              RowBox[{"ensembles", "[", 
               RowBox[{"[", "e", "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
              RowBox[{"ensemoutnames", "[", 
               RowBox[{"[", "e", "]"}], "]"}], "~~", "\"\<}\\n\\n\\n\>\""}], 
             ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"texinc", "[", 
                RowBox[{"[", 
                 RowBox[{"e", ",", "i", ",", "p"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "nplotvars"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"p", ">", "ndroptabvars"}], ",", "1", ",", "3"}], 
                  "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}], "]"}], ",", 
        "\"\<Text\>\""}], "]"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"writeuproot", "~~", 
          RowBox[{
           RowBox[{"textitles", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.tex\>\""}]}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"texinc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<Text\>\""}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "texinc", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "writeuproot", "~~", "titleshort", "~~", "\"\<_inc_Appendix.tex\>\""}],
        ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"texinc", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"Length", "[", "texinc", "]"}]}], ",", "\"\<\>\"", 
              ",", "\"\<\\n\\n\\\\clearpage\\n\\n\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "texinc", "]"}]}], "}"}]}], "]"}], "]"}], 
       ",", "\"\<Text\>\""}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"finalresults", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetDirectory", "[", "runtimeroot", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"\"\<finalresultscopy_\>\"", "~~", "date2"}], ",", 
       "copyfinalresultsscript", ",", "\"\<Text\>\""}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<finished processing: \>\"", ",", 
    RowBox[{"Date", "[", "]"}], ",", "\"\<\\ntime elapsed: \>\"", ",", 
    RowBox[{"DateDifference", "[", 
     RowBox[{"starttime", ",", 
      RowBox[{"Date", "[", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Day\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", 
        "\"\<Second\>\""}], "}"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.474750658580326*^9, 3.4747506752236633`*^9}, {
   3.474750712215263*^9, 3.47475072326036*^9}, {3.474750778072465*^9, 
   3.4747507936579123`*^9}, {3.47481716219151*^9, 3.474817175998815*^9}, {
   3.4748180553770733`*^9, 3.474818057221656*^9}, 3.4748184493452463`*^9, {
   3.474819689753296*^9, 3.47481970524605*^9}, 3.474819863891346*^9, {
   3.474820237864574*^9, 3.4748202467990026`*^9}, {3.4748258238485003`*^9, 
   3.474825828835063*^9}, 3.47491269912507*^9, {3.475244068228581*^9, 
   3.47524408442244*^9}, {3.47895944427534*^9, 3.478959466095294*^9}, {
   3.478959532845785*^9, 3.478959534541615*^9}, {3.4789595891021423`*^9, 
   3.478959605491572*^9}, 3.481995424019299*^9, {3.4820749489462748`*^9, 
   3.4820749500052767`*^9}, {3.482075505412878*^9, 3.482075507435965*^9}, {
   3.482075660986598*^9, 3.482075691539404*^9}, {3.482078402037239*^9, 
   3.4820784121866627`*^9}, {3.482081598908955*^9, 3.4820816281613407`*^9}, {
   3.482507610257531*^9, 3.48250762002378*^9}, {3.482679046207726*^9, 
   3.482679082800033*^9}, 3.484561229127676*^9, {3.484561260898798*^9, 
   3.484561264726224*^9}, 3.485609328496455*^9, 3.485628720689046*^9, {
   3.48931832581975*^9, 3.489318328890786*^9}, {3.492777419123004*^9, 
   3.4927774436997423`*^9}, {3.49277749500836*^9, 3.4927776180834846`*^9}, {
   3.492877204170857*^9, 3.492877255046432*^9}, 3.493048492161491*^9, {
   3.494408239865744*^9, 3.494408278400947*^9}, {3.494408340285935*^9, 
   3.4944083558980703`*^9}, {3.4944147007788687`*^9, 3.494414704274495*^9}, {
   3.5118680017471867`*^9, 3.5118680338056297`*^9}, {3.528529245389821*^9, 
   3.5285292566065083`*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"timescaleanalysis", "\[Equal]", "1"}], "&&", 
     RowBox[{"npartsoutput", "\[Equal]", "3"}]}], ",", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
      "writeuproot", "~~", "titleshort", "~~", "\"\<_inc_Appendix.tex\>\""}], 
      ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"texinc", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "==", "1"}], "||", 
              RowBox[{"i", "==", "2"}], "||", 
              RowBox[{"i", "==", 
               RowBox[{
                RowBox[{"ndroptabvars", "*", 
                 RowBox[{"(", 
                  RowBox[{"ndrop", "+", "1"}], ")"}]}], "+", "1"}]}]}], ",", 
             "\"\<\\n\\n\\\\clearpage\\n\\n\>\"", ",", "\"\<\>\""}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "texinc", "]"}]}], "}"}]}], "]"}], "]"}], 
      ",", "\"\<Text\>\""}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.511868042570965*^9, 3.511868047653902*^9}, {
  3.51186809808324*^9, 3.5118681097015247`*^9}, {3.5118683825129557`*^9, 
  3.5118684145675077`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Interactive Plotting:",
 FontSlant->"Italic"]], "Section",
 CellChangeTimes->{{3.400066391859375*^9, 3.40006644521875*^9}, {
  3.40006649821875*^9, 3.400066566703125*^9}, {3.437727312162577*^9, 
  3.437727319537369*^9}, {3.437743770863562*^9, 3.437743773982688*^9}, {
  3.4591009237956257`*^9, 3.45910092540738*^9}, {3.462023391733471*^9, 
  3.462023397846716*^9}, {3.4620293719611263`*^9, 3.4620293751829033`*^9}, {
  3.462195015242916*^9, 3.462195020368514*^9}}],

Cell[CellGroupData[{

Cell["a. Set-Up", "Subsubtitle",
 CellChangeTimes->{{3.463394844190172*^9, 3.463394849523423*^9}, {
  3.471704558203054*^9, 3.471704558490778*^9}, {3.474904597020994*^9, 
  3.474904597732745*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data5", "=", 
   RowBox[{"controls", "=", 
    RowBox[{"nrunss", "=", 
     RowBox[{"minimas", "=", 
      RowBox[{"maximas", "=", 
       RowBox[{"startvaluess", "=", 
        RowBox[{"Table", "[", 
         RowBox[{",", 
          RowBox[{"{", "nensem", "}"}], ",", 
          RowBox[{"{", "nparts", "}"}]}], "]"}]}]}]}]}]}]}], ";", 
  RowBox[{"newlegends", "=", 
   RowBox[{"ensemblenoss", "=", 
    RowBox[{"nstyless", "=", 
     RowBox[{"varstyless", "=", 
      RowBox[{"nos2s", "=", 
       RowBox[{"nlegsecss", "=", 
        RowBox[{"legdisplaynoss", "=", 
         RowBox[{"graphics2s", "=", 
          RowBox[{"Table", "[", 
           RowBox[{",", 
            RowBox[{"{", "nensem", "}"}], ",", 
            RowBox[{"{", "nparts", "}"}]}], "]"}]}]}]}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timescaledatas", "=", 
   RowBox[{"timescaledata2s", "=", 
    RowBox[{"Table", "[", 
     RowBox[{",", 
      RowBox[{"{", "nensem", "}"}], ",", 
      RowBox[{"{", "nparts", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "alpha", "=", 
   "\"\<abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+-\>\""}\
], ";"}]}], "Input",
 CellChangeTimes->{{3.46218778129394*^9, 3.462187781553171*^9}, 
   3.462187815429064*^9, {3.46218786525042*^9, 3.462187872327986*^9}, {
   3.462187904118902*^9, 3.4621879301260557`*^9}, {3.4621950885194387`*^9, 
   3.46219508973197*^9}, {3.462196149800994*^9, 3.462196149999518*^9}, {
   3.462196214212665*^9, 3.462196238504396*^9}, {3.4621962785350733`*^9, 
   3.4621962919736757`*^9}, {3.462196561588167*^9, 3.462196576912726*^9}, {
   3.4621966459971*^9, 3.462196659390794*^9}, {3.462196745941888*^9, 
   3.462196748109638*^9}, {3.462197126376051*^9, 3.4621971268033237`*^9}, {
   3.462197503782003*^9, 3.462197571135285*^9}, {3.462197717982216*^9, 
   3.462197777736931*^9}, {3.46219845831388*^9, 3.462198473804862*^9}, {
   3.462199411073986*^9, 3.462199415175778*^9}, 3.462201063200994*^9, {
   3.4626137723911657`*^9, 3.462613776406128*^9}, 3.462613978651149*^9, {
   3.4626143724919863`*^9, 3.4626143756177273`*^9}, {3.462614502345612*^9, 
   3.4626145080321903`*^9}, {3.462614538333659*^9, 3.462614559852174*^9}, {
   3.4626148054204893`*^9, 3.462614826943842*^9}, {3.4626150124835*^9, 
   3.462615051631815*^9}, {3.462615161912002*^9, 3.462615163524481*^9}, {
   3.462615312301038*^9, 3.462615316074417*^9}, {3.462617397098756*^9, 
   3.46261739722866*^9}, {3.462627667505103*^9, 3.462627680393527*^9}, {
   3.462630030136299*^9, 3.46263004403585*^9}, {3.463394221340835*^9, 
   3.4633942344781837`*^9}, {3.463394350408351*^9, 3.463394350597464*^9}, {
   3.463396319657435*^9, 3.463396320140368*^9}, 3.469369677493477*^9, 
   3.471696428688696*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ensemblename", "=", 
      RowBox[{"ensembleroot", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemshort", "=", 
      RowBox[{"ensemblerootshort", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembledatafile", "=", 
      RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"config", "=", 
      RowBox[{"configs", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"configshort", "=", 
      RowBox[{"configshorts", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\\nReading in data for \>\"", ",", "ensemblename", ",", 
       "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"resultsfolder", "=", 
      RowBox[{
      "resultsfoldersuffix", "~~", "titleshort", "~~", "\"\<_\>\"", "~~", 
       "ensemblename"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "[", "resultsfolder", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Part : \>\"", ",", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}], ",", "\"\<...\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotstartyear", "=", 
         RowBox[{"plotstartyears", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nyears", "=", 
         RowBox[{"nyearss", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Part", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "configroot", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", "ensembledatafile", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tagmarkervariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
              "\[Equal]", "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"tagmarkervariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"origtagmarkervariables", "=", "tagmarkervariables"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tagmarkervariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nvar", "=", 
         RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vartitles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vartitlesshort", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"varvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"2", "+", "j"}]}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "2"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"varvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "1"}], ",", 
          RowBox[{"control", "=", "1"}], ",", 
          RowBox[{"control", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"controls", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "control"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nruns", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"nvars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrunss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nruns"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prod1", "=", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prod2", "=", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"prod3", "=", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"varstyles", "=", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"prod2", "<=", "prod3"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"varstyles", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "]"}], ";", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"varstyles", ",", 
                RowBox[{"{", "4", "}"}]}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"varstyles", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], ";", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"varstyles", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}]}], "]"}], ";"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"varstyles", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"varstyless", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "varstyles"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemtitles", "=", 
         RowBox[{"Tuples", "[", "varvalues", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ensemblevariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "individual"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"ensemblevariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenos", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nvar"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ensemblenoss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "ensemblenos"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"ensemblenos", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"ensemblenos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Part", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nruns", "\[Equal]", "1"}], ",", 
          RowBox[{"runids", "=", 
           RowBox[{"{", "configshort", "}"}]}], ",", 
          RowBox[{
           RowBox[{"runids", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
              "configshort", "~~", "\"\<.\>\"", "~~", "ensemshort", "~~", 
               "\"\<_\>\"", "~~", 
               RowBox[{"ensemblenames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", "f", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<runids//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"runids", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nfilenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "nmodules", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Length", "[", 
             RowBox[{"filenamenos", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"FileNames", "[", "]"}], "]"}], "~~", 
          "\"\</spreadsheets\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"filenames", "=", 
         RowBox[{"shortfilenames", "=", 
          RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringCases", "[", 
               RowBox[{
                RowBox[{"FileNames", "[", "]"}], ",", "\"\<series\>\""}], 
               "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
             RowBox[{"{", "\"\<series\>\"", "}"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"filenames", ",", 
              RowBox[{
               RowBox[{"FileNames", "[", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nfilenamestot", "=", 
         RowBox[{"Length", "[", "filenames", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"shortfilenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{"filenames", "[", 
                  RowBox[{"[", "o", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"filenames", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "\"\<series\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<shortfilenames:\\n\>\"", ",", 
          RowBox[{"shortfilenames", "//", "TableForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Part", " ", "4"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"a", ".", "Read"}], " ", "in", " ", "data"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"data3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{",", 
           RowBox[{"{", "nfilenamestot", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<reading in file \>\"", ",", 
             RowBox[{
              RowBox[{"FileNames", "[", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"o", "+", "1"}], "]"}], "]"}]}], "]"}], ";", 
           RowBox[{
            RowBox[{"data3", "[", 
             RowBox[{"[", "o", "]"}], "]"}], "=", 
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"FileNames", "[", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"o", "+", "1"}], "]"}], "]"}], "]"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "nfilenamestot"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yaxislabels", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"-", "8"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data3", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"data3", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"data3", "[", 
              RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"data3", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"data4", "=", "data3"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data5", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "data4"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"b", ".", "Calculate"}], " ", "stuff", " ", "for", " ", 
          "plots"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"startvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"data4", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"startvaluess", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "startvalues"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxima", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}],
                   "]"}], "==", "Real"}], ",", 
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
                ",", 
                RowBox[{"-", 
                 RowBox[{"10.", "^", "99"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"10.", "^", "99"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maximas", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "maxima"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}],
                   "]"}], "==", "Real"}], ",", 
                RowBox[{"data4", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "j", ",", "i", ",", "k"}], "]"}], "]"}], 
                ",", 
                RowBox[{"10.", "^", "99"}], ",", 
                RowBox[{"10.", "^", "99"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"o", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "nfilenamestot"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"data4", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"minimas", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "minima"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"4", " ", 
          RowBox[{"c", ".", "Legend"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nstyles", "=", 
         RowBox[{"Length", "[", "varstyles", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nstyless", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nstyles"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"combvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"varvalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"varstyles", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Last", "[", 
                 RowBox[{"varstyles", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"prods", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", 
               RowBox[{"varstyles", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"varstyles", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"styles", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"colours", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"Thickness", "[", 
                 RowBox[{
                  RowBox[{"linethicknesses", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "*", "k"}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"prods", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"prods", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ">", 
              RowBox[{"prods", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"styles", "=", 
              RowBox[{"Reverse", "[", "styles", "]"}]}]}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"styles", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"colours", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"prods", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", ">", "2"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"styles", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Dashing", "[", 
                RowBox[{"dashings", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"nvars", "[", 
                   RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                "}"}]}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"legstyles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "Null"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "2"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", "Null"}], 
               "]"}]}], "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphstyles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "1"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Null"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nvar", ">", "2"}], ",", 
                RowBox[{"styles", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", "Null"}], 
               "]"}]}], "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphics2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Directive", "@@", 
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"graphstyles", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"graphstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"graphics2s", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "graphics2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"gap", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                  RowBox[{"Scaled", "[", 
                   RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
               "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
           RowBox[{"StyleForm", "[", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "6"}], ",", 
             RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"newlegend", "=", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"legstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                     "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"StyleForm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\< \>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", "+", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{"StringLength", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "<>", 
                    RowBox[{"Last", "[", 
                    RowBox[{"combvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
                    "\"\<\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "\[Rule]", "9"}]}], "]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                     "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", ".5"}], "}"}], "]"}], ",", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", ".5"}], "}"}], "]"}]}], "}"}], "]"}]}],
                     "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                   RowBox[{"StyleForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "1"}], ",", 
                    RowBox[{"\"\<   \>\"", "<>", 
                    RowBox[{"vartitlesshort", "[", 
                    RowBox[{"[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"varstyles", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                    ",", "\"\<\>\""}], "]"}]}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<MonoSpace\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                    RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", "gap"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newlegends", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "newlegend"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"newlegend", "//", "TableForm"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"nos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"nos", "[", 
            RowBox[{"[", 
             RowBox[{"varstyles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"nos1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nos2s", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nos2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlegsecs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"varstyles", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nlegsecss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nlegsecs"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legtitlenos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", ">", "1"}], ",", 
              RowBox[{
               RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legspacenos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"legtitlenos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legdisplaynos", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"legtitlenos", ",", "legspacenos"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"legdisplaynoss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "legdisplaynos"}], 
        ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "5.", " ", "Timescale", " ", "analysis", " ", "for", " ", "pCO2"}], 
          " ", "&"}], " ", "temperature"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"timescaleanalysis", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dataset3", "=", 
             RowBox[{"{", ",", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ntemps", "=", 
             RowBox[{"nco2s", "=", 
              RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FileNames", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
                   "\"\<*temp*\>\""}], "]"}], ",", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"ntemps", ",", "i"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FileNames", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
                   "\"\<*CO2*\>\""}], "]"}], ",", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"nco2s", ",", "i"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nfilenamestot"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ntemp", "=", 
             RowBox[{"First", "[", "ntemps", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nco2", "=", 
             RowBox[{"First", "[", "nco2s", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dataset3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"nco2", ",", "2", ",", "1", ",", "i"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"nco2", ",", "2", ",", 
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"nco2", ",", "2", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}],
               "]"}]}], ";", 
            RowBox[{
             RowBox[{"dataset3", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"ntemp", ",", "1", ",", "1", ",", "i"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"data4", "[", 
                  RowBox[{"[", 
                   RowBox[{"ntemp", ",", "1", ",", 
                    RowBox[{"k", "+", "1"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"data4", "[", 
                   RowBox[{"[", 
                    RowBox[{"ntemp", ",", "1", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "]"}]}], "}"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"del", "=", 
                RowBox[{"{", "}"}]}], ";", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     ">", 
                    RowBox[{"nyearss", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"del", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"dataset3", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k"}], "]"}], "]"}], "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", "del"}], 
                 "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"d", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"maxs", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"dataset3", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "]"}], "\[Equal]", "Real"}], ",", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     ",", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"dataset3", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                   "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"downcurve", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"dataset3", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "k", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"maxs", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k", ",", "1", ",", "1"}], "]"}], "]"}], 
                 ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dataset3", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], ";", 
            RowBox[{"logdata", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"downcurve", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}], 
                 ",", 
                 RowBox[{"Log", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "]"}], "]"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"downcurve", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                  "1"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{"timescaledata", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "+", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], 
                   ")"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], 
                    "]"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], 
                   ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"logdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                  "1"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{"timescaledata2", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], "]"}],
                     "+", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], 
                   ")"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "1"}], "]"}], 
                    "]"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", 
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], 
                    "]"}]}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "nruns"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}], "-", 
                  "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"timescaledata", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
                "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", 
                    RowBox[{"timescaledata", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "]"}], "==", "Real"}], ",", 
                  RowBox[{"timescaledata", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                   ",", ",", "0"}], "]"}]}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"timescaledata", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"timescaledata2", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}], 
                "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", 
                    RowBox[{"timescaledata2", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                     "]"}], "==", "Real"}], ",", 
                  RowBox[{"timescaledata2", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "k", ",", "i", ",", "2"}], "]"}], "]"}],
                   ",", ",", "0"}], "]"}]}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"timescaledata2", "[", 
                  RowBox[{"[", 
                   RowBox[{"d", ",", "k"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"timescaledatas", "[", 
              RowBox[{"[", 
               RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "timescaledata"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"timescaledata2s", "[", 
              RowBox[{"[", 
               RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "timescaledata2"}],
             ";"}]}], "]"}], ";"}], "*)"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"f", ",", "nparts"}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.462023119991692*^9, 3.462023120174494*^9}, {
   3.462023152618473*^9, 3.462023171464966*^9}, {3.462027168680149*^9, 
   3.4620271843876534`*^9}, {3.4620275647999973`*^9, 
   3.4620275749029408`*^9}, {3.462027606071335*^9, 3.462027621874998*^9}, {
   3.462027679867908*^9, 3.462027681146803*^9}, {3.4620294356299257`*^9, 
   3.462029590466146*^9}, {3.462029697523219*^9, 3.4620297340242453`*^9}, {
   3.462029768246172*^9, 3.4620297901553717`*^9}, {3.4620299192473783`*^9, 
   3.462029934972437*^9}, {3.46203007899965*^9, 3.462030144538355*^9}, {
   3.462030237395691*^9, 3.46203025064009*^9}, {3.4620303074841833`*^9, 
   3.462030307834057*^9}, {3.462030354104141*^9, 3.462030373901606*^9}, {
   3.46203063307268*^9, 3.462030633281682*^9}, {3.4620306979607773`*^9, 
   3.462030698929603*^9}, {3.462030890050074*^9, 3.462030894121662*^9}, {
   3.462031067517426*^9, 3.4620310754767*^9}, {3.4620316640550547`*^9, 
   3.462031703662437*^9}, {3.4620317736911917`*^9, 3.4620317791029243`*^9}, {
   3.46203181627775*^9, 3.4620319722989607`*^9}, {3.462033454107682*^9, 
   3.462033600422317*^9}, 3.4620336314862823`*^9, {3.462033673992259*^9, 
   3.462033699466103*^9}, {3.462034093968981*^9, 3.462034096160631*^9}, {
   3.462035485643231*^9, 3.462035544506846*^9}, {3.462035615518898*^9, 
   3.4620357298205853`*^9}, {3.462035783748323*^9, 3.462035844139016*^9}, {
   3.4620359248029213`*^9, 3.462036146610056*^9}, {3.462036246494248*^9, 
   3.462036248914403*^9}, {3.462036443746531*^9, 3.4620364442141323`*^9}, {
   3.462036586919578*^9, 3.46203662762276*^9}, {3.4620375178918343`*^9, 
   3.4620375267104683`*^9}, {3.462037598239778*^9, 3.462037602912957*^9}, {
   3.462037844547433*^9, 3.4620378929806843`*^9}, {3.46203796389797*^9, 
   3.462037994071233*^9}, {3.462038094089937*^9, 3.462038114087219*^9}, {
   3.4620382283005743`*^9, 3.462038231585988*^9}, 3.462038663605668*^9, {
   3.462038843990191*^9, 3.4620388621787233`*^9}, {3.462038901161792*^9, 
   3.462038901769342*^9}, {3.462039208751321*^9, 3.4620392539631577`*^9}, {
   3.462039435315106*^9, 3.462039435718238*^9}, {3.462039480282207*^9, 
   3.462039486138102*^9}, {3.4620397234860773`*^9, 3.4620397314375057`*^9}, {
   3.462039808834046*^9, 3.462039848088181*^9}, 3.462040084749372*^9, {
   3.462040439274733*^9, 3.4620404871811123`*^9}, 3.462040546329947*^9, {
   3.462187970323617*^9, 3.462187983177383*^9}, {3.462188090049431*^9, 
   3.4621881995566883`*^9}, {3.462188278317587*^9, 3.462188358717417*^9}, {
   3.4621884196754313`*^9, 3.46218842222663*^9}, {3.462188472830637*^9, 
   3.462188474276726*^9}, {3.462195138358865*^9, 3.4621951407743807`*^9}, {
   3.4621951757348957`*^9, 3.462195210794283*^9}, {3.462195903683641*^9, 
   3.462196098030435*^9}, 3.462196142816847*^9, {3.462196184645949*^9, 
   3.4621961865007153`*^9}, {3.46219641027136*^9, 3.462196518606509*^9}, {
   3.462196551452675*^9, 3.462196553901932*^9}, {3.462196973638564*^9, 
   3.4621969741670303`*^9}, {3.462197296986328*^9, 3.462197315419482*^9}, {
   3.462197411144545*^9, 3.462197427938244*^9}, {3.462197595039559*^9, 
   3.462197620937151*^9}, {3.462197662445116*^9, 3.462197673337544*^9}, {
   3.46219771007908*^9, 3.4621977128792887`*^9}, {3.462197751233556*^9, 
   3.4621977587191133`*^9}, {3.462197881927001*^9, 3.462197900906637*^9}, {
   3.462197939492391*^9, 3.462197957679785*^9}, {3.462198102706747*^9, 
   3.462198106991476*^9}, {3.4621981713990803`*^9, 3.4621981725134897`*^9}, {
   3.462198230109116*^9, 3.46219823077197*^9}, {3.462198262121468*^9, 
   3.462198292886181*^9}, {3.46219833215615*^9, 3.462198333234126*^9}, 
   3.4621984180876837`*^9, {3.462198477851308*^9, 3.462198548375444*^9}, {
   3.4621987818489437`*^9, 3.462198784373178*^9}, {3.462199007933352*^9, 
   3.462199010251566*^9}, {3.4621991258493147`*^9, 3.462199208053434*^9}, {
   3.462199239396435*^9, 3.4621992429052067`*^9}, {3.462199365748365*^9, 
   3.462199381613991*^9}, {3.4621997324662848`*^9, 3.462199732705737*^9}, {
   3.462199871581491*^9, 3.462199874926354*^9}, 3.462199969348154*^9, {
   3.46220003255376*^9, 3.4622000364053383`*^9}, {3.462201074600865*^9, 
   3.462201074946677*^9}, {3.4626138337239428`*^9, 3.462613838005012*^9}, {
   3.462613879381761*^9, 3.462613920332706*^9}, {3.4626141771984873`*^9, 
   3.462614177537417*^9}, {3.4626144140254583`*^9, 3.462614425079198*^9}, {
   3.462614585223283*^9, 3.462614615694049*^9}, {3.4626146488979683`*^9, 
   3.462614657527609*^9}, {3.462614833802204*^9, 3.462614883970093*^9}, {
   3.462615062445517*^9, 3.462615089644796*^9}, {3.462615140640809*^9, 
   3.4626151471019573`*^9}, {3.462615180213472*^9, 3.4626152117662077`*^9}, {
   3.462615254223653*^9, 3.462615307899673*^9}, {3.4626155122526007`*^9, 
   3.4626155148583183`*^9}, {3.4626155960897703`*^9, 3.462615651664625*^9}, {
   3.462617389327629*^9, 3.46261739324863*^9}, {3.462625674218556*^9, 
   3.4626256744259233`*^9}, 3.462627569759968*^9, {3.462627607450924*^9, 
   3.462627629647564*^9}, {3.4626300111860027`*^9, 3.462630012281993*^9}, {
   3.462630051109071*^9, 3.46263007178727*^9}, {3.463394191029155*^9, 
   3.46339419867101*^9}, {3.463394255776709*^9, 3.463394290647257*^9}, {
   3.463394362903963*^9, 3.46339437502932*^9}, {3.463396311733383*^9, 
   3.463396312818218*^9}, {3.467710199441477*^9, 3.4677102008516273`*^9}, {
   3.467710247227355*^9, 3.4677103530809317`*^9}, {3.467710413336306*^9, 
   3.467710434483308*^9}, {3.467710930975786*^9, 3.467710931447493*^9}, {
   3.467720636309989*^9, 3.46772063757868*^9}, 3.467720670396748*^9, {
   3.4677227708284197`*^9, 3.4677227784767427`*^9}, {3.467724198351466*^9, 
   3.46772419920014*^9}, 3.467725123211025*^9, 3.467738998478763*^9, {
   3.468675930985511*^9, 3.46867593551655*^9}, {3.4686761908766003`*^9, 
   3.4686762275844812`*^9}, {3.468677613663574*^9, 3.468677618430397*^9}, {
   3.4686776591136847`*^9, 3.4686776725814323`*^9}, {3.468677956458294*^9, 
   3.468678009358203*^9}, {3.468678619273137*^9, 3.4686786819059*^9}, {
   3.468678719032374*^9, 3.468678730123177*^9}, {3.468921644119768*^9, 
   3.4689216576729727`*^9}, {3.468938756669224*^9, 3.468938759360327*^9}, 
   3.468939336750029*^9, {3.468942530638728*^9, 3.4689425309828243`*^9}, {
   3.468942635431234*^9, 3.4689426362741833`*^9}, {3.4689426745171537`*^9, 
   3.468942677979362*^9}, {3.4689427365333223`*^9, 3.4689427705189734`*^9}, {
   3.468942926200898*^9, 3.46894293574687*^9}, {3.468943028879547*^9, 
   3.46894310419627*^9}, {3.468943192837182*^9, 3.468943283397434*^9}, {
   3.468943313872081*^9, 3.46894331839972*^9}, {3.4689433510799294`*^9, 
   3.468943465573345*^9}, 3.4689435238237247`*^9, {3.468943785212294*^9, 
   3.468943878437111*^9}, {3.4689442182061357`*^9, 3.4689442329434013`*^9}, {
   3.468944263372295*^9, 3.4689442636825857`*^9}, {3.4689511961477947`*^9, 
   3.46895120070162*^9}, 3.471704223731742*^9, {3.4741238306658783`*^9, 
   3.4741238338455133`*^9}, {3.4741239351182404`*^9, 3.474123937266163*^9}, {
   3.474123980850306*^9, 3.474124044084474*^9}, {3.474124093324933*^9, 
   3.474124118453828*^9}, {3.474124175955563*^9, 3.474124197410166*^9}, {
   3.474124521443363*^9, 3.474124522513324*^9}, {3.47413445854834*^9, 
   3.4741344679202213`*^9}, {3.474384184826831*^9, 3.474384186955408*^9}, {
   3.4743862369360723`*^9, 3.47438623711946*^9}, {3.474393877254401*^9, 
   3.474393889548141*^9}, 3.474803580723578*^9, {3.474804273991167*^9, 
   3.474804275193199*^9}, {3.4748043687189617`*^9, 3.474804462492406*^9}, {
   3.474804504560926*^9, 3.474804504709259*^9}, {3.474804836842781*^9, 
   3.4748049126793423`*^9}, {3.47480503834377*^9, 3.474805038513051*^9}, 
   3.474805146068059*^9, {3.474805194017174*^9, 3.474805194169272*^9}, 
   3.47480524822274*^9, {3.474805279155217*^9, 3.474805344427169*^9}, {
   3.4748054140276937`*^9, 3.474805414399598*^9}, 3.482507704852943*^9, {
   3.484038266551324*^9, 3.4840382690234137`*^9}, {3.484038389664485*^9, 
   3.4840384339599123`*^9}, {3.484039917710009*^9, 3.4840399265000887`*^9}, {
   3.484043130701365*^9, 3.484043151574354*^9}, {3.484043185365863*^9, 
   3.484043210320078*^9}, 3.484551586098277*^9, 3.486366831581017*^9, {
   3.486367488941525*^9, 3.4863674948077507`*^9}, 3.486368113466135*^9, 
   3.486372024341905*^9, {3.486372199248444*^9, 3.486372200994402*^9}, {
   3.4863728351030416`*^9, 3.486372836844984*^9}, 3.4863734805524197`*^9, 
   3.486374298820631*^9, {3.486374785432063*^9, 3.486374785767457*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["b. Interactive time-series plotting", "Subsubtitle",
 CellChangeTimes->{{3.463394844190172*^9, 3.463394849523423*^9}, {
  3.463394961220405*^9, 3.463394974545466*^9}, {3.471704555795212*^9, 
  3.471704556804278*^9}, {3.474132718919382*^9, 3.4741327205421553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"4.", 
    RowBox[{"e", ".", " ", "Interactive"}], " ", "now", " ", "starts", " ", 
    "here"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"newfilenamenos", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "+=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"nfilenames", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "nmodules"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"newfilenamenos", "=", 
     RowBox[{"Flatten", "[", "newfilenamenos", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"openbrackets", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"yaxislabels", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<(\>\""}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", "1", ",", 
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"yaxislabels", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<(\>\""}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenamestot"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"yaxislabels", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"closebrackets", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"yaxislabels", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<)\>\""}], 
           "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"StringLength", "[", 
          RowBox[{"yaxislabels", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{
            RowBox[{"yaxislabels", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<)\>\""}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenamestot"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"yaxislabels", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variablenames", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"shortfilenames", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenamestot"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeseriesunits", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"yaxislabels", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"openbrackets", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"closebrackets", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nfilenamestot"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"yaxislabels", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ensemblename", "=", 
       RowBox[{"ensembleroot", "~~", 
        RowBox[{"ensembles", "[", 
         RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ensemshort", "=", 
       RowBox[{"ensemblerootshort", "~~", 
        RowBox[{"ensembles", "[", 
         RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ensembledatafile", "=", 
       RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"resultsfolder", "=", 
       RowBox[{
       "resultsfoldersuffix", "~~", "titleshort", "~~", "\"\<_\>\"", "~~", 
        "ensemblename"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetDirectory", "[", 
       RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
        RowBox[{"partnames", "[", 
         RowBox[{"[", "f", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"SetDirectory", "[", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"FileNames", "[", "]"}], "]"}], "~~", "\"\</graphs\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotstartyear", "=", 
       RowBox[{"plotstartyears", "[", 
        RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nyears", "=", 
       RowBox[{"nyearss", "[", 
        RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"data4", "=", 
       RowBox[{"data5", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"control", "=", 
       RowBox[{"controls", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"nruns", "=", 
       RowBox[{"nrunss", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"minima", "=", 
       RowBox[{"minimas", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"maxima", "=", 
       RowBox[{"maximas", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"startvalues", "=", 
       RowBox[{"startvaluess", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"newlegend", "=", 
       RowBox[{"newlegends", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ensemblenos", "=", 
       RowBox[{"ensemblenoss", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"nstyles", "=", 
       RowBox[{"nstyless", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"varstyles", "=", 
       RowBox[{"varstyless", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"nos2", "=", 
       RowBox[{"nos2s", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"nlegsecs", "=", 
       RowBox[{"nlegsecss", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"legdisplaynos", "=", 
       RowBox[{"legdisplaynoss", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"graphics2", "=", 
       RowBox[{"graphics2s", "[", 
        RowBox[{"[", 
         RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
         RowBox[{
          RowBox[{"minima", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
          RowBox[{"startvalues", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
         RowBox[{"minima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"max", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
         RowBox[{
          RowBox[{"maxima", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
          RowBox[{"startvalues", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ",", 
         RowBox[{"maxima", "[", 
          RowBox[{"[", 
           RowBox[{"o", ",", "q"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ymindefault", "=", 
       RowBox[{"min", "-", 
        RowBox[{"0.1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"maxima", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
           RowBox[{"minima", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ymaxdefault", "=", 
       RowBox[{"max", "+", 
        RowBox[{"0.1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"maxima", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "q"}], "]"}], "]"}], "-", 
           RowBox[{"minima", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xmindefault", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zerox", "\[Equal]", "False"}], ",", "plotstartyear", ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotlabel", "=", 
       RowBox[{"StyleForm", "[", 
        RowBox[{
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Variation of `` with time for ``\\n ``\\n ``; ``yr run\>\"", 
           ",", 
           RowBox[{"shortfilenames", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "2"}], "]"}], "]"}], ",", "config", ",", 
           "info", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
             "\"\<relative to preindustrial\>\"", ",", "\"\<\>\""}], "]"}], 
           ",", "xmax"}], "]"}], ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
         RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nosinuse", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ensemblenos", "[", 
             RowBox[{"[", "tab", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"varstyles", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"nosinuse2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"nos2", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"nosinuse", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"nosinuse", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"nosinuse3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nosinuse2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", ">", "1"}], ",", 
            RowBox[{
             RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nosinuse4", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newlegendplus", "=", 
       RowBox[{"newlegend", "[", 
        RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{
       "ShowLegend", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ListLogLinearPlot", "[", "##", "]"}], ",", 
              RowBox[{"ListPlot", "[", "##", "]"}]}], "}"}], "[", 
            RowBox[{"[", "l", "]"}], "]"}], "&"}], "@", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1", ",", "i"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zerox", "\[Equal]", "True"}], ",", 
                    "plotstartyear", ",", "0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "i"}], 
                    "]"}], "]"}], "-", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}], ",", "0"}], "]"}], "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"correctdrift", "\[Equal]", "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}]}], "]"}], "]"}], "]"}], ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "control", ",", 
                    "1"}], "]"}], "+", "1"}], ",", "i"}], "]"}], "]"}], "-", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "1"}], 
                    "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", 
                    RowBox[{
                    RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data4", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "q", ",", "1"}], "]"}], "]"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",",
                  "plotlabel"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<year\>\"", ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"zeroy", "\[Equal]", "True"}], ",", 
                    "\"\<change in\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
                  RowBox[{"yaxislabels", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "q"}], "]"}], "]"}]}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"yauto", ",", "Automatic", ",", 
                   RowBox[{"{", 
                    RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"GridLines", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"FontSize", "\[Rule]", "13"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"graphics2", "[", 
                  RowBox[{"[", 
                   RowBox[{"tab", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}]}], 
             "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
           RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendPosition", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", 
              RowBox[{"-", "0.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"LegendSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tabcode", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"alpha", ",", 
           RowBox[{"{", 
            RowBox[{"tab2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"graphtitle", "=", 
       RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
        RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"filenames", "[", 
           RowBox[{"[", "o", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{
                RowBox[{"filenames", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "\"\<series\>\""}], 
               "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<_units\>\"", "~~", 
        RowBox[{"ToString", "[", "q", "]"}], "~~", "\"\<_\>\"", "~~", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"correctdrift", "\[Equal]", "True"}], ",", 
          "\"\<_driftcorr_\>\"", ",", "\"\<\>\""}], "]"}], "~~", 
        RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr_\>\"", "~~", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"l", "\[Equal]", "1"}], ",", "\"\<log\>\"", ",", 
          "\"\<linear\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
             RowBox[{"saveformats", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", 
       RowBox[{"Show", "[", 
        RowBox[{"graph", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", "800", "}"}]}]}], "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e", ",", "1", ",", "\"\<ensemble\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"ensembles", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nensem"}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "1", ",", "\"\<part\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"variablenames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nfilenamestot"}], "}"}]}], "]"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", "\"\<units\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "\[Rule]", 
          RowBox[{"timeseriesunits", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"data4", "[", 
             RowBox[{"[", "o", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"tab", ",", 
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmindefault"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymindefault"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ymax", ",", "ymaxdefault"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"yauto", ",", "True", ",", "\"\<auto y-axis scale\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\"\<plot type\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zerox", ",", "False", ",", "\"\<relative x-axis scale\>\""}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zeroy", ",", "False", ",", "\"\<relative y-axis scale\>\""}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "correctdrift", ",", "False", ",", "\"\<correct for drift\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"saveformats", ",", 
       RowBox[{"{", 
        RowBox[{"{", "\"\<pdf\>\"", "}"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Initialization", "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ensemblename", "=", 
         RowBox[{"ensembleroot", "~~", 
          RowBox[{"ensembles", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ensemshort", "=", 
         RowBox[{"ensemblerootshort", "~~", 
          RowBox[{"ensembles", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ensembledatafile", "=", 
         RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"resultsfolder", "=", 
         RowBox[{"resultsfoldersuffix", "~~", "ensemblename"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"FileNames", "[", "]"}], "]"}], "~~", "\"\</graphs\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"plotstartyear", "=", 
         RowBox[{"plotstartyears", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nyears", "=", 
         RowBox[{"nyearss", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"data4", "=", 
         RowBox[{"data5", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"control", "=", 
         RowBox[{"controls", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nruns", "=", 
         RowBox[{"nrunss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minima", "=", 
         RowBox[{"minimas", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxima", "=", 
         RowBox[{"maximas", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"startvalues", "=", 
         RowBox[{"startvaluess", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newlegend", "=", 
         RowBox[{"newlegends", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenos", "=", 
         RowBox[{"ensemblenoss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nstyles", "=", 
         RowBox[{"nstyless", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"varstyles", "=", 
         RowBox[{"varstyless", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nos2", "=", 
         RowBox[{"nos2s", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlegsecs", "=", 
         RowBox[{"nlegsecss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"legdisplaynos", "=", 
         RowBox[{"legdisplaynoss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphics2", "=", 
         RowBox[{"graphics2s", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";"}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.462200256061717*^9, 3.4622002563192463`*^9}, {
   3.462200330651552*^9, 3.462200338889408*^9}, {3.4622003998618307`*^9, 
   3.462200414465164*^9}, {3.462200558286437*^9, 3.46220056180836*^9}, {
   3.462200633349514*^9, 3.462200670549951*^9}, {3.4622007190071297`*^9, 
   3.462200761002603*^9}, 3.462201022693194*^9, {3.462201079700131*^9, 
   3.4622011566312237`*^9}, {3.462201237155551*^9, 3.4622012650604877`*^9}, {
   3.4622012976991663`*^9, 3.46220130474727*^9}, {3.4622015259305687`*^9, 
   3.462201537485942*^9}, {3.462201585309708*^9, 3.462201595521152*^9}, {
   3.462204991217943*^9, 3.46220499448269*^9}, {3.462613804204067*^9, 
   3.462613824774002*^9}, {3.462614170262657*^9, 3.462614172735601*^9}, {
   3.462614445759726*^9, 3.462614455267836*^9}, {3.462614676839733*^9, 
   3.462614719582571*^9}, {3.462614902547015*^9, 3.4626149270607452`*^9}, {
   3.462614981729261*^9, 3.462615002128249*^9}, {3.4626150982248497`*^9, 
   3.462615103746505*^9}, {3.4626156884767847`*^9, 3.462615703330739*^9}, {
   3.462615739286269*^9, 3.462615752290803*^9}, {3.462615818849544*^9, 
   3.462615830781282*^9}, {3.4626159568722*^9, 3.4626159692078867`*^9}, {
   3.462616056250527*^9, 3.4626161079939947`*^9}, {3.4626162876225767`*^9, 
   3.462616332349009*^9}, {3.4626167909816008`*^9, 3.462616795189108*^9}, 
   3.462616937294826*^9, {3.462616982500866*^9, 3.46261699904109*^9}, {
   3.462617125251964*^9, 3.4626171948758087`*^9}, {3.462617324811592*^9, 
   3.4626173262672157`*^9}, {3.462617408832103*^9, 3.462617497460566*^9}, {
   3.462617704108926*^9, 3.46261771087085*^9}, 3.462617780828261*^9, {
   3.462617898747538*^9, 3.462617919593705*^9}, {3.462618603541979*^9, 
   3.462618647777363*^9}, {3.46261935754315*^9, 3.462619361767708*^9}, {
   3.462627645197465*^9, 3.462627660468093*^9}, {3.462630119366274*^9, 
   3.462630126569091*^9}, 3.464526682222411*^9, {3.464527646851798*^9, 
   3.4645276567967463`*^9}, 3.467710202939621*^9, {3.4677251306916513`*^9, 
   3.467725130984548*^9}, {3.468677307239831*^9, 3.468677337312023*^9}, 
   3.46867737522377*^9, 3.468677712664119*^9, 3.468677772817834*^9, {
   3.468782053432461*^9, 3.468782053516241*^9}, {3.468782088919058*^9, 
   3.4687820890474577`*^9}, 3.468782174282709*^9, {3.468786589198333*^9, 
   3.468786627152034*^9}, {3.468787230218265*^9, 3.468787249859206*^9}, {
   3.4687875089633083`*^9, 3.468787511149437*^9}, {3.4687875538727694`*^9, 
   3.468787601094789*^9}, {3.468787903061092*^9, 3.468787947037319*^9}, {
   3.468788000616729*^9, 3.4687880266743717`*^9}, {3.4687881041102943`*^9, 
   3.4687881051383867`*^9}, {3.46878832133148*^9, 3.468788350354055*^9}, {
   3.468788391218976*^9, 3.468788417362438*^9}, {3.468788465872308*^9, 
   3.468788469998612*^9}, {3.468788700480753*^9, 3.4687887094611*^9}, {
   3.468788762473619*^9, 3.468788797923586*^9}, 3.46878884093085*^9, {
   3.468788935332089*^9, 3.468788938881222*^9}, {3.468789007238679*^9, 
   3.468789017368392*^9}, {3.468943915151787*^9, 3.468943959503469*^9}, 
   3.468944030606598*^9, {3.468944069933633*^9, 3.468944070925042*^9}, {
   3.471696485955254*^9, 3.471696497613798*^9}, {3.47412453712766*^9, 
   3.474124560935281*^9}, {3.474125530513588*^9, 3.474125532986012*^9}, {
   3.474749673027357*^9, 3.474749673359866*^9}, {3.474752863112401*^9, 
   3.474752863447132*^9}, {3.474830179491665*^9, 3.474830179767243*^9}, {
   3.484551666544614*^9, 3.484551679707674*^9}, {3.485621347870685*^9, 
   3.485621348389494*^9}, {3.486374977495626*^9, 3.486374993460429*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ensembles", "[", 
      RowBox[{"[", "e", "]"}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nrunss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"e", ",", "nensem"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4741223214737253`*^9, 3.4741224235800753`*^9}, {
  3.4741224551766577`*^9, 3.474122485728468*^9}, {3.474134031220027*^9, 
  3.4741340659229403`*^9}}],

Cell[BoxData[{
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "+", 
     RowBox[{"12", "*", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}], "+", 
     RowBox[{"12", "*", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}], "+", 
     RowBox[{"12", "*", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["c. Interactive timescale analysis plotting", "Subsubtitle",
 CellChangeTimes->{{3.463394844190172*^9, 3.463394849523423*^9}, {
  3.463394961220405*^9, 3.463394974545466*^9}, {3.463395020485924*^9, 
  3.463395034691978*^9}, {3.471704552697527*^9, 3.4717045533476353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "5.", " ", "Timescale", " ", "analysis", " ", "for", " ", "pCO2"}], " ", 
     "&"}], " ", "temperature"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ensemblename", "=", 
      RowBox[{"ensembleroot", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemshort", "=", 
      RowBox[{"ensemblerootshort", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembledatafile", "=", 
      RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resultsfolder", "=", 
      RowBox[{"resultsfoldersuffix", "~~", "ensemblename"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{"resultsfolder", "~~", "\"\</\>\"", "~~", 
       RowBox[{"partnames", "[", 
        RowBox[{"[", "f", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"FileNames", "[", "]"}], "]"}], "~~", "\"\</graphs\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotstartyear", "=", 
      RowBox[{"plotstartyears", "[", 
       RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nyears", "=", 
      RowBox[{"nyearss", "[", 
       RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"timescaledata", "=", 
      RowBox[{"timescaledatas", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timescaledata2", "=", 
      RowBox[{"timescaledata2s", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nruns", "=", 
      RowBox[{"nrunss", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newlegend", "=", 
      RowBox[{"newlegends", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemblenos", "=", 
      RowBox[{"ensemblenoss", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nstyles", "=", 
      RowBox[{"nstyless", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varstyles", "=", 
      RowBox[{"varstyless", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nos2", "=", 
      RowBox[{"nos2s", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nlegsecs", "=", 
      RowBox[{"nlegsecss", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"legdisplaynos", "=", 
      RowBox[{"legdisplaynoss", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"graphics2", "=", 
      RowBox[{"graphics2s", "[", 
       RowBox[{"[", 
        RowBox[{"e", ",", "f"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"xmin", "=", "2000"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"plotlabel", "=", 
      RowBox[{"StyleForm", "[", 
       RowBox[{
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<e-folding timescale of `` for `` ``; ``yr run\>\"", ",", 
          RowBox[{"shortfilenames", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "2"}], "]"}], "]"}], ",", "config", ",", "info",
           ",", "xmax"}], "]"}], ",", 
        RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
        RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nosinuse", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ensemblenos", "[", 
            RowBox[{"[", "tab", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"varstyles", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "tab", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"nosinuse2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"nos2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"nosinuse", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nstyles"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"nosinuse", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"nosinuse3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nosinuse2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "i"}], "-", "1"}], ")"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "1"}], ",", 
           RowBox[{
            RowBox[{"Accumulate", "[", "nlegsecs", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", "0"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "nstyles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nosinuse4", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "nosinuse3", "]"}], ",", "legdisplaynos"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newlegendplus", "=", 
      RowBox[{"newlegend", "[", 
       RowBox[{"[", "nosinuse4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"ShowLegend", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"timescaledata", "[", 
             RowBox[{"[", 
              RowBox[{"o", ",", 
               RowBox[{"tab", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<year\>\"", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<dln(``-\!\(\*SubscriptBox[\(``\), \(final\)]\))/dt (years)\
\>\"", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]pCO\), \
\(2\)]\)\>\"", ",", "\"\<\[CapitalDelta]T\>\""}], "}"}], "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]pCO\), \
\(2\)]\)\>\"", ",", "\"\<\[CapitalDelta]T\>\""}], "}"}], "[", 
                RowBox[{"[", "o", "]"}], "]"}]}], "]"}], ",", "None", ",", 
             "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"title", "\[Equal]", "False"}], ",", "\"\<\>\"", ",", 
             "plotlabel"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"yauto", ",", "Automatic", ",", 
               RowBox[{"{", 
                RowBox[{"ymin", ",", "ymax"}], "}"}]}], "]"}]}], "}"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", "900", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Automatic", ",", "Automatic", ",", 
             "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"graphics2", "[", 
              RowBox[{"[", 
               RowBox[{"tab", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "tab", "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "13"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"newlegendplus", ",", "\[IndentingNewLine]", 
          RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegendBorder", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegendPosition", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", 
             RowBox[{"-", "0.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"LegendSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0.4", ",", "1"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tab2", "=", "tab"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabcode", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"alpha", ",", 
          RowBox[{"{", 
           RowBox[{"tab2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "tab2", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graphtitle", "=", 
      RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
       RowBox[{"StringJoin", "[", "tabcode", "]"}], "~~", "\"\<_\>\"", "~~", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"filenames", "[", 
          RowBox[{"[", "o", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{
               RowBox[{"filenames", "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", "\"\<series\>\""}], 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", 
           RowBox[{"-", "5"}]}], "}"}]}], "]"}], "~~", "\"\<_e-folding_\>\"", 
       "~~", 
       RowBox[{"ToString", "[", "xmax", "]"}], "~~", "\"\<yr\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"savegraph", "\[Equal]", "True"}], ",", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"graphtitle", "~~", "\"\<.\>\"", "~~", 
            RowBox[{"saveformats", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "graph"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "saveformats", "]"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"graph", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", "800", "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "1", ",", "\"\<ensemble\>\""}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "\[Rule]", 
         RowBox[{"ensembles", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nensem"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "1", ",", "\"\<part\>\""}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "\[Rule]", 
         RowBox[{"partnames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"o", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "\[Rule]", 
         RowBox[{"variablenames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"tab", ",", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"control", "+", "1"}], ",", "nruns"}], "}"}]}], "]"}], 
       "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"xmin", ",", "1000"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"xmax", ",", "nyears"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ymin", ",", "100"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ymax", ",", 
      RowBox[{"10", "^", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"yauto", ",", "False", ",", "\"\<auto y-axis scale\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"title", ",", "False", ",", "\"\<title\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"saveformats", ",", 
      RowBox[{"{", 
       RowBox[{"{", "\"\<pdf\>\"", "}"}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"savegraph", ",", "False", ",", "\"\<save graph\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.399802215546875*^9, 3.399802383140625*^9}, {
   3.39980242046875*^9, 3.399802496328125*^9}, {3.399802546453125*^9, 
   3.399802570390625*^9}, {3.399802622046875*^9, 3.399802665625*^9}, {
   3.399802799484375*^9, 3.3998028529375*^9}, {3.399802930859375*^9, 
   3.39980307659375*^9}, {3.39980311275*^9, 3.399803145015625*^9}, {
   3.399803228078125*^9, 3.399803254625*^9}, {3.399803504703125*^9, 
   3.3998035993125*^9}, {3.399803845796875*^9, 3.39980388490625*^9}, {
   3.399803940890625*^9, 3.399803965921875*^9}, {3.399804274375*^9, 
   3.399804298125*^9}, {3.399804331984375*^9, 3.399804332234375*^9}, {
   3.399804367640625*^9, 3.399804375875*^9}, {3.39980465*^9, 
   3.399804699390625*^9}, {3.399804811984375*^9, 3.399804921453125*^9}, {
   3.399805093765625*^9, 3.39980515209375*^9}, {3.399805188421875*^9, 
   3.399805229609375*^9}, {3.399805281671875*^9, 3.3998052821875*^9}, {
   3.399805317390625*^9, 3.39980531784375*^9}, {3.399805361484375*^9, 
   3.399805406625*^9}, {3.399805464109375*^9, 3.39980549253125*^9}, {
   3.39980554003125*^9, 3.399805559671875*^9}, {3.39980573365625*^9, 
   3.3998058186875*^9}, {3.399805872171875*^9, 3.399805900765625*^9}, {
   3.3998059914375*^9, 3.399806032234375*^9}, {3.399806079171875*^9, 
   3.399806088203125*^9}, {3.399806137546875*^9, 3.399806165015625*^9}, 
   3.39980631121875*^9, {3.399806428796875*^9, 3.399806465421875*^9}, {
   3.399806513296875*^9, 3.399806530203125*^9}, {3.39980658909375*^9, 
   3.3998065908125*^9}, 3.3998066975*^9, {3.3998067385625*^9, 
   3.399806741984375*^9}, {3.3998068225625*^9, 3.399806822859375*^9}, {
   3.399806857140625*^9, 3.39980688875*^9}, {3.39980706328125*^9, 
   3.399807112625*^9}, {3.399807257734375*^9, 3.399807315796875*^9}, {
   3.3998078945625*^9, 3.39980789490625*^9}, {3.399807937*^9, 
   3.3998079471875*^9}, {3.39980801978125*^9, 3.399808040296875*^9}, {
   3.399808643046875*^9, 3.399808646140625*^9}, {3.399808687984375*^9, 
   3.39980885309375*^9}, {3.399808903359375*^9, 3.39980892865625*^9}, {
   3.3998089685*^9, 3.399809003234375*^9}, {3.399809437359375*^9, 
   3.3998094624375*^9}, {3.399812059890625*^9, 3.39981207515625*^9}, {
   3.399812131734375*^9, 3.399812138*^9}, 3.3998121695625*^9, {
   3.39981353325*^9, 3.399813571953125*^9}, {3.399813617515625*^9, 
   3.399813626234375*^9}, {3.399813699234375*^9, 3.399813699515625*^9}, {
   3.399813804234375*^9, 3.3998138060625*^9}, {3.39981383925*^9, 
   3.39981387409375*^9}, {3.399813927859375*^9, 3.39981393828125*^9}, 
   3.3998140469375*^9, {3.39981412225*^9, 3.399814122421875*^9}, {
   3.39981418846875*^9, 3.399814290703125*^9}, {3.399814334671875*^9, 
   3.3998143513125*^9}, {3.399814490453125*^9, 3.39981451796875*^9}, {
   3.39981469209375*^9, 3.399814739890625*^9}, {3.399814807578125*^9, 
   3.399814850109375*^9}, {3.399814894140625*^9, 3.3998149041875*^9}, 
   3.399814940359375*^9, {3.39981499978125*^9, 3.399815007609375*^9}, {
   3.39981503803125*^9, 3.399815067671875*^9}, {3.3998152955625*^9, 
   3.399815300875*^9}, {3.3998153395625*^9, 3.39981536596875*^9}, {
   3.3998154519375*^9, 3.399815456421875*^9}, {3.3998167785625*^9, 
   3.399817003328125*^9}, {3.39981748321875*^9, 3.399817488359375*^9}, {
   3.39981752996875*^9, 3.399817544953125*^9}, {3.3998176238125*^9, 
   3.399817689171875*^9}, {3.3998182713125*^9, 3.399818281953125*^9}, {
   3.400065533703125*^9, 3.4000655338125*^9}, 3.400066499078125*^9, 
   3.400066567125*^9, {3.40022856978125*^9, 3.40022860265625*^9}, {
   3.400246474265625*^9, 3.400246477828125*^9}, {3.400313103421875*^9, 
   3.40031310365625*^9}, {3.40031340453125*^9, 3.400313405875*^9}, 
   3.400913551328125*^9, {3.40092106834375*^9, 3.400921072484375*^9}, {
   3.4009211148125*^9, 3.40092113275*^9}, 3.4009400641875*^9, {
   3.402396705421875*^9, 3.40239671475*^9}, {3.404486792578125*^9, 
   3.404486795671875*^9}, 3.404553764515625*^9, 3.404652035265625*^9, {
   3.404742854203125*^9, 3.40474286246875*^9}, {3.4047433488125*^9, 
   3.404743371765625*^9}, {3.4047434075625*^9, 3.404743424234375*^9}, {
   3.40474385228125*^9, 3.40474386396875*^9}, 3.40506599040075*^9, {
   3.40506705815075*^9, 3.405067058291375*^9}, {3.40507001652575*^9, 
   3.405070020853875*^9}, 3.405174842322625*^9, {3.405175980135125*^9, 
   3.4051759802445*^9}, {3.40517605115075*^9, 3.405176053510125*^9}, {
   3.405347353640625*^9, 3.405347362*^9}, 3.4060317349375*^9, {
   3.406034676640625*^9, 3.406034682140625*^9}, {3.4060350235*^9, 
   3.40603506378125*^9}, {3.40603518359375*^9, 3.40603518625*^9}, {
   3.40603521959375*^9, 3.406035311734375*^9}, {3.406035484328125*^9, 
   3.40603548440625*^9}, {3.4060355195*^9, 3.40603552171875*^9}, 
   3.40603558621875*^9, {3.40603562325*^9, 3.406035630171875*^9}, {
   3.4060357995625*^9, 3.4060358579375*^9}, {3.40603600509375*^9, 
   3.406036012296875*^9}, {3.406036104015625*^9, 3.4060361326875*^9}, {
   3.406036809453125*^9, 3.406036833328125*^9}, {3.40603688309375*^9, 
   3.4060369260625*^9}, {3.40603716503125*^9, 3.40603718265625*^9}, {
   3.406037214546875*^9, 3.40603724534375*^9}, {3.4060373131875*^9, 
   3.406037347421875*^9}, {3.406037412609375*^9, 3.406037428515625*^9}, {
   3.4060374625*^9, 3.4060374796875*^9}, {3.40603759159375*^9, 
   3.406037659109375*^9}, {3.406037805203125*^9, 3.406037818140625*^9}, {
   3.40603801615625*^9, 3.406038017734375*^9}, {3.4060381910625*^9, 
   3.406038200734375*^9}, {3.406038327453125*^9, 3.406038343828125*^9}, {
   3.40603846653125*^9, 3.406038472515625*^9}, 3.406038557796875*^9, {
   3.406040687015625*^9, 3.406040710546875*^9}, {3.406280406140625*^9, 
   3.406280456265625*^9}, {3.406280498515625*^9, 3.406280517734375*^9}, {
   3.406280653484375*^9, 3.406280714359375*^9}, {3.4062816714375*^9, 
   3.406281672640625*^9}, 3.414401783513013*^9, {3.414409279644401*^9, 
   3.414409289582151*^9}, {3.414409364039494*^9, 3.414409366500576*^9}, 
   3.414417835626969*^9, {3.41441789078294*^9, 3.414417898807214*^9}, {
   3.420278519546875*^9, 3.420278524796875*^9}, 3.4202796783125*^9, {
   3.420284523921875*^9, 3.42028452559375*^9}, 3.420286223546875*^9, {
   3.420529808453125*^9, 3.42052981190625*^9}, 3.42052986440625*^9, {
   3.4205298948125*^9, 3.420529950328125*^9}, {3.420529989015625*^9, 
   3.420529996171875*^9}, {3.420530028015625*^9, 3.4205300735*^9}, {
   3.4205301146875*^9, 3.42053019921875*^9}, {3.42053023296875*^9, 
   3.42053024925*^9}, 3.42053028765625*^9, {3.420530375140625*^9, 
   3.420530379953125*^9}, {3.420530505921875*^9, 3.42053052959375*^9}, {
   3.420530602359375*^9, 3.420530612140625*^9}, 3.42053064584375*^9, {
   3.42053095425*^9, 3.42053098296875*^9}, {3.420531037421875*^9, 
   3.42053104859375*^9}, {3.4205312676875*^9, 3.420531318703125*^9}, 
   3.420531358765625*^9, {3.4205314729375*^9, 3.420531609140625*^9}, 
   3.420976137246406*^9, 3.429460546905575*^9, 3.437727390600199*^9, 
   3.437728278903869*^9, {3.437728321245571*^9, 3.437728321751776*^9}, {
   3.438619010366414*^9, 3.438619022489741*^9}, {3.438619066191964*^9, 
   3.438619068160867*^9}, {3.438619100011569*^9, 3.438619133855864*^9}, 
   3.438619170376259*^9, {3.43862053184544*^9, 3.438620551966106*^9}, 
   3.438620639067306*^9, {3.438620670579897*^9, 3.438620713099102*^9}, {
   3.438620871479916*^9, 3.438620914848819*^9}, {3.438620979828219*^9, 
   3.43862099253202*^9}, {3.438621212477171*^9, 3.438621240507935*^9}, {
   3.438621465659021*^9, 3.438621506049844*^9}, {3.438621564980311*^9, 
   3.438621567035344*^9}, {3.438621622037555*^9, 3.438621623007558*^9}, {
   3.438621718317544*^9, 3.438621736096957*^9}, {3.43862189823144*^9, 
   3.438621901361105*^9}, 3.438621937069757*^9, {3.43867829536051*^9, 
   3.438678310929396*^9}, {3.438678425297288*^9, 3.438678454298687*^9}, {
   3.438683101738461*^9, 3.438683165112142*^9}, {3.43868319738669*^9, 
   3.438683202009415*^9}, {3.438690599068225*^9, 3.438690606326596*^9}, {
   3.44923427867877*^9, 3.449234298430051*^9}, {3.449234416045777*^9, 
   3.449234421962764*^9}, {3.449307258838765*^9, 3.449307264607618*^9}, {
   3.451382143851587*^9, 3.451382166862642*^9}, {3.451382259654386*^9, 
   3.451382276686637*^9}, 3.451382343273336*^9, 3.451382500740885*^9, {
   3.46262917354086*^9, 3.462629189768675*^9}, {3.462629227667561*^9, 
   3.462629236867478*^9}, {3.462629320331965*^9, 3.462629357614324*^9}, 
   3.462629401555023*^9, {3.4626294359426126`*^9, 3.4626295735868607`*^9}, {
   3.462629667946958*^9, 3.462629669149992*^9}, {3.4626297282441874`*^9, 
   3.462629731033882*^9}, {3.4626299374241037`*^9, 3.462629944992579*^9}, {
   3.4626301104170094`*^9, 3.462630185983773*^9}, {3.462630715164564*^9, 
   3.462630716793955*^9}, {3.462630806991558*^9, 3.462630844519964*^9}, 
   3.4686778062860603`*^9, {3.468944045090054*^9, 3.468944047449769*^9}, 
   3.468944079206318*^9, {3.471696585467494*^9, 3.471696594263567*^9}, {
   3.474392810439081*^9, 3.4743928357163486`*^9}, {3.474749678170759*^9, 
   3.4747496784126062`*^9}, {3.474830186682926*^9, 3.474830186993557*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["d. Net-CDF", "Subsubtitle",
 CellChangeTimes->{{3.400066391859375*^9, 3.400066413671875*^9}, 
   3.4000664990625*^9, 3.400066567125*^9, {3.406040935703125*^9, 
   3.40604096303125*^9}, 3.406287839828125*^9, {3.420526479515625*^9, 
   3.420526493203125*^9}, {3.42052699359375*^9, 3.42052699875*^9}, 
   3.42053286221875*^9, 3.438600159033955*^9, {3.450608951926087*^9, 
   3.450608966036371*^9}, {3.463396747513672*^9, 3.46339676171281*^9}, {
   3.471704561699224*^9, 3.471704584217307*^9}}],

Cell[CellGroupData[{

Cell["i. Set-up", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.451643580850363*^9, 3.451643593138852*^9}, {3.452437407931332*^9, 
   3.452437410942711*^9}, {3.463396764040374*^9, 3.46339678086306*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"years1s", "=", 
   RowBox[{"nnetcdfyearss", "=", 
    RowBox[{"Table", "[", 
     RowBox[{",", 
      RowBox[{"{", "nparts", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"netcdfdataalls", "=", 
   RowBox[{"yearsalls", "=", 
    RowBox[{"netcdfdataalls", "=", 
     RowBox[{"nnetcdfyears2alls", "=", 
      RowBox[{"controls", "=", 
       RowBox[{"nrunss", "=", 
        RowBox[{"varstyless", "=", 
         RowBox[{
          StyleBox["ensemblenoss", "MT"], 
          StyleBox["=", "MT"], 
          RowBox[{"Table", "[", 
           RowBox[{",", 
            RowBox[{"{", "nensem", "}"}], ",", 
            RowBox[{"{", "nparts", "}"}]}], "]"}]}]}]}]}]}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4633963981670437`*^9, 3.4633964398916817`*^9}, {
  3.4633964852831917`*^9, 3.4633964923027163`*^9}, {3.469369748052761*^9, 
  3.469369751587716*^9}, {3.469369832943206*^9, 3.46936984754307*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ensemblename", "=", 
      RowBox[{"ensembleroot", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensemshort", "=", 
      RowBox[{"ensemblerootshort", "~~", 
       RowBox[{"ensembles", "[", 
        RowBox[{"[", "e", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ensembledatafile", "=", 
      RowBox[{"ensemblename", "~~", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"config", "=", 
      RowBox[{"configs", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"configshort", "=", 
      RowBox[{"configshorts", "[", 
       RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\\nReading in data for \>\"", ",", "ensemblename", ",", 
       "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"resultsfolder", "=", 
      RowBox[{"resultsfoldersuffix", "~~", "ensemblename"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "[", "resultsfolder", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Part : \>\"", ",", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "f", "]"}], "]"}], ",", "\"\<...\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotstartyear", "=", 
         RowBox[{"plotstartyears", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nyears", "=", 
         RowBox[{"nyearss", "[", 
          RowBox[{"[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<nyears = \>\"", ",", "nyears", ",", "\"\<\\n\\n\>\""}], "]"}],
           ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Part", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", "configroot", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", "ensembledatafile", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<data//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"data", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tagmarkervariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
              "\[Equal]", "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"tagmarkervariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"origtagmarkervariables", "=", "tagmarkervariables"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tagmarkervariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<tagmarkervariables//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"tagmarkervariables", "//", "TableForm"}], ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nvar", "=", 
         RowBox[{"Length", "[", "tagmarkervariables", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vartitles", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vartitlesshort", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"varvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"tagmarkervariables", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"2", "+", "j"}]}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"tagmarkervariables", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "2"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<vartitles, vartitlesshort, varvalues:\\n\\n\>\"", ",", 
            "vartitles", ",", "vartitlesshort", ",", "varvalues", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nvars", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"varvalues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "1"}], ",", 
          RowBox[{"control", "=", "1"}], ",", 
          RowBox[{"control", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"nvars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", 
               RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"controls", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "control"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nruns", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"nvars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrunss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "nruns"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nvar", "\[Equal]", "4"}], ",", 
          RowBox[{"varstyles", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"varstyles", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"varstyless", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "varstyles"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemtitles", "=", 
         RowBox[{"Tuples", "[", "varvalues", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<nvars, control, nruns, nvar, varstyles, \
ensemtitles:\\n\\n\>\"", ",", "nvars", ",", "\"\<, \>\"", ",", "control", 
            ",", "\"\<, \>\"", ",", "nruns", ",", "\"\<, \>\"", ",", "nvar", 
            ",", "\"\<, \>\"", ",", "varstyles", ",", "\"\<, \>\"", ",", 
            "ensemtitles", ",", "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ensemblevariables", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "individual"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], "!=",
               "tagmarker"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"ensemblevariables", ",", 
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenos", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nvar"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ensemblenoss", "[", 
          RowBox[{"[", 
           RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "ensemblenos"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ensemblenames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"ensemblenos", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"ensemblenos", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ensemblevariables//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"ensemblevariables", "//", "TableForm"}], ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ensemblenos:\\n\\n\>\"", ",", "ensemblenos", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ensemblenames:\\n\\n\>\"", ",", "ensemblenames", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Part", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nruns", "\[Equal]", "1"}], ",", 
          RowBox[{"runids", "=", 
           RowBox[{"{", "configshort", "}"}]}], ",", 
          RowBox[{
           RowBox[{"runids", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
              "configshort", "~~", "\"\<.\>\"", "~~", "ensemshort", "~~", 
               "\"\<_\>\"", "~~", 
               RowBox[{"ensemblenames", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", "f", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nruns"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<runids//TableForm:\\n\\n\>\"", ",", 
            RowBox[{"runids", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"filenames", "=", 
         RowBox[{"nfilenames", "=", 
          RowBox[{"shortfilenames", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "nmodules", "}"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetDirectory", "[", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
               RowBox[{"runids", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
               RowBox[{"modules", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{"\"\</\>\"", "\[Rule]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"system", "\[Equal]", "\"\<Windows\>\""}], ",", 
                 "\"\<\\\\\>\"", ",", "\"\</\>\""}], "]"}]}]}], "]"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"filenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"nfilenames", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"shortfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"{", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringCases", "[", 
                  RowBox[{
                   RowBox[{"FileNames", "[", "]"}], ",", "\"\<series\>\""}], 
                  "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
                RowBox[{"{", "\"\<series\>\"", "}"}]}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"filenames", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"FileNames", "[", "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"FileNames", "[", "]"}], "]"}]}], "}"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Length", "[", 
             RowBox[{"filenamenos", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"shortfilenames", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"o", "+", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"j", "\[Equal]", "1"}], ",", "0", ",", 
                   RowBox[{"nfilenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{
                    RowBox[{"filenames", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", 
                    RowBox[{"filenamenos", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "o"}], "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"15", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", 
                RowBox[{"nfilenames", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"i", ",", 
              RowBox[{"shortfilenames", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nmodules"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"7", " ", 
           RowBox[{"a", ".", " ", "Net"}]}], "-", 
          RowBox[{"CDF", " ", "set"}], "-", "up"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"years1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
              RowBox[{"ToString", "[", 
               RowBox[{"dimensions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "1"}], "]"}], "]"}], "]"}], "~~", 
              "\"\<d.nc\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Datasets\>\"", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                 "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"years1s", "[", 
          RowBox[{"[", "f", "]"}], "]"}], "=", "years1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<years1:\\n\>\"", ",", 
          RowBox[{"years1", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nnetcdfyears", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"years1", "[", 
             RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nnetcdfyearss", "[", 
          RowBox[{"[", "f", "]"}], "]"}], "=", "nnetcdfyears"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allnames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
              RowBox[{"ToString", "[", 
               RowBox[{"dimensions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
              "\"\<d.nc\>\""}], ",", 
             RowBox[{"{", "\"\<Datasets\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"datanames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"allnames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"nhousekeepingdata", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"Length", "[", 
              RowBox[{"allnames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ";", 
        RowBox[{
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "5", "}"}], ",", 
             RowBox[{"{", "6", "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<datanames:\\n\>\"", ",", 
          RowBox[{"datanames", "//", "TableForm"}], ",", "\"\<\\n\\n\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nrealdata", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"datanames", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"annotations", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
              RowBox[{"ToString", "[", 
               RowBox[{"dimensions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
              "\"\<d.nc\>\""}], ",", 
             RowBox[{"{", "\"\<Annotations\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"annotations", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"annotations", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{
              RowBox[{"nhousekeepingdata", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"Length", "[", 
              RowBox[{"allnames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ";", 
        RowBox[{"headings", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"annotations", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "l", ",", "i", ",", "1"}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"nrealdata", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"annotations", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "]"}]}], 
            "}"}]}], "]"}]}], ";", 
        RowBox[{"unitposition", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"headings", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                "\"\<units\>\""}], "]"}], "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"headings", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                "\"\<units\>\""}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"nrealdata", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"units", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"unitposition", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "\[Equal]", 
              "0"}], ",", "\"\<\>\"", ",", 
             RowBox[{"annotations", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d", ",", "l", ",", 
                RowBox[{"unitposition", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", "2"}],
                "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"nrealdata", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"longnameposition", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"headings", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                "\"\<long_name\>\""}], "]"}], "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"headings", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", 
                "\"\<long_name\>\""}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"nrealdata", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"longnames", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"longnameposition", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "\[Equal]", 
              "0"}], ",", "\"\<\>\"", ",", 
             RowBox[{"annotations", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d", ",", "l", ",", 
                RowBox[{"longnameposition", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], ",", "2"}],
                "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"d", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{"nrealdata", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"varmultipliers", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{"nvars", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "nvar", ",", 
                  RowBox[{"nvar", "-", "m"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "0", ",", 
                RowBox[{"nvar", "-", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"netcdfstartyearnos", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"genielatsused", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"180", "*", 
             RowBox[{
              RowBox[{"ArcSin", "[", 
               RowBox[{"k", "/", 
                RowBox[{"(", 
                 RowBox[{"genielat", "/", "2"}], ")"}]}], "]"}], "/", 
              "\[Pi]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"genielat", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"genielatsused", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Reverse", "[", "genielatsused", "]"}]}], ",", "0", ",", 
            "genielatsused"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"latdiffs", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Differences", "[", "genielatsused", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"genielatsused", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], "+", 
          RowBox[{"latdiffs", "/", "2."}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"landmask1", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"landmaskfile", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
        RowBox[{"landmask2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"StringDrop", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{
                   RowBox[{"landmask1", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"\"\<  \>\"", "\[Rule]", "\"\< 0\>\""}]}], "]"}], 
                 ",", "1"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"3", "*", "i"}], "-", "2"}], ",", 
                 RowBox[{
                  RowBox[{"3", "*", "i"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"genielon", "+", "2"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"genielat", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"landmask3", "=", 
         RowBox[{"ToExpression", "[", "landmask2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"landmask4", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"landmask3", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "genielat"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"landmask", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"landmask4", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "90"}], ",", "1", 
             ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "genielat"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"landmask", "=", 
         RowBox[{"Reverse", "[", "landmask", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"landmask4", "=", 
         RowBox[{"Reverse", "[", "landmask4", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"seamask", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"landmask", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}], ",",
              "1", ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "genielat"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oceanmask", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"landmask4", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[LessEqual]", 
              RowBox[{"nlevels", "+", "1", "-", "z"}]}], ",", "1", ",", "0"}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "nlevels"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "genielat"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ArrayPlot", "[", "seamask", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"masknames", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<land and sea\>\"", ",", "\"\<land only\>\"", ",", 
           "\"\<sea only\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "alpha", "=", 
         "\"\<abcdefghijklmnopqrstuvABCDEFGHIJKLMNOPQRSTUVwWxXyYzZ+-\
0123456789abcdefgh\>\""}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"readinalldata", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"netcdfdataall", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                 RowBox[{"runids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"dimensions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                 "\"\<d.nc\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Datasets\>\"", ",", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "1"}], 
               RowBox[{"(*", 
                RowBox[{"Length", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"nrealdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"yearsall", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                 RowBox[{"runids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "~~", "\"\</\>\"", "~~", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"dimensions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                 "\"\<d.nc\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Datasets\>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                    "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "1"}], 
               RowBox[{"(*", 
                RowBox[{"Length", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"nrealdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"nnetcdfyears2all", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"netcdfdataall", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "m", ",", "1", ",", "1"}], "]"}], "]"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nruns"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"netcdfdataalls", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "netcdfdataall"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"yearsalls", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", "yearsall"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nnetcdfyears2alls", "[", 
             RowBox[{"[", 
              RowBox[{"e", ",", "f"}], "]"}], "]"}], "=", 
            "nnetcdfyears2all"}], ";", "\[IndentingNewLine]", 
           RowBox[{"netcdfdataalls", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"netcdfdataall", ",", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", ">", "bignumber"}], "&"}], ")"}]}], ",", 
              "Infinity"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"maxima", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"netcdfdataall", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "m", ",", "d", ",", "l", ",", "All"}], 
                 "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "1"}], 
               RowBox[{"(*", 
                RowBox[{"Length", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"nrealdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";", 
           RowBox[{"minima", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"netcdfdataall", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "m", ",", "d", ",", "l", ",", "All"}], 
                 "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "1"}], 
               RowBox[{"(*", 
                RowBox[{"Length", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], "*)"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"nrealdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           ";"}], "*)"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"f", ",", "3", ",", "nparts"}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"e", ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.462023119991692*^9, 3.462023120174494*^9}, {
   3.462023152618473*^9, 3.462023171464966*^9}, {3.462027168680149*^9, 
   3.4620271843876534`*^9}, {3.4620275647999973`*^9, 
   3.4620275749029408`*^9}, {3.462027606071335*^9, 3.462027621874998*^9}, {
   3.462027679867908*^9, 3.462027681146803*^9}, {3.4620294356299257`*^9, 
   3.462029590466146*^9}, {3.462029697523219*^9, 3.4620297340242453`*^9}, {
   3.462029768246172*^9, 3.4620297901553717`*^9}, {3.4620299192473783`*^9, 
   3.462029934972437*^9}, {3.46203007899965*^9, 3.462030144538355*^9}, {
   3.462030237395691*^9, 3.46203025064009*^9}, {3.4620303074841833`*^9, 
   3.462030307834057*^9}, {3.462030354104141*^9, 3.462030373901606*^9}, {
   3.46203063307268*^9, 3.462030633281682*^9}, {3.4620306979607773`*^9, 
   3.462030698929603*^9}, {3.462030890050074*^9, 3.462030894121662*^9}, {
   3.462031067517426*^9, 3.4620310754767*^9}, {3.4620316640550547`*^9, 
   3.462031703662437*^9}, {3.4620317736911917`*^9, 3.4620317791029243`*^9}, {
   3.46203181627775*^9, 3.4620319722989607`*^9}, {3.462033454107682*^9, 
   3.462033600422317*^9}, 3.4620336314862823`*^9, {3.462033673992259*^9, 
   3.462033699466103*^9}, {3.462034093968981*^9, 3.462034096160631*^9}, {
   3.462035485643231*^9, 3.462035544506846*^9}, {3.462035615518898*^9, 
   3.4620357298205853`*^9}, {3.462035783748323*^9, 3.462035844139016*^9}, {
   3.4620359248029213`*^9, 3.462036146610056*^9}, {3.462036246494248*^9, 
   3.462036248914403*^9}, {3.462036443746531*^9, 3.4620364442141323`*^9}, {
   3.462036586919578*^9, 3.46203662762276*^9}, {3.4620375178918343`*^9, 
   3.4620375267104683`*^9}, {3.462037598239778*^9, 3.462037602912957*^9}, {
   3.462037844547433*^9, 3.4620378929806843`*^9}, {3.46203796389797*^9, 
   3.462037994071233*^9}, {3.462038094089937*^9, 3.462038114087219*^9}, {
   3.4620382283005743`*^9, 3.462038231585988*^9}, 3.462038663605668*^9, {
   3.462038843990191*^9, 3.4620388621787233`*^9}, {3.462038901161792*^9, 
   3.462038901769342*^9}, {3.462039208751321*^9, 3.4620392539631577`*^9}, {
   3.462039435315106*^9, 3.462039435718238*^9}, {3.462039480282207*^9, 
   3.462039486138102*^9}, {3.4620397234860773`*^9, 3.4620397314375057`*^9}, {
   3.462039808834046*^9, 3.462039848088181*^9}, 3.462040084749372*^9, {
   3.462040439274733*^9, 3.4620404871811123`*^9}, 3.462040546329947*^9, {
   3.462187970323617*^9, 3.462187983177383*^9}, {3.462188090049431*^9, 
   3.4621881995566883`*^9}, {3.462188278317587*^9, 3.462188358717417*^9}, {
   3.4621884196754313`*^9, 3.46218842222663*^9}, {3.462188472830637*^9, 
   3.462188474276726*^9}, {3.462195138358865*^9, 3.4621951407743807`*^9}, {
   3.4621951757348957`*^9, 3.462195210794283*^9}, {3.462195903683641*^9, 
   3.462196098030435*^9}, 3.462196142816847*^9, {3.462196184645949*^9, 
   3.4621961865007153`*^9}, {3.46219641027136*^9, 3.462196518606509*^9}, {
   3.462196551452675*^9, 3.462196553901932*^9}, {3.462196973638564*^9, 
   3.4621969741670303`*^9}, {3.462197296986328*^9, 3.462197315419482*^9}, {
   3.462197411144545*^9, 3.462197427938244*^9}, {3.462197595039559*^9, 
   3.462197620937151*^9}, {3.462197662445116*^9, 3.462197673337544*^9}, {
   3.46219771007908*^9, 3.4621977128792887`*^9}, {3.462197751233556*^9, 
   3.4621977587191133`*^9}, {3.462197881927001*^9, 3.462197900906637*^9}, {
   3.462197939492391*^9, 3.462197957679785*^9}, {3.462198102706747*^9, 
   3.462198106991476*^9}, {3.4621981713990803`*^9, 3.4621981725134897`*^9}, {
   3.462198230109116*^9, 3.46219823077197*^9}, {3.462198262121468*^9, 
   3.462198292886181*^9}, {3.46219833215615*^9, 3.462198333234126*^9}, 
   3.4621984180876837`*^9, {3.462198477851308*^9, 3.462198548375444*^9}, {
   3.4621987818489437`*^9, 3.462198784373178*^9}, {3.462199007933352*^9, 
   3.462199010251566*^9}, {3.4621991258493147`*^9, 3.462199208053434*^9}, {
   3.462199239396435*^9, 3.4621992429052067`*^9}, {3.462199365748365*^9, 
   3.462199381613991*^9}, {3.4621997324662848`*^9, 3.462199732705737*^9}, {
   3.462199871581491*^9, 3.462199874926354*^9}, 3.462199969348154*^9, {
   3.46220003255376*^9, 3.4622000364053383`*^9}, {3.462201074600865*^9, 
   3.462201074946677*^9}, {3.4626138337239428`*^9, 3.462613838005012*^9}, {
   3.462613879381761*^9, 3.462613920332706*^9}, {3.4626141771984873`*^9, 
   3.462614177537417*^9}, {3.4626144140254583`*^9, 3.462614425079198*^9}, {
   3.462614585223283*^9, 3.462614615694049*^9}, {3.4626146488979683`*^9, 
   3.462614657527609*^9}, {3.462614833802204*^9, 3.462614883970093*^9}, {
   3.462615062445517*^9, 3.462615089644796*^9}, {3.462615140640809*^9, 
   3.4626151471019573`*^9}, {3.462615180213472*^9, 3.4626152117662077`*^9}, {
   3.462615254223653*^9, 3.462615307899673*^9}, {3.4626155122526007`*^9, 
   3.4626155148583183`*^9}, {3.4626155960897703`*^9, 3.462615651664625*^9}, {
   3.462617389327629*^9, 3.46261739324863*^9}, {3.462625674218556*^9, 
   3.4626256744259233`*^9}, 3.462627569759968*^9, {3.462627607450924*^9, 
   3.462627629647564*^9}, {3.4626300111860027`*^9, 3.462630012281993*^9}, {
   3.462630051109071*^9, 3.46263007178727*^9}, {3.463394191029155*^9, 
   3.46339419867101*^9}, {3.463394255776709*^9, 3.463394290647257*^9}, {
   3.463394362903963*^9, 3.46339437502932*^9}, {3.463396237121316*^9, 
   3.463396244972365*^9}, {3.463396351476802*^9, 3.463396369548668*^9}, {
   3.4633964599411297`*^9, 3.463396461091238*^9}, {3.4633965143861437`*^9, 
   3.463396606652658*^9}, {3.468686429390354*^9, 3.46868644762901*^9}, {
   3.4686879089710073`*^9, 3.468687911328923*^9}, {3.468782303275342*^9, 
   3.468782310947288*^9}, {3.4693744665750713`*^9, 3.469374468887043*^9}, {
   3.4693745360510674`*^9, 3.469374614738885*^9}, {3.469374677893404*^9, 
   3.469374731011705*^9}, {3.469374864802157*^9, 3.4693748726348553`*^9}, {
   3.469374933995308*^9, 3.4693749720617437`*^9}, {3.469381173643161*^9, 
   3.4693811859114923`*^9}, {3.471627976520815*^9, 3.471627979000306*^9}, {
   3.471628074750338*^9, 3.47162809705338*^9}, {3.4716281346538763`*^9, 
   3.471628135994499*^9}, {3.485863000410223*^9, 3.485863001303218*^9}, 
   3.485863477343564*^9, {3.488208296954698*^9, 3.4882083003936987`*^9}, {
   3.488208428946093*^9, 3.488208429095221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoAxisPlotLats", "[", 
   RowBox[{"f_List", ",", "g_List", ",", 
    RowBox[{
     RowBox[{"(", "opts___", ")"}], "?", "OptionQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "old", ",", "new", ",", "scale", ",", "gmax", ",", "gmin", ",", "fmax", 
      ",", "fmin", ",", "newg", ",", "var"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     
     RowBox[{"gmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     
     RowBox[{"fmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "f", "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"scale", "[", "var_", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"var", "-", "gmin"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"fmax", "-", "fmin"}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gmax", "-", "gmin"}], "\[Equal]", "0."}], ",", 
          RowBox[{"fmax", "-", "fmin"}], ",", 
          RowBox[{"gmax", "-", "gmin"}]}], "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"old", "=", 
      RowBox[{
       RowBox[{"FullOptions", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"gmin", ",", "gmax"}], "}"}], ",", "Automatic"}], 
             "}"}]}], ",", 
           RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",", 
         "FrameTicks"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "#1", "]"}], ",", 
           RowBox[{"fmin", "+", 
            RowBox[{"scale", "[", 
             RowBox[{"First", "[", "#1", "]"}], "]"}]}]}], "]"}], "&"}], 
        ")"}], "/@", "old"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newg", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "g", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"fmin", "+", 
          RowBox[{"Map", "[", 
           RowBox[{"scale", ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "g", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "newg"}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], "]"}], 
          ",", "new", ",", "None"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", "Orange", "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "Orange", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "opts"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.451989927298582*^9, 3.451989928809999*^9}, {
   3.451989958928624*^9, 3.45198997913608*^9}, {3.451990022799751*^9, 
   3.451990051437392*^9}, {3.451990285247006*^9, 3.451990302756122*^9}, {
   3.45199075028666*^9, 3.45199075614516*^9}, 3.45199119943117*^9, {
   3.451991272658506*^9, 3.451991307742119*^9}, {3.45199137279675*^9, 
   3.451991382703586*^9}, {3.451991454645873*^9, 3.45199148042833*^9}, {
   3.451991609065679*^9, 3.451991626698045*^9}, {3.451993930857343*^9, 
   3.451993935364797*^9}, {3.451994608027352*^9, 3.451994617767793*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"module", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"v", "[", "n_Integer", "]"}], "]"}], ":=", 
   RowBox[{"\"\<v\>\"", "<>", 
    RowBox[{"ToString", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"v", ",", "nvar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Evaluate", "[", "list", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], "]"}], "-", "1"}], 
          ")"}], "*", "varmultipliers"}], "]"}], "+", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", "##"}], "]"}], "&"}], "@", 
  RowBox[{"(", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", 
              RowBox[{"vartitles", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", "\[Rule]", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"nvars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "\"\<variable\>\""}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "->", 
             RowBox[{"datanames", "[", 
              RowBox[{"[", 
               RowBox[{"module", ",", "1", ",", "i"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nrealdata", "[", 
               RowBox[{"[", 
                RowBox[{"module", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "1", ",", "\"\<year\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"years1", "[", 
            RowBox[{"[", 
             RowBox[{"module", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nnetcdfyears", "[", 
             RowBox[{"[", "module", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}]}], "]"}]}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.450617805311666*^9, 3.450617831693424*^9}, {
   3.450617862512347*^9, 3.45061797478856*^9}, {3.450618289131166*^9, 
   3.450618290406129*^9}, {3.450619804129897*^9, 3.450619893762245*^9}, {
   3.450620857342329*^9, 3.450620904942704*^9}, {3.450620966006999*^9, 
   3.450620987541548*^9}, {3.450621143485906*^9, 3.450621201438056*^9}, {
   3.450621238574245*^9, 3.450621292222734*^9}, {3.450621331711951*^9, 
   3.450621398908891*^9}, {3.450621749885786*^9, 3.45062180205707*^9}, {
   3.450621853269466*^9, 3.450621875362082*^9}, {3.450622003424978*^9, 
   3.450622028572551*^9}, {3.450776516835569*^9, 3.450776519064637*^9}, {
   3.45077657356817*^9, 3.45077657726025*^9}, 3.450777895409333*^9, {
   3.45077874369911*^9, 3.450778789904501*^9}, {3.451312224185126*^9, 
   3.451312225204768*^9}, {3.451911119921753*^9, 3.451911160924822*^9}, {
   3.452866111384938*^9, 3.452866190058579*^9}, 3.452875385994555*^9, {
   3.454756722306907*^9, 3.454756726152277*^9}, {3.454756756238483*^9, 
   3.454756756803073*^9}, {3.457419045303464*^9, 3.457419060384275*^9}}],

Cell[BoxData["varmultipliers"], "Input"],

Cell[BoxData["nvar"], "Input",
 CellChangeTimes->{{3.469381138858728*^9, 3.469381139734384*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"module", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Unique", "[", "\"\<v\>\"", "]"}], ",", 
     RowBox[{"{", "nvar", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Evaluate", "@", 
      RowBox[{"(", 
       RowBox[{"k", "=", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], "-", "1"}], ")"}],
            "*", "varmultipliers"}], "]"}], "+", "1"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "##"}], "]"}], "&"}], "@", 
  RowBox[{"(", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"j", "\[Rule]", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.457419078599979*^9, 3.45741908758792*^9}, {
  3.457419190988907*^9, 3.457419216191534*^9}, {3.4574192815598288`*^9, 
  3.457419288669751*^9}, {3.457419323251906*^9, 3.457419375926889*^9}, {
  3.4574194079816427`*^9, 3.45741941577921*^9}, {3.469369590941856*^9, 
  3.469369622811036*^9}, {3.46938136735931*^9, 3.4693813754949017`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ii. Individual graphs", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.451643580850363*^9, 3.451643593138852*^9}, {3.45243740052789*^9, 
   3.452437420207904*^9}, {3.463396766248412*^9, 3.463396792318267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", " ", "=", " ", 
   RowBox[{"d", " ", "=", " ", 
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"y", " ", "=", " ", "1"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", "\n", "   ", "\n", "   ", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", " ", "=", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "nvar"}], "}"}]}], "]"}], " ", "-", 
              " ", "1"}], ")"}], "*", "varmultipliers"}], "]"}], " ", "+", 
          " ", "1"}]}], ")"}], ";", "\n", "    ", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
         RowBox[{
          RowBox[{"netcdfdata1", " ", "=", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{
                "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
                 RowBox[{"runids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"",
                  " ", "~~", " ", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
                 "\"\</fields_\>\"", " ", "~~", " ", 
                 RowBox[{"netcdfmodules", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"",
                  " ", "~~", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"dimensions", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
                  " ", "\"\<d.nc\>\""}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"\"\<Datasets\>\"", ",", " ", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"3", ",", " ", "2", ",", " ", "1"}], "}"}]}], "]"}], 
            "[", 
            RowBox[{"[", "y", "]"}], "]"}]}], ";"}], ",", "\n", "     ", 
         RowBox[{"netcdfdata1", " ", "=", " ", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{
             "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", 
              " ", "~~", " ", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
              "\"\</fields_\>\"", " ", "~~", " ", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", 
              " ", "~~", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"dimensions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
               " ", "\"\<d.nc\>\""}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Datasets\>\"", ",", " ", 
               RowBox[{"datanames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "[", 
           RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"d", " ", "==", " ", "2"}], ",", " ", 
         RowBox[{"netcdfdata2", " ", "=", " ", 
          RowBox[{"netcdfdata1", "[", 
           RowBox[{"[", "b", "]"}], "]"}]}], ",", " ", 
         RowBox[{"netcdfdata2", " ", "=", " ", "netcdfdata1"}]}], "]"}], ";", 
       "\n", "    ", 
       RowBox[{"netcdfdata3", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"netcdfdata2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"j", " ", "+", " ", 
                RowBox[{"8", "*", 
                 RowBox[{"genielon", "/", "36"}]}]}], ",", " ", "genielon", 
               ",", " ", "1"}], "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", 
       RowBox[{"netcdfdata4", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"netcdfdata3", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "<", " ", 
             "bignumber"}], ",", " ", 
            RowBox[{"netcdfdata3", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", "0", ",", 
            " ", "0"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}]}], ";", "\n", 
       "    ", "\n", "    ", 
       RowBox[{"chart", " ", "=", " ", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"netcdfdata4", ",", " ", 
          RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", "800", "}"}]}], ",", " ", 
          RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
          RowBox[{
          "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}], ",",
           " ", 
          RowBox[{"PlotLabel", " ", "->", " ", 
           RowBox[{"StyleForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"runids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<: \>\"", 
              RowBox[{"(*", 
               RowBox[{"~~", 
                RowBox[{"varvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "v1"}], "]"}], "]"}], "~~", "\"\<; \>\"", 
                "~~", 
                RowBox[{"varvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "v2"}], "]"}], "]"}], "~~", "\"\<; \>\"", 
                "~~", 
                RowBox[{"varvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", 
                "~~", 
                RowBox[{"varvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", 
                "~~", 
                RowBox[{"varvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
              " ", "\"\<: \>\"", " ", "~~", " ", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
              " ", "~~", " ", "\"\<: \>\"", " ", "~~", " ", "\"\<year: \>\"", 
              " ", "~~", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"years1", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "y"}], "]"}], "]"}], "]"}]}], ",", 
             " ", 
             RowBox[{"FontSize", " ", "->", " ", "18"}], ",", " ", 
             RowBox[{"FontWeight", " ", "->", " ", "Bold"}]}], "]"}]}]}], 
         "]"}]}], ";", "\n", "    ", 
       RowBox[{"legend", " ", "=", " ", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
           "}"}], ",", " ", 
          RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", "800", "}"}]}], ",", " ", 
          RowBox[{"PlotLabel", " ", "->", " ", 
           RowBox[{
            RowBox[{"longnames", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", 
            "~~", " ", "\"\< (\>\"", " ", "~~", " ", 
            RowBox[{"units", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", 
            "~~", " ", "\"\<)\>\""}]}], ",", " ", 
          RowBox[{"FrameTicks", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", 
                   RowBox[{
                    RowBox[{"Min", "[", "netcdfdata4", "]"}], " ", "+", " ", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "netcdfdata4", "]"}], " ", "-", " ", 
                    RowBox[{"Min", "[", "netcdfdata4", "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "i", ",", " ", "0", ",", " ", "100", ",", " ", "10"}], 
                  "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", 
          " ", 
          RowBox[{
          "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
         "]"}]}], ";", "\n", "    ", "\n", "    ", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "chart", "}"}], ",", " ", 
          RowBox[{"{", "legend", "}"}]}], "}"}], "]"}]}], "]"}], ",", " ", 
     "##"}], "]"}], " ", "&"}], "@", 
  RowBox[{"(", 
   RowBox[{"Sequence", " ", "@@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "1", ",", " ", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"j", " ", "->", " ", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "nvar"}], "}"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.469380423662521*^9, 3.4693804418664618`*^9}, {
  3.4693804798324127`*^9, 3.469380527965499*^9}, {3.469380572667054*^9, 
  3.469380579613571*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\n", " ", "\n", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{
      RowBox[{"Intersection", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ensemblenos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}], 
           ",", " ", "v1"}], "]"}], "]"}], ",", "\n", "    ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ensemblenos", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}], 
           ",", " ", "v2"}], "]"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\n", "    ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v3"}], "]"}], "]"}], ",", "\n", "    ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v4"}], "]"}], "]"}], ",", "\n", "    ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ensemblenos", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "ensemblenos", "]"}]}], "}"}]}], "]"}],
             ",", "v5"}], "]"}], "]"}]}], "*)"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
      RowBox[{
       RowBox[{"netcdfdata1", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{
             "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
              RowBox[{"runids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", 
              " ", "~~", " ", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
              "\"\</fields_\>\"", " ", "~~", " ", 
              RowBox[{"netcdfmodules", "[", 
               RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", 
              " ", "~~", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"dimensions", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~",
               " ", "\"\<d.nc\>\""}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Datasets\>\"", ",", " ", 
               RowBox[{"datanames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"3", ",", " ", "2", ",", " ", "1"}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", "y", "]"}], "]"}]}], ";"}], ",", "\n", "  ", 
      RowBox[{"netcdfdata1", " ", "=", " ", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", " ", 
           "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
           "\"\</fields_\>\"", " ", "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", 
           "~~", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
           " ", "\"\<d.nc\>\""}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", " ", 
            RowBox[{"datanames", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
           "}"}]}], "]"}], "[", 
        RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}], ";", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"d", " ", "==", " ", "2"}], ",", " ", 
      RowBox[{"netcdfdata2", " ", "=", " ", 
       RowBox[{"netcdfdata1", "[", 
        RowBox[{"[", "b", "]"}], "]"}]}], ",", " ", 
      RowBox[{"netcdfdata2", " ", "=", " ", "netcdfdata1"}]}], "]"}], ";", 
    "\n", " ", 
    RowBox[{"netcdfdata3", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"netcdfdata2", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"j", " ", "+", " ", 
             RowBox[{"8", "*", 
              RowBox[{"genielon", "/", "36"}]}]}], ",", " ", "genielon", ",", 
            " ", "1"}], "]"}]}], "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"netcdfdata4", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata3", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "<", " ", 
          "bignumber"}], ",", " ", 
         RowBox[{"netcdfdata3", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", "0", ",", 
         " ", "0"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}]}], ";", "\n", " ",
     "\n", " ", 
    RowBox[{"chart", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"netcdfdata4", ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "800", "}"}]}], ",", " ", 
       RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
       RowBox[{"ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}],
        ",", " ", 
       RowBox[{"PlotLabel", " ", "->", " ", 
        RowBox[{"StyleForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<: \>\"", " ",
            "~~", " ", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", " ", 
           "\"\<; \>\"", " ", "~~", " ", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", " ", 
           "\"\<: \>\"", " ", "~~", " ", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
            " ", "\"\<: \>\"", " ", "~~", " ", "\"\<year: \>\"", " ", "~~", 
           " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"years1", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "y"}], "]"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"FontSize", " ", "->", " ", "18"}], ",", " ", 
          RowBox[{"FontWeight", " ", "->", " ", "Bold"}]}], "]"}]}]}], 
      "]"}]}], ";", "\n", " ", 
    RowBox[{"legend", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
        "}"}], ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "800", "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", " ", "->", " ", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\< (\>\"", " ", "~~", " ", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<)\>\""}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{
                 RowBox[{"Min", "[", "netcdfdata4", "]"}], " ", "+", " ", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Max", "[", "netcdfdata4", "]"}], " ", "-", " ", 
                    RowBox[{"Min", "[", "netcdfdata4", "]"}]}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "0", ",", " ", "100", ",", " ", "10"}], 
               "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{
       "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "chart", "}"}], ",", " ", 
       RowBox[{"{", "legend", "}"}]}], "}"}], "]"}]}], ",", "\n", " ", "\n", 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e", ",", "1", ",", "\"\<ensemble\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"ensembles", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nensem"}], "}"}]}], "]"}]}], "}"}], ",", "\n", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "1", ",", "\"\<part\>\""}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"partnames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nparts"}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "1", ",", " ", "\"\<module\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", " ", "1", ",", " ", "\"\<dimensions\>\""}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<2\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "1", ",", " ", "\"\<level\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nlevels"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1", ",", " ", "\"\<variable\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "d", ",", " ", "i"}], "]"}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}], ",", "\n",
    " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "1", ",", " ", "\"\<year\>\""}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"years1", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nnetcdfyears", "[", 
          RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}]}], "]"}]], 
 "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451904690667954*^9, 3.451904724436689*^9}, {
   3.451905748413416*^9, 3.451905761538444*^9}, {3.451905793054459*^9, 
   3.451905797664951*^9}, {3.451906615353841*^9, 3.451906641967217*^9}, {
   3.451906763708827*^9, 3.451906811731213*^9}, {3.451906862112333*^9, 
   3.451906975256681*^9}, 3.451907041712464*^9, {3.451907074188759*^9, 
   3.451907085035711*^9}, {3.451907144646903*^9, 3.451907148077466*^9}, 
   3.451907215918141*^9, {3.451907247193251*^9, 3.451907260573808*^9}, {
   3.451907298866304*^9, 3.451907301852639*^9}, {3.451907446751144*^9, 
   3.451907464901824*^9}, {3.451907585700777*^9, 3.451907587947188*^9}, 
   3.451911322287589*^9, {3.451911596042922*^9, 3.45191176792967*^9}, {
   3.451911825606143*^9, 3.451911859003392*^9}, 3.451912082621644*^9, {
   3.451912203356753*^9, 3.451912206403135*^9}, {3.451912543488776*^9, 
   3.45191256238585*^9}, {3.451915311113074*^9, 3.45191538179642*^9}, {
   3.451976583938813*^9, 3.451976600758172*^9}, {3.451976686076702*^9, 
   3.451976705036442*^9}, {3.451976761815172*^9, 3.451976774162069*^9}, {
   3.452868205412048*^9, 3.452868247566696*^9}, {3.452868292971577*^9, 
   3.45286829536006*^9}, {3.468782817140704*^9, 3.468782870035296*^9}, {
   3.468782902284903*^9, 3.4687829216991377`*^9}, {3.468783053758473*^9, 
   3.468783063284871*^9}, {3.468783100799759*^9, 3.468783102726471*^9}, {
   3.469379982022676*^9, 3.4693800081924562`*^9}, {3.469380346493321*^9, 
   3.469380349186511*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["iii. Animations", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, 
   3.45371310913145*^9, {3.463396767991651*^9, 3.463396795253776*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\n", " ", "\n", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
          "1"}], ")"}], "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], " ", "+", " ", "1"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "  ", "\n", 
      "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", " ", 
           "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
           "\"\</fields_\>\"", " ", "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", 
           "~~", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
           " ", "\"\<d.nc\>\""}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"m", " ", "==", " ", "4"}], ",", " ", "\"\<time\>\"", 
                ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            ">", " ", "bignumber"}], ",", " ", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            "=", " ", "0"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\n", "  ", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdfdata", " ", "=", " ", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"years", " ", "=", " ", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
    " ", "\n", " ", 
    RowBox[{"maxima", " ", "=", " ", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", " ", 
    RowBox[{"minima", " ", "=", " ", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"charttable1", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ArrayPlot", "[", 
        RowBox[{
         RowBox[{"netcdfdata", "[", 
          RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", "800", "}"}]}], ",", " ", 
         RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{
         "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}], ",", 
         " ", 
         RowBox[{"PlotRange", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"minima", ",", " ", "maxima"}], "}"}]}], ",", " ", 
         RowBox[{"PlotLabel", " ", "->", " ", 
          RowBox[{"StyleForm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"runids", "[", 
              RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<: \>\"", 
             " ", "~~", " ", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", " ", 
             "\"\<; \>\"", " ", "~~", " ", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"~~", "\"\<; \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", 
               RowBox[{"varvalues", "[", 
                RowBox[{"[", 
                 RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", " ", 
             "\"\<: \>\"", " ", "~~", " ", 
             RowBox[{"datanames", "[", 
              RowBox[{"[", 
               RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ",
              "~~", " ", "\"\<: \>\"", " ", "~~", " ", "\"\<year: \>\"", " ", 
             "~~", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"FontSize", " ", "->", " ", "18"}], ",", " ", 
            RowBox[{"FontWeight", " ", "->", " ", "Bold"}]}], "]"}]}]}], 
        "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
        "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"legend", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
        "}"}], ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "800", "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", " ", "->", " ", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\< (\>\"", " ", "~~", " ", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<)\>\""}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"minima", " ", "+", " ", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "0", ",", " ", "100", ",", " ", "10"}], 
               "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{
       "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"charttable1", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "}"}], ",", " ", 
           RowBox[{"{", "legend", "}"}]}], "}"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"nnetcdfyears2", " ", "-", " ", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", " ", 
      RowBox[{"DefaultDuration", " ", "->", " ", 
       RowBox[{"1", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", " ", "-", " ", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", " ", 
      RowBox[{"AnimationRunning", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"AnimatorElements", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", " ", "\"\<PlayPauseButton\>\"", ",", 
         " ", "\"\<StepLeftButton\>\"", ",", " ", "\"\<StepRightButton\>\"", 
         ",", " ", "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\n", " ", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "1", ",", " ", "\"\<module\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", " ", "1", ",", " ", "\"\<dimensions\>\""}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<2\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1", ",", " ", "\"\<output variable\>\""}], 
      "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "d", ",", " ", "i"}], "]"}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/movies\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"d", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"saveallgraphs", " ", "==", " ", "1"}], ",", "\n", " ", "\n", " ", 
   
   RowBox[{"Do", "[", "\n", "  ", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v1", ",", " ", "v2"}], 
             RowBox[{"(*", 
              RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
            "1"}], ")"}], "*", 
          RowBox[{"varmultipliers", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2"}], 
             RowBox[{"(*", 
              RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
         "]"}], " ", "+", " ", "1"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "   ", 
        "\n", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{
            "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
             RowBox[{"runids", "[", 
              RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", 
             " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
             "\"\</fields_\>\"", " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", 
             " ", "~~", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
             " ", "\"\<d.nc\>\""}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<Datasets\>\"", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                  "\"\<time\>\"", ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
                RowBox[{"datanames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}],
                "}"}]}], "}"}]}], "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "   ", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", ">", " ", "bignumber"}], ",", " ", 
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", "=", " ", "0"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
        "\n", "   ", "\n", "   ", 
        RowBox[{
         RowBox[{"netcdfdata", " ", "=", " ", 
          RowBox[{"netcdfdataall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"years", " ", "=", " ", 
          RowBox[{"yearsall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
      "  ", "\n", "  ", 
      RowBox[{"maxima", " ", "=", " ", 
       RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", 
      RowBox[{"minima", " ", "=", " ", 
       RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"legend", " ", "=", " ", 
       RowBox[{"ArrayPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
          "}"}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", "800", "}"}]}], ",", " ", 
         RowBox[{"PlotLabel", " ", "->", " ", 
          RowBox[{
           RowBox[{"longnames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
            " ", "\"\< (\>\"", " ", "~~", " ", 
           RowBox[{"units", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
            " ", "\"\<)\>\""}]}], ",", " ", 
         RowBox[{"FrameTicks", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"minima", " ", "+", " ", 
                   RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "i", ",", " ", "0", ",", " ", "100", ",", " ", "10"}], 
                 "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", 
         " ", 
         RowBox[{
         "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
        "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"charttable1", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
               RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
               RowBox[{"ImageSize", " ", "->", " ", 
                RowBox[{"{", "800", "}"}]}], ",", " ", 
               RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
               RowBox[{
               "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}],
                ",", " ", 
               RowBox[{"PlotRange", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{"minima", ",", " ", "maxima"}], "}"}]}], ",", " ", 
               RowBox[{"PlotLabel", " ", "->", " ", 
                RowBox[{"StyleForm", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"runids", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", 
                   "\"\<: \>\"", " ", "~~", " ", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", 
                   " ", "\"\<; \>\"", " ", "~~", " ", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
                   RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                    "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                    "\"\<: \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                   " ", "\"\<: \>\"", " ", "~~", " ", 
                   RowBox[{"datanames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}],
                    " ", "~~", " ", "\"\<: \>\"", " ", "~~", " ", 
                   "\"\<year: \>\"", " ", "~~", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}]}], ",", " ", 
                  RowBox[{"FontSize", " ", "->", " ", "18"}], ",", " ", 
                  RowBox[{"FontWeight", " ", "->", " ", "Bold"}]}], "]"}]}]}],
               "]"}], "}"}], ",", " ", 
            RowBox[{"{", "legend", "}"}]}], "}"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<_movie1.gif\>\""}], ",", " ", "charttable1"}], "]"}], 
      ";"}], ",", "\n", "  ", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
       RowBox[{"{", 
        RowBox[{"v4", ",", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ","}], "*)"}], "\n", "  ", 
     
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "nnetcdfmodules"}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1"}], 
      RowBox[{"(*", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}], "*)"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9, {3.469369970565373*^9, 
   3.469370314917918*^9}, {3.46937052333735*^9, 3.469370526628839*^9}, 
   3.469378561817862*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["iv. Lat-time graphs", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45287998691112*^9, 3.452879989810667*^9}, 3.452881268505181*^9, {
   3.453713111050006*^9, 3.453713111113981*^9}, {3.463396769304549*^9, 
   3.463396797741909*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlabdisp", " ", "=", " ", "10"}], ";", " ", 
   RowBox[{"ylabdisp", " ", "=", " ", "2"}], ";"}], "\n"}], "\n", 
 RowBox[{"Manipulate", "[", "\n", " ", "\n", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
          "1"}], ")"}], "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], " ", "+", " ", "1"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "  ", "\n", 
      "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", " ", 
           "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
           "\"\</fields_\>\"", " ", "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", 
           "~~", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
           " ", "\"\<d.nc\>\""}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"m", " ", "==", " ", "4"}], ",", " ", "\"\<time\>\"", 
                ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            ">", " ", "bignumber"}], ",", " ", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            "=", " ", "0"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\n", "  ", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdfdata", " ", "=", " ", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"years", " ", "=", " ", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
    " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", " ", "!=", " ", "1"}], ",", " ", 
      RowBox[{"netcdfdatamask", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "3"}], ",", " ", "seamask", ",", " ",
             "1"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "2"}], ",", " ", "landmask", ",", 
            " ", "1"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}]}], "]"}], ";", "\n", " ", 
    RowBox[{"latdata", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                 "0"}], "]"}], " ", "==", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"{", "0", "}"}], ",", " ", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", "0"}],
                "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "genielat", ",", " ", "1", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"netcdflattime", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"years", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", " ", "==", " ", "1"}], ",", " ", "i", ",", " ", 
             RowBox[{"genielatsused", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}]}], "]"}], ",", " ", 
       "1"}], "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"maxlattime", " ", "=", " ", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"netcdflattime", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "netcdflattime", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";", "\n", " ", 
    RowBox[{"minlattime", " ", "=", " ", 
     RowBox[{"Min", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"netcdflattime", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "netcdflattime", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"chart", " ", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"netcdflattime", ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "800", "}"}]}], ",", " ", 
       RowBox[{"ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}],
        ",", " ", 
       RowBox[{"InterpolationOrder", " ", "->", " ", "0"}], ",", " ", 
       RowBox[{"PlotRange", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{"minlattime", ",", " ", "maxlattime"}], "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", " ", "->", " ", 
        RowBox[{"StyleForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<: \>\"", " ",
            "~~", " ", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", " ", 
           "\"\<; \>\"", " ", "~~", " ", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", "\"\<; \>\"", "~~", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", "\"\<: \>\"", "~~", \

             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", " ", 
           "\"\<: \>\"", " ", "~~", " ", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], ",",
           " ", 
          RowBox[{"FontSize", " ", "->", " ", "18"}], ",", " ", 
          RowBox[{"FontWeight", " ", "->", " ", "Bold"}]}], "]"}]}], ",", " ", 
       RowBox[{"FrameLabel", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<year\>\"", ",", " ", "\"\<latitude\>\"", ",", " ", "None", ",", 
          " ", "None"}], "}"}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"years", "[", 
                RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"y", ",", " ", "xlabdisp", ",", " ", "1"}], "]"}], 
                 " ", "==", " ", "1"}], ",", " ", 
                RowBox[{"years", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", " ", "\"\<\>\""}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}]}], "]"}], ",", 
          " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"c", " ", "==", " ", "1"}], ",", " ", "i", ",", " ", 
                RowBox[{"genielatsused", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", " ", "ylabdisp", ",", " ", "1"}], "]"}], 
                 " ", "==", " ", "1"}], ",", " ", 
                RowBox[{"genielatsused", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<\>\""}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "genielat"}], "}"}]}], "]"}], ",", " ", 
          "Automatic", ",", " ", "Automatic"}], "}"}]}]}], "]"}]}], ";", "\n",
     " ", 
    RowBox[{"legend", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
        "}"}], ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "750", "}"}]}], ",", " ", 
       RowBox[{"PlotLabel", " ", "->", " ", 
        RowBox[{
         RowBox[{"longnames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\< (\>\"", " ", "~~", " ", 
         RowBox[{"units", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<)\>\""}]}], ",", " ", 
       RowBox[{"FrameLabel", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
         "None", ",", " ", "\"\<   \>\"", ",", " ", "None", ",", " ", 
          "None"}], "}"}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"minlattime", " ", "+", " ", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxlattime", " ", "-", " ", "minlattime"}], 
                    ")"}], "/", "100"}]}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "0", ",", " ", "100", ",", " ", "10"}], 
               "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{
       "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "chart", "}"}], ",", " ", 
       RowBox[{"{", "legend", "}"}]}], "}"}], "]"}]}], ",", "\n", " ", "\n", 
   " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "1", ",", " ", "\"\<module\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", " ", "1", ",", " ", "\"\<dimensions\>\""}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<2\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1", ",", " ", "\"\<output variable\>\""}], 
      "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "d", ",", " ", "i"}], "]"}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}], ",", " ", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "\"\<averaging mask\>\""}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<land and sea\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<land only\>\""}], ",", " ", 
       RowBox[{"3", " ", "->", " ", "\"\<sea only\>\""}]}], "}"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", " ", "1", ",", " ", "\"\<latitude scale\>\""}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<equal area\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<equal angle\>\""}]}], "}"}]}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.45288000237187*^9, 
   3.45288001211122*^9}, {3.452880044745977*^9, 3.452880088254287*^9}, {
   3.45288013316674*^9, 3.452880214379224*^9}, {3.452880258525025*^9, 
   3.452880266652339*^9}, {3.452880311953928*^9, 3.452880338740556*^9}, {
   3.452880482355288*^9, 3.452880500663345*^9}, {3.452880536721537*^9, 
   3.452880539226734*^9}, {3.452880571448163*^9, 3.452880631317861*^9}, {
   3.45288066187985*^9, 3.4528806710296*^9}, {3.452880925859753*^9, 
   3.452880986891219*^9}, {3.452881061469638*^9, 3.452881073212583*^9}, {
   3.452881118553436*^9, 3.452881128662809*^9}, 3.454160407436851*^9, 
   3.45416051900704*^9, {3.454242461028328*^9, 3.454242474385527*^9}, {
   3.454761425932701*^9, 3.454761427875343*^9}, {3.454761486074094*^9, 
   3.454761488328691*^9}, 3.468782346297244*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["v. Animations with averaging", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45251710990585*^9, 3.45251711467841*^9}, {3.452872207285814*^9, 
   3.452872208405346*^9}, 3.452881276472808*^9, {3.45371311299243*^9, 
   3.453713113050017*^9}, {3.463396770504199*^9, 3.4633968001090918`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\n", " ", "\n", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
          "1"}], ")"}], "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], " ", "+", " ", "1"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "  ", "\n", 
      "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", " ", 
           "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
           "\"\</fields_\>\"", " ", "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", 
           "~~", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
           " ", "\"\<d.nc\>\""}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"m", " ", "==", " ", "4"}], ",", " ", "\"\<time\>\"", 
                ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            ">", " ", "bignumber"}], ",", " ", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            "=", " ", "0"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\n", "  ", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdfdata", " ", "=", " ", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"years", " ", "=", " ", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
    " ", "\n", " ", 
    RowBox[{"maxima", " ", "=", " ", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", " ", 
    RowBox[{"minima", " ", "=", " ", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", " ", "!=", " ", "1"}], ",", " ", 
      RowBox[{"netcdfdatamask", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "3"}], ",", " ", "seamask", ",", " ",
             "1"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "2"}], ",", " ", "landmask", ",", 
            " ", "1"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}]}], "]"}], ";", "\n", " ", "\n", " ", 
    RowBox[{"latdata", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                 "0"}], "]"}], " ", "==", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"{", "0", "}"}], ",", " ", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", "0"}],
                "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "genielat", ",", " ", "1", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"latdatamax", " ", "=", " ", 
     RowBox[{"Max", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\n", " ", 
    RowBox[{"latdatamin", " ", "=", " ", 
     RowBox[{"Min", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"charttable1", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
           RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
           RowBox[{"ImageSize", " ", "->", " ", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{
           "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}], 
           ",", " ", 
           RowBox[{"PlotRange", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"minima", ",", " ", "maxima"}], "}"}]}]}], "]"}], ",", 
         "\n", "    ", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", "\n", "     ", 
           RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{"PlotRange", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.1", "*", 
               RowBox[{"{", 
                RowBox[{"latdatamin", ",", " ", "latdatamax"}], "}"}]}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "90"}], ",", " ", "90"}], "}"}]}], "}"}]}], ",", 
           " ", 
           RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
           RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{"ImageSize", " ", "->", " ", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
           RowBox[{"FrameTicks", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", " ", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"-", "90"}], ",", " ", "90", ",", " ", "30"}], 
                 "}"}]}], "]"}], ",", " ", "None", ",", " ", "None"}], 
             "}"}]}]}], "]"}]}], "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
        "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"legend", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
        "}"}], ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "420", "}"}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"minima", " ", "+", " ", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "0", ",", " ", "100", ",", " ", "20"}], 
               "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{
       "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", 
                 " ", "\"\<; \>\"", " ", "~~", " ", 
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
                 RowBox[{"(*", 
                  RowBox[{"~~", "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                 " ", "\"\<\\n\>\"", " ", "~~", " ", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                 " ", "~~", " ", "\"\<\\nyear \>\"", " ", "~~", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], " ", "~~", " ", "\"\<\>\""}], ",", 
                " ", "Black", ",", " ", "Bold", ",", " ", "25"}], "]"}], 
              "]"}], ",", " ", 
             RowBox[{"ListLogLinearPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", " ", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}], " ", "==", " ", 
                    RowBox[{"{", "}"}]}], ",", " ", 
                    RowBox[{"{", "0", "}"}], ",", " ", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"yy", ",", " ", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", " ", 
                   "nnetcdfyears2"}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
               RowBox[{"AspectRatio", " ", "->", " ", "0.4"}], ",", " ", 
               RowBox[{"PlotRange", " ", "->", " ", "Automatic"}], ",", " ", 
               RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
               RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
               RowBox[{"ImageSize", " ", "->", " ", 
                RowBox[{"{", "400", "}"}]}], ",", " ", 
               RowBox[{"PlotLabel", " ", "->", " ", "\"\<\>\""}], ",", " ", 
               RowBox[{"FrameLabel", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<year\>\"", ",", " ", "None", ",", " ", "None", ",", " ",
                   "None"}], "}"}]}], ",", " ", 
               RowBox[{"GridLines", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "}"}], ",", " ", "None"}], "}"}]}]}], 
              "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", " ", 
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<averages (\>\"", " ", "~~", " ", 
                 RowBox[{"masknames", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], " ", "~~", " ", 
                 "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                " ", "Black", ",", " ", "Bold", ",", " ", "15"}], "]"}], 
              "]"}]}], "}"}], ",", "\n", "     ", 
           RowBox[{"charttable1", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"legend", ",", " ", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"longnames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
               " ", "~~", " ", "\"\< (\>\"", " ", "~~", " ", 
               RowBox[{"units", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
               " ", "~~", " ", "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"nnetcdfyears2", " ", "-", " ", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", " ", 
      RowBox[{"DefaultDuration", " ", "->", " ", 
       RowBox[{"1", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", " ", "-", " ", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", " ", 
      RowBox[{"AnimationRunning", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"Deployed", " ", "->", " ", "True"}], ",", " ", 
      RowBox[{"AnimatorElements", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", " ", "\"\<PlayPauseButton\>\"", ",", 
         " ", "\"\<StepLeftButton\>\"", ",", " ", "\"\<StepRightButton\>\"", 
         ",", " ", "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\n", " ", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "1", ",", " ", "\"\<module\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", " ", "1", ",", " ", "\"\<dimensions\>\""}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<2\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1", ",", " ", "\"\<output variable\>\""}], 
      "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "d", ",", " ", "i"}], "]"}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}], ",", "\n",
    " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "\"\<averaging mask\>\""}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<land and sea\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<land only\>\""}], ",", " ", 
       RowBox[{"3", " ", "->", " ", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452517143854737*^9, 3.452517151285299*^9}, {3.452517326910662*^9, 
   3.452517343043067*^9}, {3.452517435845748*^9, 3.452517618704145*^9}, {
   3.452517670431836*^9, 3.452517672348421*^9}, {3.45251770235963*^9, 
   3.452517830471971*^9}, {3.452517863016951*^9, 3.452517887988689*^9}, {
   3.452517975496944*^9, 3.452518004019736*^9}, {3.452518081420271*^9, 
   3.452518083468248*^9}, {3.452518118422448*^9, 3.452518182854463*^9}, {
   3.452518224525839*^9, 3.452518250363717*^9}, {3.452518289084836*^9, 
   3.452518297103226*^9}, {3.452518343984723*^9, 3.45251835179313*^9}, {
   3.452518518203085*^9, 3.452518571785431*^9}, 3.452518658281728*^9, {
   3.452518708712104*^9, 3.452518710082306*^9}, {3.452518996034881*^9, 
   3.452518997806417*^9}, {3.452519090519996*^9, 3.452519096333159*^9}, {
   3.452519321096858*^9, 3.452519321751175*^9}, 3.452519376809717*^9, {
   3.452519669245811*^9, 3.452519671104056*^9}, {3.452520081885473*^9, 
   3.452520101981842*^9}, 3.452520152754518*^9, {3.452520279393203*^9, 
   3.45252028357465*^9}, {3.452520980548202*^9, 3.452520994557842*^9}, {
   3.452521123079144*^9, 3.4525211510415*^9}, {3.452521184236368*^9, 
   3.452521191972094*^9}, {3.45252128730401*^9, 3.452521303737177*^9}, {
   3.452521412228856*^9, 3.452521432801163*^9}, {3.452521821680554*^9, 
   3.452521834239233*^9}, 3.452522027256269*^9, {3.45252232193451*^9, 
   3.452522386321362*^9}, {3.452522448874468*^9, 3.452522475883618*^9}, {
   3.452522589387208*^9, 3.452522611531426*^9}, {3.452522788258136*^9, 
   3.452523022695191*^9}, 3.452523374323133*^9, {3.452866702242705*^9, 
   3.452866702966833*^9}, {3.452867128042157*^9, 3.45286720665029*^9}, 
   3.45286724124894*^9, {3.452867273894454*^9, 3.452867282336009*^9}, {
   3.452867814640477*^9, 3.452867831795984*^9}, 3.452867981521931*^9, {
   3.454159417265866*^9, 3.45415943290526*^9}, {3.454160443064289*^9, 
   3.454160446424553*^9}, 3.454160511461758*^9, {3.454242301301871*^9, 
   3.454242354047115*^9}, 3.468782352579804*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/movies\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"d", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"saveallgraphs", " ", "==", " ", "1"}], ",", "\n", " ", "\n", " ", 
   
   RowBox[{"Do", "[", "\n", "  ", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v1", ",", " ", "v2"}], 
             RowBox[{"(*", 
              RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
            "1"}], ")"}], "*", 
          RowBox[{"varmultipliers", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2"}], 
             RowBox[{"(*", 
              RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
         "]"}], " ", "+", " ", "1"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "   ", 
        "\n", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{
            "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
             RowBox[{"runids", "[", 
              RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", 
             " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
             "\"\</fields_\>\"", " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", 
             " ", "~~", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
             " ", "\"\<d.nc\>\""}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<Datasets\>\"", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                  "\"\<time\>\"", ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
                RowBox[{"datanames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}],
                "}"}]}], "}"}]}], "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "   ", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", ">", " ", "bignumber"}], ",", " ", 
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", "=", " ", "0"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
        "\n", "   ", "\n", "   ", 
        RowBox[{
         RowBox[{"netcdfdata", " ", "=", " ", 
          RowBox[{"netcdfdataall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"years", " ", "=", " ", 
          RowBox[{"yearsall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
      "  ", "\n", "  ", 
      RowBox[{"maxima", " ", "=", " ", 
       RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", 
      RowBox[{"minima", " ", "=", " ", 
       RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"a", " ", "=", " ", "1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "landmask"}], ",", " ", 
           "2"}], "]"}], " ", "==", " ", "0"}], ",", " ", 
        RowBox[{"a", " ", "=", " ", "3"}]}], 
       RowBox[{"(*", 
        RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "seamask"}], ",", " ", 
           "2"}], "]"}], " ", "==", " ", "0"}], ",", " ", 
        RowBox[{"a", " ", "=", " ", "2"}]}], 
       RowBox[{"(*", 
        RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", "\n", "  ", "\n", 
      "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", " ", "!=", " ", "1"}], ",", " ", 
        RowBox[{"netcdfdatamask", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "3"}], ",", " ", "seamask", ",", 
              " ", "1"}], "]"}], "*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "2"}], ",", " ", "landmask", ",", 
              " ", "1"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}]}], "]"}]}]}], "]"}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"latdata", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                   "0"}], "]"}], " ", "==", " ", 
                 RowBox[{"{", "}"}]}], ",", " ", 
                RowBox[{"{", "0", "}"}], ",", " ", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"netcdfdatamask", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                  "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
           RowBox[{"genielatsused", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat", ",", " ", "1", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"latdatamax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
         "]"}]}], ";", "\n", "  ", 
      RowBox[{"latdatamin", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
         "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"legend", " ", "=", " ", 
       RowBox[{"ArrayPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
          "}"}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", "420", "}"}]}], ",", " ", 
         RowBox[{"FrameTicks", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"minima", " ", "+", " ", 
                   RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "i", ",", " ", "0", ",", " ", "100", ",", " ", "20"}], 
                 "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", 
         " ", 
         RowBox[{
         "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
        "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"charttable1", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"varvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", 
                  " ", "\"\<; \>\"", " ", "~~", " ", 
                  RowBox[{"varvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
                  RowBox[{"(*", 
                   RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                    "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                    "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                  " ", "\"\<\\n\>\"", " ", "~~", " ", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}],
                   " ", "~~", " ", "\"\<\\nyear \>\"", " ", "~~", " ", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], " ", "~~", " ", "\"\<\>\""}], ",", 
                 " ", "Black", ",", " ", "Bold", ",", " ", "25"}], "]"}], 
               "]"}], ",", " ", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", " ", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}], " ", "==", " ", 
                    RowBox[{"{", "}"}]}], ",", " ", 
                    RowBox[{"{", "0", "}"}], ",", " ", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", " ", 
                    "nnetcdfyears2"}], "}"}]}], "]"}], ",", " ", 
                RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.4"}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", "Automatic"}], ",", " ", 
                
                RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"PlotLabel", " ", "->", " ", "\"\<\>\""}], ",", " ", 
                RowBox[{"FrameLabel", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", " ", "None", ",", " ", "None", ",", 
                   " ", "None"}], "}"}]}], ",", " ", 
                RowBox[{"GridLines", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "}"}], ",", " ", "None"}], "}"}]}]}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", " ", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", " ", "~~", " ", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], " ", "~~", " ", 
                  "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                 " ", "Black", ",", " ", "Bold", ",", " ", "15"}], "]"}], 
               "]"}]}], "}"}], ",", "\n", "      ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{
                "ColorFunction", " ", "->", " ", 
                 "\"\<ThermometerColors\>\""}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"minima", ",", " ", "maxima"}], "}"}]}]}], "]"}], 
              ",", "\n", "       ", 
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"latdata", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", "\n", "        ", 
                RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", " ", "latdatamax"}], "}"}]}], 
                   ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", " ", "90"}], "}"}]}], "}"}]}], 
                ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
                RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
                RowBox[{"FrameTicks", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", " ", 
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"-", "90"}], ",", " ", "90", ",", " ", "30"}], 
                    "}"}]}], "]"}], ",", " ", "None", ",", " ", "None"}], 
                  "}"}]}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"legend", ",", " ", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                " ", "~~", " ", "\"\< (\>\"", " ", "~~", " ", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                " ", "~~", " ", "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}],
          ",", "\n", "    ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<_movie2.gif\>\""}], ",", " ", "charttable1"}], "]"}], 
      ";"}], ",", "\n", "  ", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v3", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v4", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "nnetcdfmodules"}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1"}], 
      RowBox[{"(*", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}], "*)"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9, {3.469369970565373*^9, 
   3.469370314917918*^9}, 3.469370506662942*^9, {3.4693705791252193`*^9, 
   3.4693706080576143`*^9}, {3.4693706544501677`*^9, 3.469370783803628*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["vi. Animations with averaging and lat-time diagram", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, 3.452437491924206*^9, {
   3.45251710990585*^9, 3.45251711467841*^9}, {3.452872207285814*^9, 
   3.452872208405346*^9}, {3.452872459497185*^9, 3.452872467691351*^9}, 
   3.452881279641718*^9, 3.453713117202117*^9, {3.463396773479755*^9, 
   3.463396803158266*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlabdisp", " ", "=", " ", "10"}], ";", " ", 
   RowBox[{"ylabdisp", " ", "=", " ", "5"}], ";"}], "\n"}], "\n", 
 RowBox[{"Manipulate", "[", "\n", " ", "\n", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"k", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], 
           RowBox[{"(*", 
            RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
          "1"}], ")"}], "*", 
        RowBox[{"varmultipliers", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2"}], 
           RowBox[{"(*", 
            RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
       "]"}], " ", "+", " ", "1"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "  ", "\n", 
      "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
           RowBox[{"runids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", " ", 
           "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
           "\"\</fields_\>\"", " ", "~~", " ", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", 
           "~~", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"dimensions", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
           " ", "\"\<d.nc\>\""}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Datasets\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"m", " ", "==", " ", "4"}], ",", " ", "\"\<time\>\"", 
                ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
              RowBox[{"datanames", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            ">", " ", "bignumber"}], ",", " ", 
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], " ", 
            "=", " ", "0"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
      "\n", "  ", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdfdata", " ", "=", " ", 
        RowBox[{"netcdfdataall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"years", " ", "=", " ", 
        RowBox[{"yearsall", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"nnetcdfyears2", " ", "=", " ", 
        RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
    " ", "\n", " ", 
    RowBox[{"maxima", " ", "=", " ", 
     RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", " ", 
    RowBox[{"minima", " ", "=", " ", 
     RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"a", " ", "!=", " ", "1"}], ",", " ", 
      RowBox[{"netcdfdatamask", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", "y", "]"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "3"}], ",", " ", "seamask", ",", " ",
             "1"}], "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "2"}], ",", " ", "landmask", ",", 
            " ", "1"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}]}], "]"}], ";", "\n", " ", "\n", " ", 
    RowBox[{"latdata", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"netcdfdatamask", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                 "0"}], "]"}], " ", "==", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"{", "0", "}"}], ",", " ", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"netcdfdatamask", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", "0"}],
                "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
         RowBox[{"genielatsused", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "genielat", ",", " ", "1", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"latdatamax", " ", "=", " ", 
     RowBox[{"Max", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\n", " ", 
    RowBox[{"latdatamin", " ", "=", " ", 
     RowBox[{"Min", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"latdata", "[", 
          RowBox[{"[", 
           RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"latdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"netcdflattime", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"years", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", " ", "i", ",", " ", 
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat"}], "}"}]}], "]"}], ",", " ", 
       "1"}], "]"}]}], ";", "\n", " ", 
    RowBox[{
     RowBox[{"netcdflattime", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", "maxima"}], 
    ";", "\n", " ", 
    RowBox[{
     RowBox[{"netcdflattime", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", "minima"}], 
    ";", "\n", " ", "\n", " ", 
    RowBox[{"charttable1", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
           RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
           RowBox[{"ImageSize", " ", "->", " ", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{
           "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}], 
           ",", " ", 
           RowBox[{"PlotRange", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"minima", ",", " ", "maxima"}], "}"}]}]}], "]"}], ",", 
         "\n", "    ", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", "y", "]"}], "]"}], ",", "\n", "     ", 
           RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{"PlotRange", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.1", "*", 
               RowBox[{"{", 
                RowBox[{"latdatamin", ",", " ", "latdatamax"}], "}"}]}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "90"}], ",", " ", "90"}], "}"}]}], "}"}]}], ",", 
           " ", 
           RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
           RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{"ImageSize", " ", "->", " ", 
            RowBox[{"{", "400", "}"}]}], ",", " ", 
           RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
           RowBox[{"FrameTicks", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", " ", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"-", "90"}], ",", " ", "90", ",", " ", "30"}], 
                 "}"}]}], "]"}], ",", " ", "None", ",", " ", "None"}], 
             "}"}]}]}], "]"}]}], "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", 
         RowBox[{"netcdfstartyearnos", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
        "}"}]}], "]"}]}], ";", "\n", " ", 
    RowBox[{"legend", " ", "=", " ", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
        "}"}], ",", " ", 
       RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
       RowBox[{"ImageSize", " ", "->", " ", 
        RowBox[{"{", "420", "}"}]}], ",", " ", 
       RowBox[{"FrameTicks", " ", "->", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"minima", " ", "+", " ", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                   "100"}]}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "0", ",", " ", "100", ",", " ", "20"}], 
               "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{
       "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
      "]"}]}], ";", "\n", " ", "\n", " ", 
    RowBox[{"ListAnimate", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", 
                 " ", "\"\<; \>\"", " ", "~~", " ", 
                 RowBox[{"varvalues", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
                 RowBox[{"(*", 
                  RowBox[{"~~", "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                   "\"\<; \>\"", "~~", 
                   RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                 " ", "\"\<     \>\"", " ", "~~", " ", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                 " ", "~~", " ", "\"\<     year \>\"", " ", "~~", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"years", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], " ", "~~", " ", "\"\<\>\""}], ",", 
                " ", "Black", ",", " ", "Bold", ",", " ", "25"}], "]"}], 
              "]"}], ",", " ", "SpanFromLeft"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"charttable1", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"ListLogLinearPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", " ", 
                   RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}], " ", "==", " ", 
                    RowBox[{"{", "}"}]}], ",", " ", 
                    RowBox[{"{", "0", "}"}], ",", " ", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"yy", ",", " ", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", " ", 
                   "nnetcdfyears2"}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
               RowBox[{"AspectRatio", " ", "->", " ", "0.45"}], ",", " ", 
               RowBox[{"PlotRange", " ", "->", " ", "Automatic"}], ",", " ", 
               RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
               RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
               RowBox[{"ImageSize", " ", "->", " ", 
                RowBox[{"{", "400", "}"}]}], ",", " ", 
               RowBox[{"PlotLabel", " ", "->", " ", "\"\<\>\""}], ",", " ", 
               RowBox[{"FrameLabel", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<year\>\"", ",", " ", "None", ",", " ", "None", ",", " ",
                   "None"}], "}"}]}], ",", " ", 
               RowBox[{"GridLines", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "}"}], ",", " ", "None"}], "}"}]}]}], 
              "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<averages (\>\"", " ", "~~", " ", 
                 RowBox[{"masknames", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], " ", "~~", " ", 
                 "\"\<):  latitudinal (top left), global (top right) and \
lat-time (bottom right)\>\""}], ",", " ", "Black", ",", " ", "Bold", ",", " ",
                 "15"}], "]"}], "]"}], ",", " ", "SpanFromLeft"}], "}"}], ",",
            "\n", "     ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"charttable1", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", " ", "1"}], "]"}], "]"}], ",", "\n", 
             "      ", 
             RowBox[{"ListDensityPlot", "[", 
              RowBox[{"netcdflattime", ",", " ", 
               RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
               RowBox[{"ImageSize", " ", "->", " ", 
                RowBox[{"{", "400", "}"}]}], ",", " ", 
               RowBox[{
               "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}],
                ",", " ", 
               RowBox[{"InterpolationOrder", " ", "->", " ", "0"}], ",", " ", 
               
               RowBox[{"Mesh", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], "}"}], ",", " ", 
                  RowBox[{"{", "18", "}"}]}], "}"}]}], ",", " ", 
               RowBox[{"PlotRange", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{"minima", ",", " ", "maxima"}], "}"}]}], ",", " ", 
               RowBox[{"FrameLabel", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "None", ",", " ", "None", ",", " ", "None", ",", " ", 
                  "None"}], "}"}]}], ",", " ", 
               RowBox[{"FrameTicks", " ", "->", " ", 
                RowBox[{"{", 
                 RowBox[{"None", ",", " ", "None"}], "}"}]}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"FrameLabel", "->", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "\"\<latitude\>\"", ",", "None", ",", 
                   "None"}], "}"}]}], ",", 
                RowBox[{"FrameTicks", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"y", ",", "xlabdisp", ",", "1"}], "]"}], "==", 
                    "1"}], ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "nnetcdfyears2"}], "}"}]}], "]"}], ",", 
                   
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "ylabdisp", ",", "1"}], "]"}], "==", 
                    "1"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", 
                   "Automatic", ",", "Automatic"}], "}"}]}]}], "*)"}], 
              "]"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"legend", ",", " ", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"longnames", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
               " ", "~~", " ", "\"\< (\>\"", " ", "~~", " ", 
               RowBox[{"units", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
               " ", "~~", " ", "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"nnetcdfyears2", " ", "-", " ", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}]}],
        "]"}], ",", " ", 
      RowBox[{"DefaultDuration", " ", "->", " ", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"nnetcdfyears2", " ", "-", " ", 
          RowBox[{"netcdfstartyearnos", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", " ", 
      RowBox[{"AnimationRunning", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"Deployed", " ", "->", " ", "True"}], ",", " ", 
      RowBox[{"AnimatorElements", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ProgressSlider\>\"", ",", " ", "\"\<PlayPauseButton\>\"", ",", 
         " ", "\"\<StepLeftButton\>\"", ",", " ", "\"\<StepRightButton\>\"", 
         ",", " ", "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
   "\n", " ", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", "1", ",", " ", 
       RowBox[{"vartitles", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"varvalues", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nvars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v3", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v4", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v5", ",", "1", ",", 
         RowBox[{"vartitles", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "->", 
          RowBox[{"varvalues", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ","}], 
    "*)"}], "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "1", ",", " ", "\"\<module\>\""}], "}"}], ",", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"netcdfmodules", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], 
   ",", "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", " ", "1", ",", " ", "\"\<dimensions\>\""}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<2\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\n", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1", ",", " ", "\"\<output variable\>\""}], 
      "}"}], ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", " ", "->", " ", 
        RowBox[{"datanames", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", " ", "d", ",", " ", "i"}], "]"}], "]"}]}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"nrealdata", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"ControlType", " ", "->", " ", "PopupMenu"}]}], "}"}], ",", "\n",
    " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "\"\<averaging mask\>\""}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "\"\<land and sea\>\""}], ",", " ", 
       RowBox[{"2", " ", "->", " ", "\"\<land only\>\""}], ",", " ", 
       RowBox[{"3", " ", "->", " ", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452517143854737*^9, 3.452517151285299*^9}, {3.452517326910662*^9, 
   3.452517343043067*^9}, {3.452517435845748*^9, 3.452517618704145*^9}, {
   3.452517670431836*^9, 3.452517672348421*^9}, {3.45251770235963*^9, 
   3.452517830471971*^9}, {3.452517863016951*^9, 3.452517887988689*^9}, {
   3.452517975496944*^9, 3.452518004019736*^9}, {3.452518081420271*^9, 
   3.452518083468248*^9}, {3.452518118422448*^9, 3.452518182854463*^9}, {
   3.452518224525839*^9, 3.452518250363717*^9}, {3.452518289084836*^9, 
   3.452518297103226*^9}, {3.452518343984723*^9, 3.45251835179313*^9}, {
   3.452518518203085*^9, 3.452518571785431*^9}, 3.452518658281728*^9, {
   3.452518708712104*^9, 3.452518710082306*^9}, {3.452518996034881*^9, 
   3.452518997806417*^9}, {3.452519090519996*^9, 3.452519096333159*^9}, {
   3.452519321096858*^9, 3.452519321751175*^9}, 3.452519376809717*^9, {
   3.452519669245811*^9, 3.452519671104056*^9}, {3.452520081885473*^9, 
   3.452520101981842*^9}, 3.452520152754518*^9, {3.452520279393203*^9, 
   3.45252028357465*^9}, {3.452520980548202*^9, 3.452520994557842*^9}, {
   3.452521123079144*^9, 3.4525211510415*^9}, {3.452521184236368*^9, 
   3.452521191972094*^9}, {3.45252128730401*^9, 3.452521303737177*^9}, {
   3.452521412228856*^9, 3.452521432801163*^9}, {3.452521821680554*^9, 
   3.452521834239233*^9}, 3.452522027256269*^9, {3.45252232193451*^9, 
   3.452522386321362*^9}, {3.452522448874468*^9, 3.452522475883618*^9}, {
   3.452522589387208*^9, 3.452522611531426*^9}, {3.452522788258136*^9, 
   3.452523022695191*^9}, 3.452523374323133*^9, {3.452866702242705*^9, 
   3.452866702966833*^9}, {3.452867128042157*^9, 3.45286720665029*^9}, 
   3.45286724124894*^9, {3.452867273894454*^9, 3.452867282336009*^9}, {
   3.452867814640477*^9, 3.452867831795984*^9}, 3.452867981521931*^9, {
   3.452875567135647*^9, 3.452875646582428*^9}, {3.452875696085545*^9, 
   3.452875725658606*^9}, {3.452875770486485*^9, 3.452875788441097*^9}, {
   3.452875849212131*^9, 3.452875883482761*^9}, 3.452875915765095*^9, {
   3.452876432434741*^9, 3.452876434078327*^9}, {3.452876773464574*^9, 
   3.452876845523275*^9}, 3.45287692970975*^9, 3.452877163190587*^9, {
   3.452879420439368*^9, 3.452879460715637*^9}, {3.454159529718518*^9, 
   3.454159545186762*^9}, 3.454160457753366*^9, 3.454160504601693*^9, {
   3.454241676691394*^9, 3.454241678970742*^9}, {3.454241930883652*^9, 
   3.454242070950815*^9}, {3.454242154475921*^9, 3.454242198216564*^9}, 
   3.468782356582594*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/movies\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"d", " ", "=", " ", "1"}], ";"}], "\n", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"saveallgraphs", " ", "==", " ", "1"}], ",", "\n", " ", "\n", " ", 
   
   RowBox[{"Do", "[", "\n", "  ", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"k", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v1", ",", " ", "v2"}], 
             RowBox[{"(*", 
              RowBox[{",", "v3", ",", "v4"}], "*)"}], "}"}], " ", "-", " ", 
            "1"}], ")"}], "*", 
          RowBox[{"varmultipliers", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2"}], 
             RowBox[{"(*", 
              RowBox[{",", "3", ",", "4"}], "*)"}], "}"}], "]"}], "]"}]}], 
         "]"}], " ", "+", " ", "1"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"readinalldata", " ", "==", " ", "0"}], ",", "\n", "   ", 
        "\n", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"years", ",", " ", "netcdfdata"}], "}"}], " ", "=", " ", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{
            "outputfolder", " ", "~~", " ", "\"\</\>\"", " ", "~~", " ", 
             RowBox[{"runids", "[", 
              RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\</\>\"", 
             " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", 
             "\"\</fields_\>\"", " ", "~~", " ", 
             RowBox[{"netcdfmodules", "[", 
              RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", 
             " ", "~~", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"dimensions", "[", 
               RowBox[{"[", 
                RowBox[{"m", ",", " ", "d"}], "]"}], "]"}], "]"}], " ", "~~", 
             " ", "\"\<d.nc\>\""}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<Datasets\>\"", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"m", " ", "==", " ", "4"}], ",", " ", 
                  "\"\<time\>\"", ",", " ", "\"\<year\>\""}], "]"}], ",", " ", 
                RowBox[{"datanames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}]}],
                "}"}]}], "}"}]}], "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";", "\n", "   ", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", ">", " ", "bignumber"}], ",", " ", 
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], 
              " ", "=", " ", "0"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", "nnetcdfyears2"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "genielat"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "genielon"}], "}"}]}], "]"}], ";"}], ",", 
        "\n", "   ", "\n", "   ", 
        RowBox[{
         RowBox[{"netcdfdata", " ", "=", " ", 
          RowBox[{"netcdfdataall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"years", " ", "=", " ", 
          RowBox[{"yearsall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "m", ",", " ", "d", ",", " ", "l"}], "]"}],
            "]"}]}], ";", "\n", "   ", 
         RowBox[{"nnetcdfyears2", " ", "=", " ", 
          RowBox[{"Length", "[", "years", "]"}]}], ";"}]}], "]"}], ";", "\n", 
      "  ", "\n", "  ", 
      RowBox[{"maxima", " ", "=", " ", 
       RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", 
      RowBox[{"minima", " ", "=", " ", 
       RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"a", " ", "=", " ", "1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "landmask"}], ",", " ", 
           "2"}], "]"}], " ", "==", " ", "0"}], ",", " ", 
        RowBox[{"a", " ", "=", " ", "3"}]}], 
       RowBox[{"(*", 
        RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "seamask"}], ",", " ", 
           "2"}], "]"}], " ", "==", " ", "0"}], ",", " ", 
        RowBox[{"a", " ", "=", " ", "2"}]}], 
       RowBox[{"(*", 
        RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", "\n", "  ", "\n", 
      "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", " ", "!=", " ", "1"}], ",", " ", 
        RowBox[{"netcdfdatamask", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", "y", "]"}], "]"}], "*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "3"}], ",", " ", "seamask", ",", 
              " ", "1"}], "]"}], "*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "2"}], ",", " ", "landmask", ",", 
              " ", "1"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}]}], "]"}]}]}], "]"}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"latdata", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                   "0"}], "]"}], " ", "==", " ", 
                 RowBox[{"{", "}"}]}], ",", " ", 
                RowBox[{"{", "0", "}"}], ",", " ", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"netcdfdatamask", "[", 
                   RowBox[{"[", 
                    RowBox[{"y", ",", " ", "i"}], "]"}], "]"}], ",", " ", 
                  "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
           RowBox[{"genielatsused", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "genielat", ",", " ", "1", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"latdatamax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
         "]"}]}], ";", "\n", "  ", 
      RowBox[{"latdatamin", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
         "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"netcdflattime", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", " ", "i", ",", " ", 
             RowBox[{"latdata", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", " ", "i", ",", " ", "1"}], "]"}], "]"}]}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "genielat"}], "}"}]}], "]"}], ",", " ", 
         "1"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdflattime", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", 
       "maxima"}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{"netcdflattime", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", 
       "minima"}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"legend", " ", "=", " ", 
       RowBox[{"ArrayPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", "100"}], "}"}]}], "]"}], 
          "}"}], ",", " ", 
         RowBox[{"AspectRatio", " ", "->", " ", "0.05"}], ",", " ", 
         RowBox[{"ImageSize", " ", "->", " ", 
          RowBox[{"{", "420", "}"}]}], ",", " ", 
         RowBox[{"FrameTicks", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"minima", " ", "+", " ", 
                   RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"maxima", " ", "-", " ", "minima"}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "i", ",", " ", "0", ",", " ", "100", ",", " ", "20"}], 
                 "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], "}"}]}], ",", 
         " ", 
         RowBox[{
         "ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}]}], 
        "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"charttable1", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"varvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "v1"}], "]"}], "]"}], " ", "~~", 
                  " ", "\"\<; \>\"", " ", "~~", " ", 
                  RowBox[{"varvalues", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", " ", "v2"}], "]"}], "]"}], 
                  RowBox[{"(*", 
                   RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "v3"}], "]"}], "]"}], "~~", 
                    "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "v4"}], "]"}], "]"}], "~~", 
                    "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "v5"}], "]"}], "]"}]}], "*)"}], "~~", 
                  " ", "\"\<     \>\"", " ", "~~", " ", 
                  RowBox[{"datanames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}],
                   " ", "~~", " ", "\"\<     year \>\"", " ", "~~", " ", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], " ", "~~", " ", "\"\<\>\""}], ",", 
                 " ", "Black", ",", " ", "Bold", ",", " ", "25"}], "]"}], 
               "]"}], ",", " ", "SpanFromLeft"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"latdata", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", "\n", "        ", 
                RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", " ", "latdatamax"}], "}"}]}], 
                   ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", " ", "90"}], "}"}]}], "}"}]}], 
                ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
                RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
                RowBox[{"FrameTicks", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", " ", 
                   RowBox[{"Table", "[", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"-", "90"}], ",", " ", "90", ",", " ", "30"}], 
                    "}"}]}], "]"}], ",", " ", "None", ",", " ", "None"}], 
                  "}"}]}]}], "]"}], ",", " ", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], ",", " ", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", " ", "==", " ", "1"}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}], " ", "==", " ", 
                    RowBox[{"{", "}"}]}], ",", " ", 
                    RowBox[{"{", "0", "}"}], ",", " ", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", "yy", "]"}], "]"}], "]"}], ",", " ", "0"}], 
                    "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", " ", 
                    "nnetcdfyears2"}], "}"}]}], "]"}], ",", " ", 
                RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.45"}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", "Automatic"}], ",", " ", 
                
                RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"PlotLabel", " ", "->", " ", "\"\<\>\""}], ",", " ", 
                RowBox[{"FrameLabel", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", " ", "None", ",", " ", "None", ",", 
                   " ", "None"}], "}"}]}], ",", " ", 
                RowBox[{"GridLines", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "}"}], ",", " ", "None"}], "}"}]}]}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", " ", "~~", " ", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], " ", "~~", " ", 
                  "\"\<):  latitudinal (top left), global (top right) and \
lat-time (bottom right)\>\""}], ",", " ", "Black", ",", " ", "Bold", ",", " ",
                  "15"}], "]"}], "]"}], ",", " ", "SpanFromLeft"}], "}"}], 
            ",", "\n", "      ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", "y", "]"}], "]"}], ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{"DataReversed", " ", "->", " ", "True"}], ",", " ", 
                RowBox[{
                "ColorFunction", " ", "->", " ", 
                 "\"\<ThermometerColors\>\""}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"minima", ",", " ", "maxima"}], "}"}]}]}], "]"}], 
              ",", "\n", "       ", 
              RowBox[{"ListDensityPlot", "[", 
               RowBox[{"netcdflattime", ",", " ", 
                RowBox[{"AspectRatio", " ", "->", " ", "0.5"}], ",", " ", 
                RowBox[{"ImageSize", " ", "->", " ", 
                 RowBox[{"{", "400", "}"}]}], ",", " ", 
                RowBox[{
                "ColorFunction", " ", "->", " ", 
                 "\"\<ThermometerColors\>\""}], ",", " ", 
                RowBox[{"InterpolationOrder", " ", "->", " ", "0"}], ",", " ", 
                RowBox[{"Mesh", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", " ", "+", " ", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", "1"}], 
                    "]"}], "]"}], "]"}], "}"}], ",", " ", 
                   RowBox[{"{", "18", "}"}]}], "}"}]}], ",", " ", 
                RowBox[{"PlotRange", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"minima", ",", " ", "maxima"}], "}"}]}], ",", " ", 
                RowBox[{"FrameLabel", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{
                  "None", ",", " ", "None", ",", " ", "None", ",", " ", 
                   "None"}], "}"}]}], ",", " ", 
                RowBox[{"FrameTicks", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"None", ",", " ", "None"}], "}"}]}]}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{"FrameLabel", "->", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<year\>\"", ",", "\"\<latitude\>\"", ",", "None", ",", 
                    "None"}], "}"}]}], ",", 
                 RowBox[{"FrameTicks", "->", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"y", ",", "xlabdisp", ",", "1"}], "]"}], "==", 
                    "1"}], ",", 
                    RowBox[{"years", "[", 
                    RowBox[{"[", "y", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "nnetcdfyears2"}], "}"}]}], "]"}], ",", 
                    
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "ylabdisp", ",", "1"}], "]"}], "==", 
                    "1"}], ",", 
                    RowBox[{"genielatsused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "genielat"}], "}"}]}], "]"}], ",", 
                    "Automatic", ",", "Automatic"}], "}"}]}]}], "*)"}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"legend", ",", " ", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                " ", "~~", " ", "\"\< (\>\"", " ", "~~", " ", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], 
                " ", "~~", " ", "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}],
          ",", "\n", "    ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", " ", "nnetcdfyears2"}], 
          "}"}]}], "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"runids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], " ", "~~", " ", "\"\<_\>\"", " ", "~~",
          " ", 
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", " ", "d", ",", " ", "l"}], "]"}], "]"}], " ", "~~",
          " ", "\"\<_movie3.gif\>\""}], ",", " ", "charttable1"}], "]"}], 
      ";"}], ",", "\n", "  ", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v2", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v3", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"v4", ",", " ", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "nnetcdfmodules"}], "}"}], ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "1"}], 
      RowBox[{"(*", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}], "*)"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9, {3.469369970565373*^9, 
   3.469370314917918*^9}, 3.469370506662942*^9, {3.4693705791252193`*^9, 
   3.4693706080576143`*^9}, {3.4693706544501677`*^9, 3.469370783803628*^9}, {
   3.4693709957804537`*^9, 3.46937106051873*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["vii. Comparisons - single axis lat. plot", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, {3.452437493594726*^9, 
   3.452437501081405*^9}, 3.452517119361092*^9, 3.452872469640272*^9, 
   3.452881281314605*^9, {3.453028621937058*^9, 3.453028635211006*^9}, 
   3.45371311946796*^9, {3.463396775168241*^9, 3.463396805397645*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vs", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"o", ",", "v1"}], 
                RowBox[{"(*", 
                 RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
              ")"}], "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
              "}"}]}], "]"}], "+", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                   "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
                "<", "bignumber"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"nnetcdfyears2", "[", 
                RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "genielat"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"netcdfdataall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"yearsall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"minyear", "=", 
        RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxima", "=", 
        RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"minima", "=", 
        RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"netcdfdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"netcdfdatamask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
            "]"}]}], ";", 
          RowBox[{"netcdfdatadiffmask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"latdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatamax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatamin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"charttable", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}]}], "}"}], "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "300", "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}], ",", 
                RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.1", "*", 
                  RowBox[{"{", 
                   RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", "250", "}"}]}], ",", " ", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                  "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", "Blue", "}"}], "}"}]}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
            ",", 
            RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", "320", "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                  "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
               "}"}], "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Animate", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
              "SpanFromLeft", ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                  "]"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                RowBox[{"AspectRatio", "\[Rule]", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "580", "}"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
               "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"vartitles", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold", 
                 ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}],
                 "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<difference from control\>\"", ",", "Orange", ",", "Bold",
                  ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", "~~", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "~~", 
                  "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                 "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"charttable", "[", 
                  RowBox[{"[", 
                   RowBox[{"y", ",", "o", ",", "3"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"o", ",", 
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\< (\>\"", "~~", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"1", "+", "minyear", "-", 
                RowBox[{"netcdfstartyearnos", "[", 
                 RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
         RowBox[{"DefaultDuration", "\[Rule]", 
          RowBox[{"3", "*", 
           RowBox[{"(", 
            RowBox[{"minyear", "-", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"Deployed", "->", "True"}], ",", 
         RowBox[{"AnimatorElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
            "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "1", ",", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", 
            RowBox[{"vs", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v2", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v3", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "\"\<ouput variable\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nrealdata", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
          RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "\"\<input variable to compare\>\""}], 
      "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"vartitles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.451309414063614*^9, 3.451309510953402*^9}, {
   3.451309598429776*^9, 3.451309617982269*^9}, {3.451309653586308*^9, 
   3.451309711282247*^9}, {3.451309749128101*^9, 3.451309793567101*^9}, {
   3.451309836455378*^9, 3.451309910414605*^9}, {3.451309995122858*^9, 
   3.451309995634495*^9}, {3.451310107240489*^9, 3.451310118200808*^9}, {
   3.451310263595197*^9, 3.451310298589516*^9}, {3.451310352746823*^9, 
   3.451310363895307*^9}, {3.451310667931386*^9, 3.451310671739929*^9}, {
   3.451310707382622*^9, 3.451310714106381*^9}, {3.451310759527926*^9, 
   3.451310833851115*^9}, {3.451310982642042*^9, 3.451310990694074*^9}, {
   3.451311024067461*^9, 3.451311081329015*^9}, {3.4513111189078*^9, 
   3.45131113642092*^9}, {3.451311224759491*^9, 3.451311279775746*^9}, {
   3.451311318294668*^9, 3.451311348478362*^9}, {3.451311398117511*^9, 
   3.451311454531801*^9}, {3.451311496114145*^9, 3.451311498176133*^9}, {
   3.451311640257272*^9, 3.451311660215968*^9}, {3.451311694177867*^9, 
   3.451311711164252*^9}, {3.45131175116227*^9, 3.451311752485016*^9}, {
   3.451313579962296*^9, 3.451313636277235*^9}, {3.451313679020449*^9, 
   3.451313691487033*^9}, {3.451313871574938*^9, 3.451313897551419*^9}, {
   3.451314206172668*^9, 3.451314316531118*^9}, {3.451314357981735*^9, 
   3.451314365131501*^9}, {3.451314902903805*^9, 3.451314905268507*^9}, {
   3.451314967152302*^9, 3.451314995104364*^9}, {3.451315039281391*^9, 
   3.451315048581954*^9}, 3.451315197868634*^9, {3.45131538633679*^9, 
   3.45131542980099*^9}, {3.451315464795057*^9, 3.45131550981672*^9}, 
   3.451316538607953*^9, {3.451316638193289*^9, 3.451316642188428*^9}, {
   3.451316795427204*^9, 3.451316847434473*^9}, {3.451316879051845*^9, 
   3.451316886580526*^9}, {3.451317309566329*^9, 3.451317312431387*^9}, 
   3.451317554757759*^9, 3.451317592538065*^9, {3.451317766416519*^9, 
   3.451317820963029*^9}, {3.451318242914377*^9, 3.451318302140006*^9}, {
   3.451318401680405*^9, 3.451318403092815*^9}, {3.451318441142556*^9, 
   3.451318448573037*^9}, {3.451318556738251*^9, 3.451318561137216*^9}, {
   3.451318599102434*^9, 3.451318601739819*^9}, {3.451318648875968*^9, 
   3.451318649405384*^9}, {3.451318705395783*^9, 3.451318711549563*^9}, {
   3.451318770977006*^9, 3.451318793524523*^9}, 3.451318864492731*^9, {
   3.451319244390798*^9, 3.451319264365819*^9}, {3.451319318521038*^9, 
   3.451319337644956*^9}, {3.451319616129108*^9, 3.45131964005324*^9}, {
   3.451319750454747*^9, 3.451319799920457*^9}, 3.451319966581215*^9, {
   3.451320034520368*^9, 3.451320105005765*^9}, {3.451320148547304*^9, 
   3.451320182723257*^9}, {3.451320322596859*^9, 3.451320324136073*^9}, {
   3.451320355000828*^9, 3.451320367290092*^9}, {3.451320462584922*^9, 
   3.451320607768713*^9}, {3.451320644145333*^9, 3.451320645057535*^9}, 
   3.451320709097728*^9, {3.451320853572097*^9, 3.451320880953523*^9}, {
   3.451320920612531*^9, 3.451320929035824*^9}, {3.451321106362252*^9, 
   3.451321114203757*^9}, {3.451321224949722*^9, 3.451321257649179*^9}, {
   3.451321289906261*^9, 3.451321315943128*^9}, {3.451321358474275*^9, 
   3.451321417904009*^9}, {3.451321476196101*^9, 3.45132147824559*^9}, {
   3.451321516120502*^9, 3.451321573243551*^9}, {3.451321606695263*^9, 
   3.451321632575289*^9}, {3.451321741300334*^9, 3.451321770392265*^9}, {
   3.451321827183165*^9, 3.451321922843863*^9}, {3.451322652668481*^9, 
   3.451322656754155*^9}, 3.451322833574135*^9, {3.451322994084517*^9, 
   3.451323012545414*^9}, {3.45132312114273*^9, 3.451323146105642*^9}, {
   3.451323288539846*^9, 3.45132328992975*^9}, {3.45132448325616*^9, 
   3.45132448635961*^9}, {3.451325089425001*^9, 3.451325092521304*^9}, {
   3.451325146162206*^9, 3.45132514972307*^9}, {3.45132519594461*^9, 
   3.451325202186891*^9}, {3.45132526511031*^9, 3.451325293677654*^9}, 
   3.451325343690432*^9, {3.451325392316297*^9, 3.451325395164651*^9}, {
   3.451325513829516*^9, 3.451325515266582*^9}, {3.451393442241178*^9, 
   3.451393506447486*^9}, {3.451393557764741*^9, 3.451393565046171*^9}, {
   3.451393609055195*^9, 3.451393609976013*^9}, {3.451393694866458*^9, 
   3.451393783613338*^9}, {3.451394455023012*^9, 3.451394505395391*^9}, {
   3.451394538615529*^9, 3.451394575390954*^9}, {3.451394731067636*^9, 
   3.451394732057475*^9}, {3.45139496975802*^9, 3.451394971425963*^9}, {
   3.451395150115611*^9, 3.451395151672244*^9}, {3.451396364038903*^9, 
   3.451396373438163*^9}, {3.451396411511585*^9, 3.451396419664153*^9}, {
   3.451396476411971*^9, 3.451396509040744*^9}, 3.451396591783289*^9, {
   3.451396710766448*^9, 3.451396727269069*^9}, {3.451396774084481*^9, 
   3.451396781147268*^9}, {3.451396879289884*^9, 3.451396909709573*^9}, 
   3.451397017291325*^9, 3.451397096516548*^9, {3.451397283700373*^9, 
   3.451397295391855*^9}, {3.451647565188702*^9, 3.451647576756286*^9}, {
   3.451647765201499*^9, 3.451647772286258*^9}, {3.451914552198961*^9, 
   3.451914553827636*^9}, {3.451977035415851*^9, 3.451977064648639*^9}, {
   3.451977218605545*^9, 3.451977309760787*^9}, {3.451977341425075*^9, 
   3.451977349656208*^9}, {3.451977415194409*^9, 3.451977438602567*^9}, {
   3.451977482234568*^9, 3.451977570335019*^9}, {3.451977685801143*^9, 
   3.451977730398402*^9}, {3.451977801010382*^9, 3.4519778131909*^9}, {
   3.451977927635835*^9, 3.451977946193233*^9}, {3.451977981580003*^9, 
   3.451978074914122*^9}, {3.451978573909292*^9, 3.451978613295869*^9}, 
   3.451979137567778*^9, {3.451979475608387*^9, 3.451979484427895*^9}, 
   3.451980802501036*^9, 3.451980841444482*^9, 3.451982944421107*^9, {
   3.451983049108007*^9, 3.451983050808983*^9}, 3.451986546188676*^9, 
   3.451991829776616*^9, 3.451991874165471*^9, 3.451993157779084*^9, 
   3.451994167702954*^9, {3.451994664709835*^9, 3.451994670751077*^9}, 
   3.451994779744119*^9, {3.452348282351801*^9, 3.452348305948626*^9}, {
   3.452348863877905*^9, 3.452348871593252*^9}, {3.452348929645624*^9, 
   3.452349093005576*^9}, 3.452349163354316*^9, {3.452349358879036*^9, 
   3.452349368717949*^9}, {3.452359212814083*^9, 3.452359244996783*^9}, 
   3.452359287480445*^9, {3.452359641842327*^9, 3.452359645761994*^9}, {
   3.452429188587701*^9, 3.452429253893454*^9}, {3.452429423136294*^9, 
   3.452429431757532*^9}, {3.452429844069095*^9, 3.45242989490154*^9}, {
   3.452430820875636*^9, 3.452430826647256*^9}, {3.45243194133154*^9, 
   3.45243199971685*^9}, {3.452432043776312*^9, 3.452432127756735*^9}, {
   3.45243359203066*^9, 3.452433593100255*^9}, {3.452435358833192*^9, 
   3.452435442003799*^9}, {3.452435605467979*^9, 3.452435611527364*^9}, {
   3.452436748418093*^9, 3.452436792321338*^9}, {3.452436848805842*^9, 
   3.452436874257032*^9}, {3.452436961431523*^9, 3.452436978283443*^9}, {
   3.452503093412571*^9, 3.452503110464109*^9}, {3.452503146109683*^9, 
   3.452503157461646*^9}, {3.452503284626043*^9, 3.452503319379188*^9}, {
   3.452503352427569*^9, 3.452503368013224*^9}, {3.452503404948382*^9, 
   3.452503453564687*^9}, {3.452503486553225*^9, 3.452503531854947*^9}, 
   3.452503593452378*^9, {3.452503631002014*^9, 3.452503670452252*^9}, {
   3.452503782998762*^9, 3.452503784981463*^9}, {3.452503879248304*^9, 
   3.452503957728077*^9}, {3.452504506990491*^9, 3.452504507636656*^9}, 
   3.452504792261655*^9, {3.452506674608892*^9, 3.452506720642256*^9}, {
   3.45250675276557*^9, 3.452506767789893*^9}, {3.452506829889426*^9, 
   3.452506873011254*^9}, 3.45250691472205*^9, {3.45250777098386*^9, 
   3.452507842638114*^9}, {3.452507916052414*^9, 3.452507917064661*^9}, {
   3.452508015620077*^9, 3.452508030439877*^9}, {3.45250807995802*^9, 
   3.452508296606786*^9}, 3.452508423384269*^9, {3.452514915342416*^9, 
   3.452514938156737*^9}, 3.452514979606844*^9, {3.452515039060203*^9, 
   3.452515069780996*^9}, {3.452515145261898*^9, 3.452515148942493*^9}, {
   3.452515376042645*^9, 3.452515387199572*^9}, {3.452515469981488*^9, 
   3.452515514019583*^9}, {3.452515597592275*^9, 3.4525155997104*^9}, 
   3.452515643257802*^9, {3.452515684269518*^9, 3.45251569746131*^9}, {
   3.452516337832653*^9, 3.4525163492042*^9}, 3.452516386477176*^9, {
   3.452516417636282*^9, 3.452516424228562*^9}, 3.45251648528596*^9, {
   3.452519113447012*^9, 3.452519115411517*^9}, {3.452523118552426*^9, 
   3.45252319631394*^9}, {3.452523273539466*^9, 3.452523364761584*^9}, {
   3.452523474002623*^9, 3.452523552913832*^9}, {3.452523670432908*^9, 
   3.45252373309401*^9}, {3.452524093638799*^9, 3.452524095723497*^9}, {
   3.452524499403295*^9, 3.452524509725414*^9}, {3.452524651780485*^9, 
   3.452524677538398*^9}, {3.452524806900699*^9, 3.452524835424355*^9}, 
   3.452524915726926*^9, {3.452525073385259*^9, 3.452525074583793*^9}, {
   3.452868342677113*^9, 3.452868424347162*^9}, {3.452868473643052*^9, 
   3.452868509373667*^9}, 3.453026354854609*^9, {3.453028646063574*^9, 
   3.453028704708974*^9}, 3.453029469704161*^9, {3.453049977288517*^9, 
   3.453050003003448*^9}, {3.453050055734805*^9, 3.453050058306759*^9}, {
   3.454160173640182*^9, 3.45416019350575*^9}, {3.454160543122427*^9, 
   3.454160544532884*^9}, 3.454241200950289*^9, {3.454242017600466*^9, 
   3.454242021654102*^9}, {3.454761292322582*^9, 3.454761293003883*^9}, 
   3.454761557470408*^9, {3.468782362232524*^9, 3.468782364673059*^9}, 
   3.4693725867646112`*^9, {3.4693727598401823`*^9, 3.469372762232087*^9}, {
   3.469375149124605*^9, 3.469375150077389*^9}, 3.492694026576476*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/movies\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"saveallgraphs", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"vs", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"o", ",", "v1"}], 
               RowBox[{"(*", 
                RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
             ")"}], "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"varmultipliers", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"varmultipliers", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
             "}"}]}], "]"}], "+", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
               RowBox[{"runids", "[", 
                RowBox[{"[", 
                 RowBox[{"ks", "[", 
                  RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
               "\"\</\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", 
                RowBox[{"dimensions", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
               "\"\<d.nc\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Datasets\>\"", ",", 
                RowBox[{"datanames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"years", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
               RowBox[{"runids", "[", 
                RowBox[{"[", 
                 RowBox[{"ks", "[", 
                  RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
               "\"\</\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", 
                RowBox[{"dimensions", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
               "\"\<d.nc\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Datasets\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                  "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nnetcdfyears2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"years", "[", 
              RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               "<", "bignumber"}], ",", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
              ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"nnetcdfyears2", "[", 
               RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "genielat"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"netcdfdataall", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ks", "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
               "l"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"years", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"yearsall", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ks", "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
               "l"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nnetcdfyears2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"years", "[", 
              RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"minyear", "=", 
       RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"maxima", "=", 
       RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"minima", "=", 
       RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"netcdfdatadiff", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a", "=", "1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "landmask"}], ",", 
           "2"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"a", "=", "3"}]}], 
       RowBox[{"(*", 
        RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "seamask"}], ",", 
           "2"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"a", "=", "2"}]}], 
       RowBox[{"(*", 
        RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "1"}], ",", 
        RowBox[{
         RowBox[{"netcdfdatamask", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"netcdfdata", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
              "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
           "]"}]}], ";", 
         RowBox[{"netcdfdatadiffmask", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"netcdfdatadiff", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
              "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"latdata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "==", "1"}], ",", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}], "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", "0.", "}"}], ",", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"netcdfdatamask", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                  "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"genielatsused", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatamax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatamin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"legend", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
           ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "320", "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"None", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                 "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
              "}"}], "[", 
             RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"charttable", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
              "SpanFromLeft", ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                  "]"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                RowBox[{"AspectRatio", "\[Rule]", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "580", "}"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
               "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"vartitles", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold", 
                 ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}],
                 "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<difference from control\>\"", ",", "Orange", ",", "Bold",
                  ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", "~~", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "~~", 
                  "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                 "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"ArrayPlot", "[", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
                   RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                   RowBox[{
                   "ColorFunction", "\[Rule]", 
                    "\"\<ThermometerColors\>\""}]}], "]"}], ",", 
                 RowBox[{"ArrayPlot", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   ",", 
                   RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "250", "}"}]}], ",", " ", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "None", ",", "None"}], "}"}]}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"{", "Blue", "}"}], "}"}]}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"o", ",", 
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\< (\>\"", "~~", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"alpha", ",", 
              RowBox[{"{", 
               RowBox[{"ks", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}], "]"}], 
         "~~", "\"\<_\>\"", "~~", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\<_movie4.gif\>\""}], ",", "charttable"}], "]"}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "nvar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v1", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v2", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v3", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v4", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1"}], 
      RowBox[{"(*", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}], "*)"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9, {3.469369970565373*^9, 
   3.469370314917918*^9}, 3.469370506662942*^9, {3.4693705791252193`*^9, 
   3.4693706080576143`*^9}, {3.4693706544501677`*^9, 3.469370783803628*^9}, {
   3.4693709957804537`*^9, 3.46937106051873*^9}, {3.469371186274736*^9, 
   3.469371213857465*^9}, {3.469371249660589*^9, 3.469371262080793*^9}, 
   3.469371494155141*^9, {3.46937167644821*^9, 3.469371696399157*^9}, 
   3.4693721124962*^9, 3.469372644700746*^9, {3.469372689290595*^9, 
   3.469372693394063*^9}, {3.469375155728794*^9, 3.469375157076563*^9}, 
   3.49269402775*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["viii. Comparisons", "Subsection",
 CellChangeTimes->{{3.420282050765625*^9, 3.420282062234375*^9}, {
   3.4202821036875*^9, 3.4202821080625*^9}, {3.420282492359375*^9, 
   3.420282495671875*^9}, {3.420282534578125*^9, 3.4202825380625*^9}, {
   3.420286148765625*^9, 3.42028618440625*^9}, {3.437839579698013*^9, 
   3.437839584817169*^9}, {3.437928317568321*^9, 3.437928334910267*^9}, 
   3.438600155786071*^9, 3.438600257996916*^9, 3.449390210821377*^9, 
   3.449404818495207*^9, {3.451643465953395*^9, 3.45164346952053*^9}, {
   3.45164355736333*^9, 3.451643642324035*^9}, {3.451646840517789*^9, 
   3.451646845819886*^9}, 3.451986168840094*^9, {3.452437493594726*^9, 
   3.452437501081405*^9}, 3.452517119361092*^9, 3.452872469640272*^9, 
   3.452881281314605*^9, 3.45305012616205*^9, 3.453713121361555*^9, {
   3.4633967764791403`*^9, 3.463396776662822*^9}, {3.4633968071007423`*^9, 
   3.463396808037602*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vs", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"o", ",", "v1"}], 
                RowBox[{"(*", 
                 RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
              ")"}], "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"varmultipliers", "[", 
                 RowBox[{"[", 
                  RowBox[{"vs", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
              "}"}]}], "]"}], "+", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"datanames", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
                RowBox[{"runids", "[", 
                 RowBox[{"[", 
                  RowBox[{"ks", "[", 
                   RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
                "\"\</\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
                RowBox[{"netcdfmodules", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
                RowBox[{"ToString", "[", 
                 RowBox[{"dimensions", "[", 
                  RowBox[{"[", 
                   RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
                "\"\<d.nc\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Datasets\>\"", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                   "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"netcdfdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
                "<", "bignumber"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"nnetcdfyears2", "[", 
                RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "genielat"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"netcdfdata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"netcdfdataall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"years", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"yearsall", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
                "l"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nnetcdfyears2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"years", "[", 
               RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"minyear", "=", 
        RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxima", "=", 
        RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"minima", "=", 
        RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"netcdfdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
           RowBox[{"netcdfdata", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"netcdfdatamask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
            "]"}]}], ";", 
          RowBox[{"netcdfdatadiffmask", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"netcdfdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
               "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"netcdfstartyearnos", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"o", ",", 
               RowBox[{"nvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"latdata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                    "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "1"}], ",", 
               RowBox[{"netcdfdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"y", "-", 
                   RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                   "i"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "0.", "}"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], "]"}]}], "]"}],
              "]"}], ",", 
            RowBox[{"genielatsused", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "genielat", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latdatamax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatamin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdata", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdata", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatadiffmax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdatadiff", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"latdatadiffmin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"latdatadiff", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"old", "=", 
        RowBox[{
         RowBox[{"FullOptions", "[", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"latdatamin", ",", "latdatamax"}], "}"}], ",", 
                "Automatic"}], "}"}]}], ",", 
             RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",",
            "FrameTicks"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"new", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Rest", "[", "#1", "]"}], ",", 
             RowBox[{"latdatamin", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "-", "latdatadiffmin"}],
                   ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                   "\[Equal]", "0."}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                  RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], "]"}], 
                ")"}]}]}]}], "]"}], "&"}], ")"}], "/@", "old"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newlatdatadiff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"latdatamin", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "-", "latdatadiffmin"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}],
                  "/", 
                 RowBox[{"(", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    "\[Equal]", "0."}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], 
                   "]"}], ")"}]}]}], "&"}], "/@", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"latdatadiff", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"charttable", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}]}], "}"}], "[", 
                 RowBox[{"[", "x", "]"}], "]"}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "300", "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}], ",", 
                RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
                   "}"}], "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"latdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
                RowBox[{"newlatdatadiff", "[", 
                 RowBox[{"[", 
                  RowBox[{"y", ",", "o"}], "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.1", "*", 
                  RowBox[{"{", 
                   RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", "250", "}"}]}], ",", " ", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                  "]"}], ",", "new", ",", "None"}], "}"}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "Orange", "}"}]}], "}"}]}], ",", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "Blue", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "Orange", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"netcdfstartyearnos", "[", 
             RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ArrayPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
            ",", 
            RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", "320", "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", "None"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                  "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
               "}"}], "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListAnimate", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                "SpanFromLeft", ",", 
                RowBox[{"ListLogLinearPlot", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                    "]"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                  RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                  RowBox[{"AspectRatio", "\[Rule]", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                  RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", "580", "}"}]}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                  RowBox[{"FrameLabel", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                    "}"}]}], ",", 
                  RowBox[{"GridLines", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
                 "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"vartitles", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold",
                    ",", "15"}], "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<difference from control\>\"", ",", "Orange", ",", 
                   "Bold", ",", "15"}], "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"\"\<averages (\>\"", "~~", 
                    RowBox[{"masknames", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "~~", 
                    "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                   "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"charttable", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o", ",", "3"}], "]"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"o", ",", 
                   RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<\>\"", ",", 
                RowBox[{"legend", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"legend", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"longnames", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\< (\>\"", "~~", 
                  RowBox[{"units", "[", 
                   RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                  "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"1", "+", "minyear", "-", 
                  RowBox[{"netcdfstartyearnos", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
         RowBox[{"DefaultDuration", "\[Rule]", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"minyear", "-", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"Deployed", "->", "True"}], ",", 
         RowBox[{"AnimatorElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ProgressSlider\>\"", ",", "\"\<PlayPauseButton\>\"", ",", 
            "\"\<StepLeftButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "1", ",", 
          RowBox[{"vartitles", "[", 
           RowBox[{"[", 
            RowBox[{"vs", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"varvalues", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nvars", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v2", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v3", ",", "1", ",", 
            RowBox[{"vartitles", "[", 
             RowBox[{"[", 
              RowBox[{"vs", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"varvalues", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "\"\<module\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"netcdfmodules", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nnetcdfmodules"}], "}"}]}], "]"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "1", ",", "\"\<dimensions\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<2\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "\"\<ouput variable\>\""}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", 
           RowBox[{"datanames", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "d", ",", "i"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nrealdata", "[", 
             RowBox[{"[", 
              RowBox[{"m", ",", "d"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "\"\<averaging mask\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "\"\<land and sea\>\""}], ",", 
          RowBox[{"2", "\[Rule]", "\"\<land only\>\""}], ",", 
          RowBox[{"3", "\[Rule]", "\"\<sea only\>\""}]}], "}"}]}], "}"}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "\"\<input variable to compare\>\""}], 
      "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"vartitles", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.451309414063614*^9, 3.451309510953402*^9}, {
   3.451309598429776*^9, 3.451309617982269*^9}, {3.451309653586308*^9, 
   3.451309711282247*^9}, {3.451309749128101*^9, 3.451309793567101*^9}, {
   3.451309836455378*^9, 3.451309910414605*^9}, {3.451309995122858*^9, 
   3.451309995634495*^9}, {3.451310107240489*^9, 3.451310118200808*^9}, {
   3.451310263595197*^9, 3.451310298589516*^9}, {3.451310352746823*^9, 
   3.451310363895307*^9}, {3.451310667931386*^9, 3.451310671739929*^9}, {
   3.451310707382622*^9, 3.451310714106381*^9}, {3.451310759527926*^9, 
   3.451310833851115*^9}, {3.451310982642042*^9, 3.451310990694074*^9}, {
   3.451311024067461*^9, 3.451311081329015*^9}, {3.4513111189078*^9, 
   3.45131113642092*^9}, {3.451311224759491*^9, 3.451311279775746*^9}, {
   3.451311318294668*^9, 3.451311348478362*^9}, {3.451311398117511*^9, 
   3.451311454531801*^9}, {3.451311496114145*^9, 3.451311498176133*^9}, {
   3.451311640257272*^9, 3.451311660215968*^9}, {3.451311694177867*^9, 
   3.451311711164252*^9}, {3.45131175116227*^9, 3.451311752485016*^9}, {
   3.451313579962296*^9, 3.451313636277235*^9}, {3.451313679020449*^9, 
   3.451313691487033*^9}, {3.451313871574938*^9, 3.451313897551419*^9}, {
   3.451314206172668*^9, 3.451314316531118*^9}, {3.451314357981735*^9, 
   3.451314365131501*^9}, {3.451314902903805*^9, 3.451314905268507*^9}, {
   3.451314967152302*^9, 3.451314995104364*^9}, {3.451315039281391*^9, 
   3.451315048581954*^9}, 3.451315197868634*^9, {3.45131538633679*^9, 
   3.45131542980099*^9}, {3.451315464795057*^9, 3.45131550981672*^9}, 
   3.451316538607953*^9, {3.451316638193289*^9, 3.451316642188428*^9}, {
   3.451316795427204*^9, 3.451316847434473*^9}, {3.451316879051845*^9, 
   3.451316886580526*^9}, {3.451317309566329*^9, 3.451317312431387*^9}, 
   3.451317554757759*^9, 3.451317592538065*^9, {3.451317766416519*^9, 
   3.451317820963029*^9}, {3.451318242914377*^9, 3.451318302140006*^9}, {
   3.451318401680405*^9, 3.451318403092815*^9}, {3.451318441142556*^9, 
   3.451318448573037*^9}, {3.451318556738251*^9, 3.451318561137216*^9}, {
   3.451318599102434*^9, 3.451318601739819*^9}, {3.451318648875968*^9, 
   3.451318649405384*^9}, {3.451318705395783*^9, 3.451318711549563*^9}, {
   3.451318770977006*^9, 3.451318793524523*^9}, 3.451318864492731*^9, {
   3.451319244390798*^9, 3.451319264365819*^9}, {3.451319318521038*^9, 
   3.451319337644956*^9}, {3.451319616129108*^9, 3.45131964005324*^9}, {
   3.451319750454747*^9, 3.451319799920457*^9}, 3.451319966581215*^9, {
   3.451320034520368*^9, 3.451320105005765*^9}, {3.451320148547304*^9, 
   3.451320182723257*^9}, {3.451320322596859*^9, 3.451320324136073*^9}, {
   3.451320355000828*^9, 3.451320367290092*^9}, {3.451320462584922*^9, 
   3.451320607768713*^9}, {3.451320644145333*^9, 3.451320645057535*^9}, 
   3.451320709097728*^9, {3.451320853572097*^9, 3.451320880953523*^9}, {
   3.451320920612531*^9, 3.451320929035824*^9}, {3.451321106362252*^9, 
   3.451321114203757*^9}, {3.451321224949722*^9, 3.451321257649179*^9}, {
   3.451321289906261*^9, 3.451321315943128*^9}, {3.451321358474275*^9, 
   3.451321417904009*^9}, {3.451321476196101*^9, 3.45132147824559*^9}, {
   3.451321516120502*^9, 3.451321573243551*^9}, {3.451321606695263*^9, 
   3.451321632575289*^9}, {3.451321741300334*^9, 3.451321770392265*^9}, {
   3.451321827183165*^9, 3.451321922843863*^9}, {3.451322652668481*^9, 
   3.451322656754155*^9}, 3.451322833574135*^9, {3.451322994084517*^9, 
   3.451323012545414*^9}, {3.45132312114273*^9, 3.451323146105642*^9}, {
   3.451323288539846*^9, 3.45132328992975*^9}, {3.45132448325616*^9, 
   3.45132448635961*^9}, {3.451325089425001*^9, 3.451325092521304*^9}, {
   3.451325146162206*^9, 3.45132514972307*^9}, {3.45132519594461*^9, 
   3.451325202186891*^9}, {3.45132526511031*^9, 3.451325293677654*^9}, 
   3.451325343690432*^9, {3.451325392316297*^9, 3.451325395164651*^9}, {
   3.451325513829516*^9, 3.451325515266582*^9}, {3.451393442241178*^9, 
   3.451393506447486*^9}, {3.451393557764741*^9, 3.451393565046171*^9}, {
   3.451393609055195*^9, 3.451393609976013*^9}, {3.451393694866458*^9, 
   3.451393783613338*^9}, {3.451394455023012*^9, 3.451394505395391*^9}, {
   3.451394538615529*^9, 3.451394575390954*^9}, {3.451394731067636*^9, 
   3.451394732057475*^9}, {3.45139496975802*^9, 3.451394971425963*^9}, {
   3.451395150115611*^9, 3.451395151672244*^9}, {3.451396364038903*^9, 
   3.451396373438163*^9}, {3.451396411511585*^9, 3.451396419664153*^9}, {
   3.451396476411971*^9, 3.451396509040744*^9}, 3.451396591783289*^9, {
   3.451396710766448*^9, 3.451396727269069*^9}, {3.451396774084481*^9, 
   3.451396781147268*^9}, {3.451396879289884*^9, 3.451396909709573*^9}, 
   3.451397017291325*^9, 3.451397096516548*^9, {3.451397283700373*^9, 
   3.451397295391855*^9}, {3.451647565188702*^9, 3.451647576756286*^9}, {
   3.451647765201499*^9, 3.451647772286258*^9}, {3.451914552198961*^9, 
   3.451914553827636*^9}, {3.451977035415851*^9, 3.451977064648639*^9}, {
   3.451977218605545*^9, 3.451977309760787*^9}, {3.451977341425075*^9, 
   3.451977349656208*^9}, {3.451977415194409*^9, 3.451977438602567*^9}, {
   3.451977482234568*^9, 3.451977570335019*^9}, {3.451977685801143*^9, 
   3.451977730398402*^9}, {3.451977801010382*^9, 3.4519778131909*^9}, {
   3.451977927635835*^9, 3.451977946193233*^9}, {3.451977981580003*^9, 
   3.451978074914122*^9}, {3.451978573909292*^9, 3.451978613295869*^9}, 
   3.451979137567778*^9, {3.451979475608387*^9, 3.451979484427895*^9}, 
   3.451980802501036*^9, 3.451980841444482*^9, 3.451982944421107*^9, {
   3.451983049108007*^9, 3.451983050808983*^9}, 3.451986546188676*^9, 
   3.451991829776616*^9, 3.451991874165471*^9, 3.451993157779084*^9, 
   3.451994167702954*^9, {3.451994664709835*^9, 3.451994670751077*^9}, 
   3.451994779744119*^9, {3.452348282351801*^9, 3.452348305948626*^9}, {
   3.452348863877905*^9, 3.452348871593252*^9}, {3.452348929645624*^9, 
   3.452349093005576*^9}, 3.452349163354316*^9, {3.452349358879036*^9, 
   3.452349368717949*^9}, {3.452359212814083*^9, 3.452359244996783*^9}, 
   3.452359287480445*^9, {3.452359641842327*^9, 3.452359645761994*^9}, {
   3.452429188587701*^9, 3.452429253893454*^9}, {3.452429423136294*^9, 
   3.452429431757532*^9}, {3.452429844069095*^9, 3.45242989490154*^9}, {
   3.452430820875636*^9, 3.452430826647256*^9}, {3.45243194133154*^9, 
   3.45243199971685*^9}, {3.452432043776312*^9, 3.452432127756735*^9}, {
   3.45243359203066*^9, 3.452433593100255*^9}, {3.452435358833192*^9, 
   3.452435442003799*^9}, {3.452435605467979*^9, 3.452435611527364*^9}, {
   3.452436748418093*^9, 3.452436792321338*^9}, {3.452436848805842*^9, 
   3.452436874257032*^9}, {3.452436961431523*^9, 3.452436978283443*^9}, {
   3.452503093412571*^9, 3.452503110464109*^9}, {3.452503146109683*^9, 
   3.452503157461646*^9}, {3.452503284626043*^9, 3.452503319379188*^9}, {
   3.452503352427569*^9, 3.452503368013224*^9}, {3.452503404948382*^9, 
   3.452503453564687*^9}, {3.452503486553225*^9, 3.452503531854947*^9}, 
   3.452503593452378*^9, {3.452503631002014*^9, 3.452503670452252*^9}, {
   3.452503782998762*^9, 3.452503784981463*^9}, {3.452503879248304*^9, 
   3.452503957728077*^9}, {3.452504506990491*^9, 3.452504507636656*^9}, 
   3.452504792261655*^9, {3.452506674608892*^9, 3.452506720642256*^9}, {
   3.45250675276557*^9, 3.452506767789893*^9}, {3.452506829889426*^9, 
   3.452506873011254*^9}, 3.45250691472205*^9, {3.45250777098386*^9, 
   3.452507842638114*^9}, {3.452507916052414*^9, 3.452507917064661*^9}, {
   3.452508015620077*^9, 3.452508030439877*^9}, {3.45250807995802*^9, 
   3.452508296606786*^9}, 3.452508423384269*^9, {3.452514915342416*^9, 
   3.452514938156737*^9}, 3.452514979606844*^9, {3.452515039060203*^9, 
   3.452515069780996*^9}, {3.452515145261898*^9, 3.452515148942493*^9}, {
   3.452515376042645*^9, 3.452515387199572*^9}, {3.452515469981488*^9, 
   3.452515514019583*^9}, {3.452515597592275*^9, 3.4525155997104*^9}, 
   3.452515643257802*^9, {3.452515684269518*^9, 3.45251569746131*^9}, {
   3.452516337832653*^9, 3.4525163492042*^9}, 3.452516386477176*^9, {
   3.452516417636282*^9, 3.452516424228562*^9}, 3.45251648528596*^9, {
   3.452519113447012*^9, 3.452519115411517*^9}, {3.452523118552426*^9, 
   3.45252319631394*^9}, {3.452523273539466*^9, 3.452523364761584*^9}, {
   3.452523474002623*^9, 3.452523552913832*^9}, {3.452523670432908*^9, 
   3.45252373309401*^9}, {3.452524093638799*^9, 3.452524095723497*^9}, {
   3.452524499403295*^9, 3.452524509725414*^9}, {3.452524651780485*^9, 
   3.452524677538398*^9}, {3.452524806900699*^9, 3.452524835424355*^9}, 
   3.452524915726926*^9, {3.452525073385259*^9, 3.452525074583793*^9}, {
   3.452868342677113*^9, 3.452868424347162*^9}, {3.452868473643052*^9, 
   3.452868509373667*^9}, 3.453026354854609*^9, {3.453047170290616*^9, 
   3.453047222902038*^9}, {3.453047345001338*^9, 3.453047345555835*^9}, {
   3.453047400803503*^9, 3.453047405764336*^9}, {3.45304792741428*^9, 
   3.453047928752829*^9}, {3.453047986896889*^9, 3.453047988294438*^9}, {
   3.453048046413538*^9, 3.453048130366547*^9}, {3.453048949546727*^9, 
   3.453048972050119*^9}, {3.453049032174745*^9, 3.453049038629628*^9}, {
   3.45304912056631*^9, 3.453049126737641*^9}, 3.453049176846592*^9, 
   3.453049373631403*^9, {3.453049681351129*^9, 3.453049688115321*^9}, {
   3.453050865366989*^9, 3.453050866468097*^9}, 3.45305100304926*^9, 
   3.453658467844346*^9, {3.45415762364404*^9, 3.454157639976216*^9}, {
   3.454160032717737*^9, 3.454160036827556*^9}, {3.454160071141939*^9, 
   3.454160098032607*^9}, {3.454160282815613*^9, 3.454160291459497*^9}, {
   3.454240964022716*^9, 3.454240991011646*^9}, 3.468782369331616*^9, {
   3.4693727051709127`*^9, 3.469372721105604*^9}, 3.492694029310528*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</Users/Greg/Documents/PhD/movies\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"saveallgraphs", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"vs", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nvar"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"o", ",", "v1"}], 
               RowBox[{"(*", 
                RowBox[{",", "v2", ",", "v3"}], "*)"}], "}"}], "-", "1"}], 
             ")"}], "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"varmultipliers", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"varmultipliers", "[", 
               RowBox[{"[", 
                RowBox[{"vs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"varmultipliers", "[", 
                RowBox[{"[", 
                 RowBox[{"vs", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "*)"}], 
             "}"}]}], "]"}], "+", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"readinalldata", "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
               RowBox[{"runids", "[", 
                RowBox[{"[", 
                 RowBox[{"ks", "[", 
                  RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
               "\"\</\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", 
                RowBox[{"dimensions", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
               "\"\<d.nc\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Datasets\>\"", ",", 
                RowBox[{"datanames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"years", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"outputfolder", "~~", "\"\</\>\"", "~~", 
               RowBox[{"runids", "[", 
                RowBox[{"[", 
                 RowBox[{"ks", "[", 
                  RowBox[{"[", "o", "]"}], "]"}], "]"}], "]"}], "~~", 
               "\"\</\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\</fields_\>\"", "~~", 
               RowBox[{"netcdfmodules", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
               RowBox[{"ToString", "[", 
                RowBox[{"dimensions", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d"}], "]"}], "]"}], "]"}], "~~", 
               "\"\<d.nc\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Datasets\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"m", "==", "4"}], ",", "\"\<time\>\"", ",", 
                  "\"\<year\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nnetcdfyears2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"years", "[", 
              RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"netcdfdata", "[", 
                RowBox[{"[", 
                 RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
               "<", "bignumber"}], ",", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y", ",", "i", ",", "j"}], "]"}], "]"}], 
              ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"nnetcdfyears2", "[", 
               RowBox[{"[", "o", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "genielat"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "genielon"}], "}"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"netcdfdata", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"netcdfdataall", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ks", "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
               "l"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"years", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"yearsall", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ks", "[", 
                RowBox[{"[", "o", "]"}], "]"}], ",", "m", ",", "d", ",", 
               "l"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nnetcdfyears2", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"years", "[", 
              RowBox[{"[", "o", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"minyear", "=", 
       RowBox[{"Min", "[", "nnetcdfyears2", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"maxima", "=", 
       RowBox[{"Max", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"minima", "=", 
       RowBox[{"Min", "[", "netcdfdata", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"netcdfdatadiff", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", 
            RowBox[{"o", ",", "y"}], "]"}], "]"}], "-", 
          RowBox[{"netcdfdata", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "y"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a", "=", "1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"land", " ", "and", " ", "sea"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "landmask"}], ",", 
           "2"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"a", "=", "3"}]}], 
       RowBox[{"(*", 
        RowBox[{"sea", " ", "only"}], "*)"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"netcdfdata", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "seamask"}], ",", 
           "2"}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"a", "=", "2"}]}], 
       RowBox[{"(*", 
        RowBox[{"land", " ", "only"}], "*)"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "1"}], ",", 
        RowBox[{
         RowBox[{"netcdfdatamask", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"netcdfdata", "[", 
              RowBox[{"[", 
               RowBox[{"o", ",", "y"}], "]"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
              "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
           "]"}]}], ";", 
         RowBox[{"netcdfdatadiffmask", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"netcdfdatadiff", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", "o"}], "]"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "3"}], ",", "seamask", ",", "1"}], 
              "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "\[Equal]", "2"}], ",", "landmask", ",", "1"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"netcdfstartyearnos", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"o", ",", 
              RowBox[{"nvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"latdata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "==", "1"}], ",", 
              RowBox[{"netcdfdata", "[", 
               RowBox[{"[", 
                RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                   "0"}], "]"}], "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", "0.", "}"}], ",", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"netcdfdatamask", "[", 
                   RowBox[{"[", 
                    RowBox[{"o", ",", "y", ",", "i"}], "]"}], "]"}], ",", 
                  "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"genielatsused", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatadiff", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "==", "1"}], ",", 
              RowBox[{"netcdfdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"y", "-", 
                  RowBox[{"netcdfstartyearnos", "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",", 
                 "i"}], "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatadiffmask", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}], "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", "0.", "}"}], ",", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"netcdfdatadiffmask", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o", ",",
                     "i"}], "]"}], "]"}], ",", "0"}], "]"}]}], "]"}]}], "]"}],
             "]"}], ",", 
           RowBox[{"genielatsused", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "genielat", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatamax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatamin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdata", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdata", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatadiffmax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdatadiff", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"latdatadiffmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"latdatadiff", "[", 
            RowBox[{"[", 
             RowBox[{"y", ",", "o", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"netcdfstartyearnos", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", 
             RowBox[{"nvars", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"latdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"old", "=", 
       RowBox[{
        RowBox[{"FullOptions", "[", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"latdatamin", ",", "latdatamax"}], "}"}], ",", 
               "Automatic"}], "}"}]}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], ",", 
          "FrameTicks"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"new", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "#1", "]"}], ",", 
            RowBox[{"latdatamin", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "[", "#1", "]"}], "-", "latdatadiffmin"}], 
                 ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                  "\[Equal]", "0."}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                   ",", "1", ",", 
                   RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                 RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], "]"}], 
               ")"}]}]}]}], "]"}], "&"}], ")"}], "/@", "old"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newlatdatadiff", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"latdatamin", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "-", "latdatadiffmin"}], ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"latdatamax", "-", "latdatamin"}], ")"}]}], ")"}], 
                "/", 
                RowBox[{"(", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}], 
                    "\[Equal]", "0."}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"latdatamax", "-", "latdatamin"}], "==", "0."}], 
                    ",", "1", ",", 
                    RowBox[{"latdatamax", "-", "latdatamin"}]}], "]"}], ",", 
                   RowBox[{"latdatadiffmax", "-", "latdatadiffmin"}]}], "]"}],
                  ")"}]}]}], "&"}], "/@", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"latdatadiff", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"latdatadiff", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "o"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", 
           RowBox[{"nvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"legend", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ArrayPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "}"}], 
           ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", "320", "}"}]}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"None", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "+", 
                    RowBox[{"i", "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxima", ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"minima", ",", 
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}]}], "}"}], "[", 
                    RowBox[{"[", "x", "]"}], "]"}]}], ")"}], "/", 
                    "100"}]}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", "100", ",", "50"}], "}"}]}], 
                 "]"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<ThermometerColors\>\"", ",", "\"\<Rainbow\>\""}], 
              "}"}], "[", 
             RowBox[{"[", "x", "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"charttable", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "v1"}], "]"}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{"~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "v2"}], "]"}], "]"}],
                     "~~", "\"\<; \>\"", "~~", 
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "v3"}], "]"}], 
                    "]"}]}], "*)"}], "~~", "\"\<\\n\>\""}], ",", "Black", ",",
                     "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"longnames", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\< (\>\"", "~~", 
                    RowBox[{"units", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                    "\"\<)\>\"", "~~", "\"\<\\n\>\""}], ",", "Green", ",", 
                    "Bold", ",", "20"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<year \>\"", ",", "Black", ",", "Bold", ",", "20"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "]"}], "~~", "\"\<\\n \>\""}], ",", "Red", ",", 
                    "Bold", ",", "20"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
              "SpanFromLeft", ",", 
              RowBox[{"ListLogLinearPlot", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "yy"}], "]"}], "]"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}], "==", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"netcdfdatamask", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "yy"}], "]"}], "]"}], "]"}], ",", "0"}],
                     "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"yy", ",", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}],
                  "]"}], ",", 
                RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
                RowBox[{"AspectRatio", "\[Rule]", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"2.5", "*", "GoldenRatio"}], ")"}]}]}], ",", 
                RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "580", "}"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<\>\""}], ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<year\>\"", ",", "None", ",", "None", ",", "None"}], 
                  "}"}]}], ",", 
                RowBox[{"GridLines", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"years1", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "-", "1"}]}], "]"}], 
                    "]"}], "}"}], ",", "None"}], "}"}]}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"nvars", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
               "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"vartitles", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", "Black", ",", "Bold", 
                 ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<data\>\"", ",", "Blue", ",", "Bold", ",", "15"}],
                 "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<difference from control\>\"", ",", "Orange", ",", "Bold",
                  ",", "15"}], "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<averages (\>\"", "~~", 
                  RowBox[{"masknames", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "~~", 
                  "\"\<):\\nglobal (top) / latitudinal (below)\>\""}], ",", 
                 "Black", ",", "Bold", ",", "15"}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"varvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"colours", "[", 
                    RowBox[{"[", "o", "]"}], "]"}], ",", "Bold", ",", "15"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"ArrayPlot", "[", 
                  RowBox[{
                   RowBox[{"netcdfdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"o", ",", "y"}], "]"}], "]"}], ",", 
                   RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"minima", ",", "maxima"}], "}"}]}], ",", 
                   RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                   RowBox[{
                   "ColorFunction", "\[Rule]", 
                    "\"\<ThermometerColors\>\""}]}], "]"}], ",", 
                 RowBox[{"ArrayPlot", "[", 
                  RowBox[{
                   RowBox[{"netcdfdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"y", "-", 
                    RowBox[{"netcdfstartyearnos", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", "1"}], ",", "o"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "300", "}"}]}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", "netcdfdatadiff", "]"}], ",", 
                    RowBox[{"Max", "[", "netcdfdatadiff", "]"}]}], "}"}]}], 
                   ",", 
                   RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
                   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
                  "]"}], ",", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"latdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o"}], "]"}], "]"}], ",", 
                    RowBox[{"newlatdatadiff", "[", 
                    RowBox[{"[", 
                    RowBox[{"y", ",", "o"}], "]"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.1", "*", 
                    RowBox[{"{", 
                    RowBox[{"latdatamin", ",", "latdatamax"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "250", "}"}]}], ",", " ", 
                   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                   RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30"}], "}"}]}], 
                    "]"}], ",", "new", ",", "None"}], "}"}]}], ",", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "Orange", "}"}]}], "}"}]}], ",", 
                   RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "Blue", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "Orange", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"o", ",", 
                 RowBox[{"nvars", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"legend", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"longnames", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\< (\>\"", "~~", 
                RowBox[{"units", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
                "\"\<)\>\""}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"netcdfstartyearnos", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", "minyear"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"ensemblename", "~~", "\"\<_\>\"", "~~", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"alpha", ",", 
              RowBox[{"{", 
               RowBox[{"ks", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}], "]"}], 
         "~~", "\"\<_\>\"", "~~", 
         RowBox[{"netcdfmodules", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "~~", "\"\<_\>\"", "~~", 
         RowBox[{"datanames", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "d", ",", "l"}], "]"}], "]"}], "~~", 
         "\"\<_movie5.gif\>\""}], ",", "charttable"}], "]"}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "nvar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v1", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v2", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v3", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"v4", ",", 
       RowBox[{"nvars", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m", ",", "nnetcdfmodules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1"}], 
      RowBox[{"(*", 
       RowBox[{"nrealdata", "[", 
        RowBox[{"[", 
         RowBox[{"m", ",", "d"}], "]"}], "]"}], "*)"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.450611605970873*^9, 3.450611640743047*^9}, {
   3.450611724604544*^9, 3.450611726268987*^9}, {3.450611808407832*^9, 
   3.450611824657334*^9}, {3.450611857363014*^9, 3.450611964172133*^9}, {
   3.45061201371459*^9, 3.450612042418729*^9}, {3.450612089145904*^9, 
   3.45061219056077*^9}, {3.450612233381248*^9, 3.450612235266161*^9}, {
   3.450612281700803*^9, 3.450612355387416*^9}, {3.450612430306988*^9, 
   3.450612469236551*^9}, {3.450612511085634*^9, 3.450612564234977*^9}, {
   3.450612736330091*^9, 3.450612736487692*^9}, {3.45061278534943*^9, 
   3.450612788790223*^9}, {3.450612833235061*^9, 3.450612848953296*^9}, {
   3.450612898884272*^9, 3.450612948146662*^9}, {3.450613051579308*^9, 
   3.45061306766814*^9}, {3.450613594875121*^9, 3.450613686974503*^9}, {
   3.450613992031566*^9, 3.450614013465266*^9}, {3.450614092037572*^9, 
   3.45061425438165*^9}, {3.450614296886435*^9, 3.450614297043072*^9}, {
   3.45061444118469*^9, 3.45061444472256*^9}, {3.450614494835864*^9, 
   3.450614614784259*^9}, {3.450614666569011*^9, 3.450614667365072*^9}, {
   3.450776464095697*^9, 3.450776476394597*^9}, {3.450776775961441*^9, 
   3.450776837460558*^9}, {3.45077834446017*^9, 3.450778347586503*^9}, {
   3.450778822184224*^9, 3.450778877531916*^9}, {3.450778989429225*^9, 
   3.450779135045569*^9}, {3.451306692409236*^9, 3.451306693945862*^9}, {
   3.45130678038877*^9, 3.451306821564743*^9}, {3.45130687357062*^9, 
   3.451306886284082*^9}, {3.451306967087252*^9, 3.45130702139888*^9}, {
   3.451307083605099*^9, 3.451307110133393*^9}, {3.451307148232639*^9, 
   3.451307148867947*^9}, {3.451307541192054*^9, 3.451307542342089*^9}, 
   3.451307605830981*^9, {3.451307737441892*^9, 3.451307884273938*^9}, {
   3.45130797690127*^9, 3.451307982281912*^9}, {3.451308032898792*^9, 
   3.451308047519751*^9}, {3.45130809520518*^9, 3.451308107299845*^9}, {
   3.451308188032058*^9, 3.451308217107748*^9}, {3.451308248845956*^9, 
   3.451308287283986*^9}, {3.45130833880084*^9, 3.451308369641834*^9}, {
   3.451308426030637*^9, 3.451308433254504*^9}, {3.45130856960385*^9, 
   3.451308575144112*^9}, 3.451308791245226*^9, {3.451308913228646*^9, 
   3.451308915184457*^9}, {3.451309217895696*^9, 3.451309221575678*^9}, 
   3.45131671857017*^9, {3.451316757309552*^9, 3.451316779198385*^9}, {
   3.451317143366922*^9, 3.451317148300181*^9}, {3.451914526802808*^9, 
   3.451914527697089*^9}, {3.451914579608347*^9, 3.451914583775821*^9}, {
   3.45191788054754*^9, 3.451917896115147*^9}, {3.451917940490528*^9, 
   3.451918115707163*^9}, {3.451918183617244*^9, 3.451918255378346*^9}, {
   3.451976815080126*^9, 3.451976817582508*^9}, {3.452430607978995*^9, 
   3.452430615351318*^9}, {3.452430648652866*^9, 3.452430667462558*^9}, {
   3.452430740412091*^9, 3.452430741537071*^9}, {3.452503672765049*^9, 
   3.452503679693874*^9}, {3.452504017055831*^9, 3.452504018813991*^9}, {
   3.452504053993185*^9, 3.452504182556197*^9}, 3.452504220646448*^9, {
   3.452504447298101*^9, 3.452504447997237*^9}, {3.452504526792645*^9, 
   3.452504541431824*^9}, {3.452517034985487*^9, 3.452517047448179*^9}, {
   3.452868039386652*^9, 3.45286805198674*^9}, {3.454157091704364*^9, 
   3.454157092161808*^9}, {3.454157144732461*^9, 3.454157146774254*^9}, {
   3.454157179400602*^9, 3.454157196661886*^9}, {3.454157430964616*^9, 
   3.454157431680975*^9}, {3.454157592718028*^9, 3.454157593352722*^9}, {
   3.454160356504047*^9, 3.454160400111668*^9}, {3.454241509908916*^9, 
   3.454241539131968*^9}, {3.454241607771176*^9, 3.454241610621522*^9}, 
   3.454242532181829*^9, 3.46878234154387*^9, {3.469369970565373*^9, 
   3.469370314917918*^9}, 3.469370506662942*^9, {3.4693705791252193`*^9, 
   3.4693706080576143`*^9}, {3.4693706544501677`*^9, 3.469370783803628*^9}, {
   3.4693709957804537`*^9, 3.46937106051873*^9}, {3.469371186274736*^9, 
   3.469371213857465*^9}, {3.469371249660589*^9, 3.469371262080793*^9}, 
   3.469371494155141*^9, {3.46937167644821*^9, 3.469371696399157*^9}, 
   3.469371894971921*^9, {3.469371956883803*^9, 3.469371979848826*^9}, 
   3.469372038774887*^9, {3.4693727303268843`*^9, 3.4693727471839027`*^9}, {
   3.469375132462737*^9, 3.469375133520214*^9}, 3.492694030780794*^9}]
}, Closed]]
}, Open  ]]
}, Closed]]
},
CellGrouping->Manual,
WindowSize->{1280, 706},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait"},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 433, 6, 67, "Section"],
Cell[1003, 30, 3202, 91, 148, "Input"],
Cell[4208, 123, 419, 10, 27, "Input"],
Cell[4630, 135, 429, 10, 27, "Input"],
Cell[5062, 147, 2186, 69, 133, "Input"],
Cell[7251, 218, 487, 10, 43, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[7741, 230, 34707, 821, 1618, "Input"],
Cell[42451, 1053, 139, 2, 27, "Input"],
Cell[42593, 1057, 127, 2, 27, "Input"],
Cell[42723, 1061, 578, 14, 58, "Input"],
Cell[43304, 1077, 309, 7, 27, "Input"],
Cell[43616, 1086, 254, 7, 43, "Input"],
Cell[43873, 1095, 54788, 1257, 2638, "Input"],
Cell[98664, 2354, 4719, 119, 313, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[103420, 2478, 434, 6, 37, "Section"],
Cell[103857, 2486, 289, 7, 27, "Input"],
Cell[104149, 2495, 1818, 41, 58, "Input"],
Cell[105970, 2538, 311, 8, 43, "Input"],
Cell[106284, 2548, 2679, 83, 148, "Input"],
Cell[108966, 2633, 887003, 18996, 31249, "Input"],
Cell[995972, 21631, 5713, 128, 178, "Input"]
}, Closed]],
Cell[1001700, 21762, 1382, 37, 37, "Input"],
Cell[CellGroupData[{
Cell[1003107, 21803, 488, 7, 67, "Section"],
Cell[CellGroupData[{
Cell[1003620, 21814, 196, 3, 26, "Subsubtitle"],
Cell[1003819, 21819, 77, 1, 27, "Input"],
Cell[1003899, 21822, 2791, 58, 73, "Input"],
Cell[1006693, 21882, 72391, 1667, 2638, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1079121, 23554, 270, 3, 26, "Subsubtitle"],
Cell[1079394, 23559, 36833, 902, 1963, "Input"],
Cell[1116230, 24463, 672, 19, 27, "Input"],
Cell[1116905, 24484, 919, 29, 58, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1117861, 24518, 277, 3, 26, "Subsubtitle"],
Cell[1118141, 24523, 24990, 530, 1201, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1143168, 25058, 496, 7, 26, "Subsubtitle"],
Cell[CellGroupData[{
Cell[1143689, 25069, 668, 9, 34, "Subsection"],
Cell[1144360, 25080, 964, 25, 43, "Input"],
Cell[1145327, 25107, 53332, 1227, 2068, "Input"],
Cell[1198662, 26336, 5609, 153, 163, "Input"],
Cell[1204274, 26491, 4501, 110, 148, "Input"],
Cell[1208778, 26603, 40, 0, 27, "Input"],
Cell[1208821, 26605, 96, 1, 27, "Input"],
Cell[1208920, 26608, 2129, 57, 88, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1211086, 26670, 680, 9, 26, "Subsection"],
Cell[1211769, 26681, 11375, 269, 403, "Input"],
Cell[1223147, 26952, 20171, 497, 673, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1243355, 27454, 743, 10, 26, "Subsection"],
Cell[1244101, 27466, 17850, 418, 613, "Input"],
Cell[1261954, 27886, 14956, 317, 643, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1276947, 28208, 847, 12, 26, "Subsection"],
Cell[1277797, 28222, 23445, 562, 763, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1301279, 28789, 902, 12, 26, "Subsection"],
Cell[1302184, 28803, 29046, 662, 958, "Input"],
Cell[1331233, 29467, 25395, 552, 988, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1356665, 30024, 949, 13, 26, "Subsection"],
Cell[1357617, 30039, 34824, 794, 1168, "Input"],
Cell[1392444, 30835, 30426, 666, 1138, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1422907, 31506, 912, 12, 26, "Subsection"],
Cell[1423822, 31520, 46855, 1032, 1198, "Input"],
Cell[1470680, 32554, 37720, 859, 1243, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1508437, 33418, 919, 13, 26, "Subsection"],
Cell[1509359, 33433, 56171, 1250, 1453, "Input"],
Cell[1565533, 34685, 46284, 1067, 1513, "Input"]
}, Closed]]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
